<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Work in progress">

<title>7&nbsp; Spatially-structured populations – Mathematical Ecology and Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./solutions.html" rel="next">
<link href="./epidemics.html" rel="prev">
<link href="./virus.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2b37b0a2d7675c40fc14763bc2dd14a3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="7&nbsp; Spatially-structured populations – Mathematical Ecology and Epidemiology">
<meta property="og:description" content="Work in progress">
<meta property="og:image" content="figures/Spatial/mpa.svg">
<meta property="og:site_name" content="Mathematical Ecology and Epidemiology">
<meta name="twitter:title" content="7&nbsp; Spatially-structured populations – Mathematical Ecology and Epidemiology">
<meta name="twitter:description" content="Work in progress">
<meta name="twitter:image" content="figures/Spatial/mpa.svg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./spatial.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatially-structured populations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Ecology and Epidemiology</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://vle.york.ac.uk/ultra/courses/_111662_1/outline" title="VLE" class="quarto-navigation-tool px-1" aria-label="VLE"><i class="bi bi-house-door-fill"></i></a>
    <a href="https://maths.york.ac.uk/moodle/course/view.php?id=2726" title="Moodle quizzes" class="quarto-navigation-tool px-1" aria-label="Moodle quizzes"><i class="bi bi-mortarboard-fill"></i></a>
    <a href="./Mathematical-Ecology-and-Epidemiology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./continuous_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Continuous-time population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Discrete-time population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interacting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interacting populations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sex_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sex-structured population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./age_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Age-structured population model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./epidemics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Epidemics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatially-structured populations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solutions</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#derivation-of-pde" id="toc-derivation-of-pde" class="nav-link active" data-scroll-target="#derivation-of-pde"><span class="header-section-number">7.1</span> Derivation of PDE</a></li>
  <li><a href="#fishing-model-with-diffusion" id="toc-fishing-model-with-diffusion" class="nav-link" data-scroll-target="#fishing-model-with-diffusion"><span class="header-section-number">7.2</span> Fishing model with diffusion</a></li>
  <li><a href="#invasion-waves-in-sir-model" id="toc-invasion-waves-in-sir-model" class="nav-link" data-scroll-target="#invasion-waves-in-sir-model"><span class="header-section-number">7.3</span> Invasion waves in SIR model</a>
  <ul>
  <li><a href="#travelling-wave-ansatz-and-boundary-conditions" id="toc-travelling-wave-ansatz-and-boundary-conditions" class="nav-link" data-scroll-target="#travelling-wave-ansatz-and-boundary-conditions"><span class="header-section-number">7.3.1</span> Travelling wave Ansatz and boundary conditions</a></li>
  <li><a href="#wave-speed" id="toc-wave-speed" class="nav-link" data-scroll-target="#wave-speed"><span class="header-section-number">7.3.2</span> Wave speed</a></li>
  </ul></li>
  <li><a href="#turing-instabilities" id="toc-turing-instabilities" class="nav-link" data-scroll-target="#turing-instabilities"><span class="header-section-number">7.4</span> Turing instabilities</a>
  <ul>
  <li><a href="#deriving-conditions-for-turing-instabilities" id="toc-deriving-conditions-for-turing-instabilities" class="nav-link" data-scroll-target="#deriving-conditions-for-turing-instabilities"><span class="header-section-number">7.4.1</span> Deriving conditions for Turing instabilities</a></li>
  <li><a href="#understanding-the-conditions-for-turing-instabilities" id="toc-understanding-the-conditions-for-turing-instabilities" class="nav-link" data-scroll-target="#understanding-the-conditions-for-turing-instabilities"><span class="header-section-number">7.4.2</span> Understanding the conditions for Turing instabilities</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">7.4.3</span> Example</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">7.5</span> Exercises</a>
  <ul>
  <li><a href="#fishing-model-with-diffusion-1" id="toc-fishing-model-with-diffusion-1" class="nav-link" data-scroll-target="#fishing-model-with-diffusion-1">* Fishing model with diffusion</a></li>
  <li><a href="#travelling-wave-in-1-species-reaction-diffusion-model" id="toc-travelling-wave-in-1-species-reaction-diffusion-model" class="nav-link" data-scroll-target="#travelling-wave-in-1-species-reaction-diffusion-model">Travelling wave in 1-species reaction-diffusion model</a></li>
  <li><a href="#travelling-wave-in-2-species-reaction-diffusion-model" id="toc-travelling-wave-in-2-species-reaction-diffusion-model" class="nav-link" data-scroll-target="#travelling-wave-in-2-species-reaction-diffusion-model">* Travelling wave in 2-species reaction-diffusion model</a></li>
  <li><a href="#sir-model-with-logistic-growth" id="toc-sir-model-with-logistic-growth" class="nav-link" data-scroll-target="#sir-model-with-logistic-growth">SIR model with logistic growth</a></li>
  <li><a href="#derive-turing-instability" id="toc-derive-turing-instability" class="nav-link" data-scroll-target="#derive-turing-instability">Derive Turing instability</a></li>
  <li><a href="#conditions-for-turing-instability" id="toc-conditions-for-turing-instability" class="nav-link" data-scroll-target="#conditions-for-turing-instability">* Conditions for Turing instability</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/edit/main/spatial.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatially-structured populations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We now want to keep track of how individuals are distributed over space. So instead of describing a population by its total number of individuals <span class="math inline">\(N(t)\)</span> we describe it by a population density <span class="math inline">\(u(x,t)\)</span>, where <span class="math inline">\(u(x,t)dx\)</span> is the number of individuals in the interval <span class="math inline">\([x,x+dx]\)</span> at time <span class="math inline">\(t\)</span>. We can recover the total number of individuals by integrating the density over the entire spatial domain.</p>
<section id="derivation-of-pde" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="derivation-of-pde"><span class="header-section-number">7.1</span> Derivation of PDE</h2>
<p>In the non-spatial case we described the time evolution of the population by the equation <span id="eq-nonspatial"><span class="math display">\[
\frac{dN}{dt} = f(N),
\tag{7.1}\]</span></span> where <span class="math inline">\(f(N)\)</span> is the net growth rate that encodes the difference between birth and death rates for the population as a whole. In the spatial case we have to consider the net growth rate of the population in a small interval <span class="math inline">\([x,x+dx]\)</span>. This is again given by a function <span class="math inline">\(f\)</span> that encodes the births and deaths, but now we also have movement of individuals into or out of the interval. We write the rate of change of the number of individuals in the interval as <span id="eq-spatial"><span class="math display">\[
\begin{split}
\frac{\partial}{\partial t}\int_{x_0}^{x_0+\Delta x}u(x,t)dx =
&amp;\int_{x_0}^{x_0+\Delta x}f(u(x,t),x)dx \\
&amp;+J(x_0)-J(x_0+\Delta x).
\end{split}
\tag{7.2}\]</span></span> The flux <span class="math inline">\(J(x)\)</span> is defined as the net rate at which individuals move through point <span class="math inline">\(x\)</span> from left to right. If more individuals move from right to left than from left to right, the flux is negative. We have indicated explicitly that <span class="math inline">\(f\)</span> can depend on both the population density <span class="math inline">\(u\)</span> at <span class="math inline">\(x\)</span> as well as the position <span class="math inline">\(x\)</span> itself. This is because the birth and death rates can depend on the local environment, for example the availability of resources or the presence of predators. The flux <span class="math inline">\(J\)</span> can also depend on the local population density and the position. We did not indicate this explicitly to simplify the notation.</p>
<p>We now use the integral mean value theorem that states that for a continuous function <span class="math inline">\(g(x)\)</span> the integral over <span class="math inline">\(g(x)\)</span> over an interval <span class="math inline">\([a,b]\)</span> is equal to <span class="math inline">\(g(\xi)(b-a)\)</span> for some <span class="math inline">\(\xi\in[a,b]\)</span>. We apply this to the integrals in <a href="#eq-spatial" class="quarto-xref">Eq.&nbsp;<span>7.2</span></a> to get <span id="eq-spatial2"><span class="math display">\[
\partial_t u(\xi_1,t)\Delta x = f(u(\xi_2,t),\xi_2)\Delta x +J(x_0)-J(x_0+\Delta x)
\tag{7.3}\]</span></span> for some <span class="math inline">\(\xi_1,\xi_2\in[x_0,x_0+\Delta x]\)</span>. We now divide both sides by <span class="math inline">\(\Delta x\)</span>, <span id="eq-spatial3"><span class="math display">\[
\partial_t u(\xi_1,t) = f(u(\xi_2,t),\xi_2) +\frac{J(x_0)-J(x_0+\Delta x)}{\Delta x}
\tag{7.4}\]</span></span> and take the limit <span class="math inline">\(\Delta x\to 0\)</span>, where <span class="math inline">\(\xi_1\to x\)</span> and <span class="math inline">\(\xi_2\to x\)</span> and the difference quotient becomes the derivative, to get <span id="eq-transport"><span class="math display">\[
\partial_t u(x,t) = f(u(x,t),x)-\partial_x J(x).
\tag{7.5}\]</span></span></p>
<p>As discussed above, the flux <span class="math inline">\(J\)</span> can depend on <span class="math inline">\(x\)</span> both directly and through the population density <span class="math inline">\(u(x,t)\)</span>. An important example is the case where the flux is proportional to the gradient of the population density, <span id="eq-diffusion_flux"><span class="math display">\[
J(x) = -D\partial_x u(x),
\tag{7.6}\]</span></span> where <span class="math inline">\(D\)</span> is the diffusion coefficient. This models random motion of the individuals. Each individual is equally likely to move right or left, but if there are more individuals on the left and less on the right, then the result is a net movement to the right. That is why the flux has the opposite sign of the gradient of the density.</p>
<p>This random motion gives us the reaction-diffusion equation <span id="eq-rd"><span class="math display">\[
\partial_t u=f(u)+D\,\partial_x^2 u.
\tag{7.7}\]</span></span> If there is no local population dynamics, the equation simplifies to the diffusion equation, also known as the heat equation. The diffusion term has the effect of smoothing out spatial inhomogeneities in the population density. Therefore the heat equation by itself is rather boring. However, as we will see later, the reaction term in combination with the diffusion term can lead to the formation of spatial patterns, such as travelling waves or stationary patterns.</p>
</section>
<section id="fishing-model-with-diffusion" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="fishing-model-with-diffusion"><span class="header-section-number">7.2</span> Fishing model with diffusion</h2>
<p>We now consider a model for a population of fish that is subject to fishing and that moves around randomly. We want to model a marine protected area where fishing is limited to avoid a collapse of the fish population. <a href="#fig-mpa" class="quarto-xref">Figure&nbsp;<span>7.1</span></a> shows the spatial setup. The <span class="math inline">\(x\)</span>-axis runs perpendicular to the shore, which is at <span class="math inline">\(x=0\)</span>. A marine protected area runs out up to a distance <span class="math inline">\(L\)</span> from the shore. We assume that the marine protected area has infinite extension in the <span class="math inline">\(y\)</span>-direction, so that we can ignore the <span class="math inline">\(y\)</span>-coordinate and model the fish population as a function of <span class="math inline">\(x\)</span> only.</p>
<p>Beyond <span class="math inline">\(x=L\)</span> there is no management of the fishing activity. We assume that the fishers are so efficient that they catch all fish that venture outside the protected area. So we set <span class="math inline">\(u(x,t)=0\)</span> for <span class="math inline">\(x\geq L\)</span>. This is of course an idealisation, but it allows us to focus on the dynamics within the protected area.</p>
<div id="fig-mpa" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mpa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Spatial/mpa.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mpa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Sketch of the marine protected area
</figcaption>
</figure>
</div>
<p>We assume that in the absence of fishing the population has a logistic growth rate. The population density <span class="math inline">\(u(x,t)\)</span> satisfies the equation <span id="eq-fish"><span class="math display">\[
\partial_t u = r u \left(1-\frac{u}{K}\right) - E u + D \partial_x^2 u,
\tag{7.8}\]</span></span> where <span class="math inline">\(r\)</span> is the intrinsic growth rate, <span class="math inline">\(K\)</span> is the carrying capacity, <span class="math inline">\(E\)</span> is the fishing rate and <span class="math inline">\(D\)</span> is the diffusion coefficient. The first term on the right-hand side describes the logistic growth, the second term the fishing and the third term the random motion of the fish.</p>
<p>In the protected area, the fishing rate <span class="math inline">\(E\)</span> must certainly be below the intrinsic growth rate <span class="math inline">\(r\)</span>, otherwise the population is guaranteed to die out. However we must also take into account that some fish will be lost when they randomly move out of the protected area and are then fished immediately. We expect this extra loss to be proportionally larger when the protected area is smaller. So when the marine protected area is planned, there will be a trade-off between the width <span class="math inline">\(L\)</span> of the protected area and the allowed rate of fishing <span class="math inline">\(E\)</span>. Our aim is to describe this trade-off precisely by finding the condition on <span class="math inline">\(E\)</span> and <span class="math inline">\(L\)</span> such that the population does not collapse.</p>
<p>To achieve our aim, we will need to solve the PDE. But before solving a PDE we always need to be clear about the boundary conditions on the solution. We have already discussed that we assume that <span class="math inline">\(u(x,t)=0\)</span> for <span class="math inline">\(x\geq L\)</span>, i.e., we have a Dirichlet boundary condition at <span class="math inline">\(x=L\)</span>. At <span class="math inline">\(x=0\)</span> we impose a no-flux boundary condition, which means that there are no fish moving from the sea onto the shore or the other way around. The no-flux boundary condition is the Neumann boundary condition <span class="math inline">\(\partial_x u(0,t) = 0\)</span>.</p>
<p>The PDE in <a href="#eq-fish" class="quarto-xref">Eq.&nbsp;<span>7.62</span></a> is a non-linear PDE, so we cannot solve it analytically in general. However, we can still make progress by realising that before the population goes extinct, it will get small. We can then linearise the PDE around the extinction state <span class="math inline">\(u=0\)</span> and solve the linearised equation. If the extinction steady state is linearly unstable, then the population will not go extinct.</p>
<p>Linearising the PDE <a href="#eq-fish" class="quarto-xref">Eq.&nbsp;<span>7.62</span></a> around the extinction state <span class="math inline">\(u=0\)</span> means that we neglect the term <span class="math inline">\(u^2\)</span> in the logistic growth term. We then have the linearised equation <span id="eq-fishlin"><span class="math display">\[
\partial_t u = (r - E)u + D \partial_x^2 u.
\tag{7.9}\]</span></span> We can now solve this linear PDE with the method of separation of variables. We make the Ansatz <span class="math inline">\(u(x,t) = X(x)T(t)\)</span> and plug this into <a href="#eq-fishlin" class="quarto-xref">Eq.&nbsp;<span>7.9</span></a>. We get <span id="eq-fishsep"><span class="math display">\[
XT'=(r-E)XT+DX''T
\tag{7.10}\]</span></span> and after dividing by <span class="math inline">\(XT\)</span> we get <span id="eq-fishsep2"><span class="math display">\[
\frac{T'}{T} = r-E + D \frac{X''}{X}.
\tag{7.11}\]</span></span> The left-hand side depends only on <span class="math inline">\(t\)</span> and the right-hand side only on <span class="math inline">\(x\)</span>. Therefore both sides must be equal to a constant, which we call <span class="math inline">\(\gamma\)</span>. We then have the two ODEs <span id="eq-fishsep3"><span class="math display">\[
T' = \gamma T, ~~~ X'' = \frac{\gamma-r+E}{D}X =-\rho^2 X,
\tag{7.12}\]</span></span> where, in order to save writing, we have introduced <span id="eq-fishrho"><span class="math display">\[
\rho^2 = (r-E-\gamma)/D.
\tag{7.13}\]</span></span> The solution of the time ODE is <span id="eq-fishT"><span class="math display">\[
T(t) = T(0)e^{\gamma t}
\tag{7.14}\]</span></span> and the solution of the spatial ODE is <span id="eq-fishX"><span class="math display">\[
X(x) = A \cos(\rho x) + B \sin(\rho x),
\tag{7.15}\]</span></span> where <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are constants to be determined by the boundary conditions.</p>
<p>Imposing the no-flux boundary condition <span class="math inline">\(\partial_xu(0,t)\)</span> gives <span id="eq-fishBC1"><span class="math display">\[
X'(0) =-A\rho\sin(\rho 0)+B\rho\cos(\rho 0)=B\rho= 0.
\tag{7.16}\]</span></span> So either <span class="math inline">\(\rho=0\)</span> or <span class="math inline">\(B=0\)</span>. The case <span class="math inline">\(\rho=0\)</span> gives the trivial solution <span class="math inline">\(X(x)=A\)</span>, which is not interesting. So we take <span class="math inline">\(B=0\)</span> and get <span class="math inline">\(X(x) = A\cos(\rho x)\)</span>.</p>
<p>The Dirichlet boundary condition at <span class="math inline">\(x=L\)</span> gives <span class="math inline">\(X(L) = A\cos(\rho L) = 0\)</span>. So either <span class="math inline">\(A=0\)</span> or <span class="math inline">\(\cos(\rho L) = 0\)</span>. The former gives rise to the zero solution, so we want the latter, which requires <span class="math inline">\(\rho L\)</span> to be an odd multiple of <span class="math inline">\(\pi/2\)</span>, i.e., <span id="eq-fishrho2"><span class="math display">\[
\rho=\rho_n = \frac{(2n+1)\pi}{2L}
\tag{7.17}\]</span></span> for <span class="math inline">\(n=0,1,2,...\)</span>. To each of these <span class="math inline">\(\rho_n\)</span> there corresponds, according to <a href="#eq-fishrho" class="quarto-xref">Eq.&nbsp;<span>7.13</span></a>, a <span id="eq-fishgamma"><span class="math display">\[
\gamma_n = r-E-D\rho_n^2
\tag{7.18}\]</span></span> and a solution <span id="eq-fishsol"><span class="math display">\[
u_n(x,t) = X_n(x)T_n(t) = A_ne^{\gamma_n t}\cos(\rho_n x)
\tag{7.19}\]</span></span> The general solution is then a linear combination of these solutions, <span id="eq-fishgensol"><span class="math display">\[
u(x,t) = \sum_{n=0}^\infty A_ne^{\gamma_n t}\cos(\rho_n x).
\tag{7.20}\]</span></span></p>
<p>The condition for the population not to go extinct is that the extinction steady state is linearly unstable. This means that there is at least one <span class="math inline">\(\gamma_n\)</span> with positive real part. We see from <a href="#eq-fishgamma" class="quarto-xref">Eq.&nbsp;<span>7.18</span></a> that <span class="math inline">\(\gamma_n\)</span> decreases with <span class="math inline">\(n\)</span>. So <span class="math inline">\(\gamma_0\)</span> is the largest. So the condition for the population not to go extinct is that <span class="math inline">\(\gamma_0\)</span> is positive. This gives the condition <span id="eq-fishcond"><span class="math display">\[
\gamma_0=r-E-D\rho_0^2=r-E-\frac{D\pi^2}{4L^2}&gt;0.
\tag{7.21}\]</span></span> We can now solve this inequality for <span class="math inline">\(L\)</span> to get the condition on the width of the marine protected area that ensures the population does not collapse. <span id="eq-fishcond2"><span class="math display">\[
L&gt;\frac{\pi}{2}\sqrt{\frac{D}{r-E}}.
\tag{7.22}\]</span></span> Alternatively we can solve the inequality for <span class="math inline">\(E\)</span> to get the condition on the fishing rate that ensures the population does not collapse. <span id="eq-fishcond3"><span class="math display">\[
E&lt;r-\frac{D\pi^2}{4L^2}.
\tag{7.23}\]</span></span> This can now be used to inform policy decisions on the width of the marine protected area and the allowed fishing rate.</p>
</section>
<section id="invasion-waves-in-sir-model" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="invasion-waves-in-sir-model"><span class="header-section-number">7.3</span> Invasion waves in SIR model</h2>
<p>We now want to use our spatial modelling skills to study the spread of an infectious disease through space. For concreteness, think of a situation where rabies has infected foxes in Dover and we want to get an idea of how soon we will have rabid foxes in York. We model the fox population by the SIR model, where <span class="math inline">\(S(x,t)\)</span> is the density of susceptible foxes, <span class="math inline">\(I(x,t)\)</span> is the density of infected foxes and <span class="math inline">\(R(x,t)\)</span> is the density of removed foxes (which for rabies unfortunately means dead foxes). So where in <a href="epidemics.html#sec-sir" class="quarto-xref"><span>Section 6.1</span></a> we had ordinary differential equations for the total number of susceptible, infected and removed foxes, we now have partial differential equations for the densities of susceptible, infected and removed foxes in space.</p>
<p>While foxes are usually very territorial and stay in their own territory, infected foxes become a bit insane and move around randomly. This is modelled by a diffusion term in the equation for the infected foxes. The equations are <span id="eq-sir"><span class="math display">\[\begin{split}
\partial_t S&amp;=-\beta \frac{SI}{N},\\
\partial_t I&amp;=\beta \frac{SI}{N}-\gamma I+D\partial_x^2I,\\
\partial_t R&amp;=\gamma I,
\end{split} \tag{7.24}\]</span></span> where <span class="math inline">\(N=S+I+R\)</span> is the total fox population density, <span class="math inline">\(\beta\)</span> is the infection rate, <span class="math inline">\(\gamma\)</span> is the recovery rate and <span class="math inline">\(D\)</span> is the diffusion coefficient. For simplicity we study the movement in the <span class="math inline">\(x\)</span> direction only. The above equations are valid for all <span class="math inline">\(x\)</span>. We will later concentrate on the equations for <span class="math inline">\(I\)</span> and <span class="math inline">\(S\)</span> only, as <span class="math inline">\(R\)</span> can then be calculated from <span class="math inline">\(N=S+I+R\)</span>.</p>
<p>Before analysing these equations further, let us think about what we expect to happen. The infected foxes in Dover will infect more and more susceptible foxes. The infected foxes will then move around and infect susceptible foxes in neighbouring territories. This will lead to a wave of infection spreading out from Dover. The wave will move at a speed that depends on the infection rate, the recovery rate and the diffusion coefficient. The wave will have a front where the infected foxes are and a tail where the epidemic has died out.</p>
<p>To make the further analysis easier, we will non-dimensionalise the equations. We introduce the non-dimensional variables <span id="eq-sirnondim"><span class="math display">\[
u = S/N, ~~~ v = I/N,~~~ \tilde{t} = \beta t,
\tag{7.25}\]</span></span> Then the equations become <span id="eq-sirnondim2"><span class="math display">\[\begin{split}
\partial_{\tilde{t}} u&amp;=-uv\\
\partial_{\tilde{t}} v&amp;=uv-\frac{\gamma}{\beta}v+\frac{D}{\beta}\partial_x^2v.
\end{split} \tag{7.26}\]</span></span> We now also introduce the non-dimensional spatial variable <span class="math inline">\(\tilde{x} = \sqrt{\frac{\beta}{D}}x\)</span> and the non-dimensional parameter <span class="math inline">\(r = \frac{\gamma}{\beta}\)</span>. We now drop the tildes to avoid clutter and write the equations as <span id="eq-sirnondim3"><span class="math display">\[\begin{split}
\partial_t u&amp;=-uv\\
\partial_t v&amp;=uv-rv+\partial_x^2v.
\end{split} \tag{7.27}\]</span></span></p>
<section id="travelling-wave-ansatz-and-boundary-conditions" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="travelling-wave-ansatz-and-boundary-conditions"><span class="header-section-number">7.3.1</span> Travelling wave Ansatz and boundary conditions</h3>
<p>We are looking for a solution describing the spread of the infection from Dover to York. We make the Ansatz that the solution is a travelling wave, i.e., that it is of the form <span id="eq-sirnondim4"><span class="math display">\[
u(x,t)=U(z),~~~v(x,t)=V(z)
\tag{7.28}\]</span></span> with <span class="math inline">\(z=x-ct\)</span> for some <span class="math inline">\(c&gt;0\)</span>. This means that the wave is a right-moving wave. We plug this into <a href="#eq-sirnondim3" class="quarto-xref">Eq.&nbsp;<span>7.27</span></a> and get the system of ODEs <span id="eq-sirnondim5"><span class="math display">\[\begin{split}
-cU'&amp;=-UV,\\
-cV'&amp;=UV-rV+V''.
\end{split} \tag{7.29}\]</span></span> Next let us think about the boundary conditions. We expect that ahead of the wave all the individuals are still susceptible and there are no infecteds yet. So to the far right at <span class="math inline">\(z=infty\)</span> we have <span class="math inline">\(u(\infty)=1\)</span> (corresponding to S=N) and <span class="math inline">\(v(\infty)=0\)</span>. Behind the wave the epidemic will have run its course and so <span class="math inline">\(u(-\infty)=S_\infty/N=:a\)</span> and <span class="math inline">\(v(-\infty)=0\)</span>. In other words, the travelling wave interpolates between the state before an epidemic (at <span class="math inline">\(z=\infty\)</span>) and the state after an epidemic (at <span class="math inline">\(z=-\infty\)</span>). We also have that the solution becomes flat as <span class="math inline">\(z\to\pm\infty\)</span>, so in particular <span class="math inline">\(V'(\pm\infty)=0\)</span>.</p>
<p>We now massage the equations a bit to get them into a form that we can integrate more easily. From the first equation we see that <span class="math inline">\(UV=cU'\)</span> and also that <span class="math inline">\(V=cU'/U=c(\log U)'\)</span>. We plug this into the second equation and get <span id="eq-sirnondim6"><span class="math display">\[
-cV'=cU'-rc(\log U)' + V''.
\tag{7.30}\]</span></span> Now that each term in the equation is a total derivative, we can integrate it by just removing the differentiations: <span id="eq-sirnondim7"><span class="math display">\[
-cV=cU-rc\log U + V'+A,
\tag{7.31}\]</span></span> where <span class="math inline">\(A\)</span> is a constant of integration. We use the boundary condition at <span class="math inline">\(z\to\infty\)</span> to determine <span class="math inline">\(A\)</span>: <span id="eq-sirnondim8"><span class="math display">\[
0=c-rc\log 1 + 0 + A \Rightarrow A=-c.
\tag{7.32}\]</span></span> At <span class="math inline">\(z\to-\infty\)</span> we get <span id="eq-sirnondim9"><span class="math display">\[
0=ca-rc\log a + 0 - c \Rightarrow a-1=r\log a.
\tag{7.33}\]</span></span> This equation is equivalent to <a href="epidemics.html#eq-Sinf" class="quarto-xref">Eq.&nbsp;<span>6.7</span></a> for <span class="math inline">\(S_\infty\)</span> in the case where <span class="math inline">\(S_0=N\)</span>. Again this transcendental equation can only be solved numerically.</p>
</section>
<section id="wave-speed" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="wave-speed"><span class="header-section-number">7.3.2</span> Wave speed</h3>
<p>Next we want to learn about the wave speed <span class="math inline">\(c\)</span>. We do this by linearising the equation around the leading edge of the wave, where <span class="math inline">\(V\)</span> is very small and <span class="math inline">\(U\)</span> is close to 1, i.e, <span class="math inline">\(U=1-\epsilon\)</span> for small <span class="math inline">\(\epsilon\)</span>. Substituting this into the second equation in <a href="#eq-sirnondim5" class="quarto-xref"><span>7.29</span></a> we get <span id="eq-wavespeed1"><span class="math display">\[
-cV' = (1-\epsilon)V - r V + V''.
\tag{7.34}\]</span></span> Because both <span class="math inline">\(\epsilon\)</span> and <span class="math inline">\(V\)</span> are small, we can neglect the product <span class="math inline">\(\epsilon V\)</span> and get <span id="eq-wavespeed2"><span class="math display">\[
-cV' = (1 - r) V + V''.
\tag{7.35}\]</span></span> This is a linear ODE with constant coefficients and can thus be solved with the Ansatz <span class="math inline">\(V(z) = e^{-\lambda z}\)</span>. Substituting this into the ODE and dividing by <span class="math inline">\(e^{-\lambda z}\)</span> gives <span id="eq-wavespeed3"><span class="math display">\[
\lambda^2 -c\lambda+ 1-r=0.
\tag{7.36}\]</span></span> The solution of this quadratic equation is <span id="eq-wavespeed4"><span class="math display">\[
\lambda = \frac{c\pm\sqrt{c^2-4(1-r)}}{2}.
\tag{7.37}\]</span></span> We need <span class="math inline">\(\lambda\)</span> to be real so that our solution correctly describes the exponential growth at the start of an epidemic, so we need the discriminant to be non-negative, i.e., <span id="eq-wavespeed5"><span class="math display">\[
c^2-4(1-r)\geq 0
\tag{7.38}\]</span></span> and thus we get a lower bound on the wave speed: <span id="eq-wavespeed6"><span class="math display">\[
c\geq 2\sqrt{1-r}.
\tag{7.39}\]</span></span></p>
</section>
</section>
<section id="turing-instabilities" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="turing-instabilities"><span class="header-section-number">7.4</span> Turing instabilities</h2>
<p>We now come to a very intriguing question: how can the complicated spatial patterns arise that one can observe in nature. One might have thought that to explain complicated patterns one would need complicated models that encode all that complexity. However, it turns out that patterns can arise from very simple, translation-invariant models. The key idea is that the spatially uniform steady state in a translation-invariant model can be unstable to small perturbations, which then grow and form spatial patterns. This is called a Turing instability.</p>
<p>We consider a system of two species, described by densities <span class="math inline">\(u(x,t)\)</span> and <span class="math inline">\(v(x,t)\)</span>, that interact with each other locally but also move around randomly. The system is described by the reaction-diffusion equations <span id="eq-turing"><span class="math display">\[\begin{split}
\frac{\partial u}{\partial t}&amp;=f(u,v)+D_1\frac{\partial^2u}{\partial x^2},\\
\frac{\partial v}{\partial t}&amp;=g(u,v)+D_2\frac{\partial^2v}{\partial x^2},
\end{split} \tag{7.40}\]</span></span> where <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are functions that describe the local dynamics of the two species. The diffusion terms model random motion of the individuals.</p>
<p>For values <span class="math inline">\((u^*,v^*)\)</span> of the densities that satisfy <span class="math inline">\(f(u^*,v^*)=g(u^*,v^*)=0\)</span>, the spatially homogeneous steady state <span class="math inline">\(u(x,t)=u^*\)</span>, <span class="math inline">\(v(x,t)=v^*\)</span> is a solution of the system. Assume that in the absence of diffusion, this steady state is stable. Thus without diffusion, any perturbations to the spatially homogeneous steady state will decay. One would then expect that the spatially homogeneous steady state is stable also in the presence of diffusion, given that diffusion has the tendency to spread individuals out away from regions of higher concentration. The result would be the absence of any spatial structure in the solution. However, we will now see that this is not always the case. Rather counter-intuitively, the random motion of the individuals can destabilise the spatially homogeneous steady state and give rise to spatial patterns.</p>
<section id="deriving-conditions-for-turing-instabilities" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="deriving-conditions-for-turing-instabilities"><span class="header-section-number">7.4.1</span> Deriving conditions for Turing instabilities</h3>
<p>Mathematics is a great tool for dealing with counter-intuitive phenomena. We just have to do the maths and see what it tells us. So we now derive the equations that describe the time-evolution of small perturbations and solve them and see whether the perturbations grow or not. So we set <span id="eq-turingpert"><span class="math display">\[
u(x,t)=u^*+\xi(x,t),~~~v(x,t)=v^*+\eta(x,t)
\tag{7.41}\]</span></span> where <span class="math inline">\(\xi(x,t)\)</span> and <span class="math inline">\(\eta(x,t)\)</span> are small perturbations. If we plug this into <a href="#eq-turing" class="quarto-xref">Eq.&nbsp;<span>7.40</span></a> we get equations for the time evolution of the small perturbations: <span id="eq-turingpert2"><span class="math display">\[\begin{split}
\frac{\partial \xi}{\partial t}&amp;=f(u^*+\xi(x,t),v^*+\eta(x,t))\xi+D_1\frac{\partial^2\xi}{\partial x^2},\\
\frac{\partial \eta}{\partial t}&amp;=g(u^*+\xi(x,t),v^*+\eta(x,t))\xi+D_2\frac{\partial^2\eta}{\partial x^2}.
\end{split} \tag{7.42}\]</span></span> We now use Taylor expansions to linearise the equations. We expand <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> around <span class="math inline">\((u^*,v^*)\)</span> to first order and drop all terms that are higher order in <span class="math inline">\(\xi\)</span> and/or <span class="math inline">\(\eta\)</span>. This gives the linear PDEs <span id="eq-turingpert3"><span class="math display">\[\begin{split}
\frac{\partial \xi}{\partial t}&amp;=\frac{\partial f}{\partial u}(u^*,v^*)\xi+\frac{\partial f}{\partial v}(u^*,v^*)\eta+D_1\frac{\partial^2\xi}{\partial x^2}\\
&amp;=a_{11}\xi+a_{12}\eta+D_1\frac{\partial^2\xi}{\partial x^2},\\
\frac{\partial \eta}{\partial t}&amp;=\frac{\partial g}{\partial u}(u^*,v^*)\xi+\frac{\partial g}{\partial v}(u^*,v^*)\eta+D_2\frac{\partial^2\eta}{\partial x^2}\\
&amp;=a_{21}\xi+a_{22}\eta+D_2\frac{\partial^2\eta}{\partial x^2}.
\end{split} \tag{7.43}\]</span></span> Those partial derivatives of <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> with respect to <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are familiar to us from the stability analysis in non-spatial models as the entries of the Jacobian matrix and we are using the same shorthand notation for them here.</p>
<p>We now make the harmonic wave Ansatz <span id="eq-turingpert4"><span class="math display">\[\begin{split}
\xi(x,t)&amp;=B_1e^{\sigma_k t}\sin(kx+\alpha),\\
\eta(x,t)&amp;=B_2e^{\sigma_k t}\sin(kx+\alpha).
\end{split}
\tag{7.44}\]</span></span> During your studies you will have seen this easy way to solve linear PDEs with constant coefficients already several times. Plugging this Ansatz into <a href="#eq-turingpert3" class="quarto-xref">Eq.&nbsp;<span>7.43</span></a> and dividing by <span class="math inline">\(e^{\sigma_k t}\sin(kx+\alpha)\)</span> we get <span id="eq-turingpert5"><span class="math display">\[\begin{split}
\sigma_k B_1&amp;=a_{11}B_1+a_{12}B_2-k^2D_1B_1\\
\sigma_k B_2&amp;=a_{21}B_1+a_{22}B_2k^2D_2B_2.
\end{split} \tag{7.45}\]</span></span> We can write this in matrix form as <span id="eq-turingpert6"><span class="math display">\[
\sigma_k\begin{pmatrix}B_1\\B_2\end{pmatrix}=A(k)\begin{pmatrix}B_1\\B_2\end{pmatrix}.
\tag{7.46}\]</span></span> where <span id="eq-turingpert7"><span class="math display">\[
A(k)=\begin{pmatrix}a_{11}-D_1k^2&amp;a_{12}\\a_{21}&amp;a_{22}-D_2k^2\end{pmatrix}.
\tag{7.47}\]</span></span> This looks very similar to what we get when we do the stability analysis of a non-spatial model, except that now we have a whole family of matrices <span class="math inline">\(A(k)\)</span>, one for each <span class="math inline">\(k\)</span>. The condition for the spatially homogeneous steady state to be stable is that all the eigenvalues <span class="math inline">\(\sigma_k\)</span> of all the matrices <span class="math inline">\(A(k)\)</span> are negative. The spatially homogeneous steady state to be unstable is that there is at least one <span class="math inline">\(k\)</span> for which the real part of <span class="math inline">\(\sigma_k\)</span> is positive.</p>
<p>As we know from studying the stability of non-spatial models of two interacting species, an easy way to determine the stability is to look at the signs of the trace and the determinant of the matrix <span class="math inline">\(A(k)\)</span>. For the trace we find <span id="eq-turingperttr"><span class="math display">\[
\begin{split}
\text{tr}(A(k))&amp;=a_{11}-k^2D_1+a_{22}-k^2D_2\\
&amp;=\text{tr}(A(0))-k^2(D_1+D_2).
\end{split}
\tag{7.48}\]</span></span> We are interested in the case where the steady state is stable in the absence of diffusion and is destabilised by the diffusion. Stability in the absence of diffusion requires <span class="math inline">\(\text{tr}(A(0))&lt;0\)</span>. We see that in that case also <span class="math inline">\(\text{tr}(A(k))&lt;0\)</span> for all <span class="math inline">\(k\)</span> because the <span class="math inline">\(k\)</span>-dependent term <span class="math inline">\(-k^2(D_1+D_2)\)</span> is negative. So the trace is not yet giving us a hint that there might be an instability. So next we look at the determinant.</p>
<p>For the determinant we find <span id="eq-turingpert8"><span class="math display">\[\begin{split}
\det(A(k))&amp;=(a_{11}-D_1k^2)(a_{22}-D_2k^2)-a_{12}a_{21}\\
&amp;=D_1D_2k^4-(D_1a_{22}+D_2a_{11})k^2+\det(A(0))
\end{split} \tag{7.49}\]</span></span> Stability in the absence of diffusion tells us that <span class="math inline">\(\det(A(0))&gt;0\)</span>. We see that <span class="math inline">\(\det(A(k))\)</span> is a quadratic polynomial in <span class="math inline">\(k^2\)</span> with positive leading coefficient. Its graph is a parabola. This means that the determinant is positive for small <span class="math inline">\(k\)</span> and for large <span class="math inline">\(k\)</span> but there may be an intermediate region where the parabola dips below the axis and the determinant is negative in that region. Perturbations with wave numbers in that region would grow over time, making the homogeneous steady state unstable and leading to spatial structure. If that region exists, it is bounded by the values <span class="math inline">\(k_\pm\)</span> for which the determinant is zero. Using the quadratic formula we find that <span id="eq-turingk"><span class="math display">\[
k_\pm^2=\frac{D_1a_{22}+D_2a_{11}\pm\sqrt{(D_1a_{22}+D_2a_{11})^2-4D_1D_2\det(A(0))}}{2D_1D_2}.
\tag{7.50}\]</span></span> The unstable interval exists if <span class="math inline">\(k_\pm^2\)</span> are real and positive. They are real if the discriminant under the square root is non-negative. This gives the condition <span id="eq-turinginstab"><span class="math display">\[
(D_1a_{22}+D_2a_{11})^2&gt;4D_1D_2\det(A(0)).
\tag{7.51}\]</span></span> They are positive if the numerator is positive. This gives the condition <span id="eq-turinginstab2"><span class="math display">\[
D_1a_{22}+D_2a_{11}&gt;0.
\tag{7.52}\]</span></span> The condition for the spatially homogeneous steady state to be unstable is that both <a href="#eq-turinginstab" class="quarto-xref">Eq.&nbsp;<span>7.51</span></a> and <a href="#eq-turinginstab2" class="quarto-xref">Eq.&nbsp;<span>7.52</span></a> are satisfied.</p>
</section>
<section id="understanding-the-conditions-for-turing-instabilities" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="understanding-the-conditions-for-turing-instabilities"><span class="header-section-number">7.4.2</span> Understanding the conditions for Turing instabilities</h3>
<p>We have now derived the conditions for Turing instabilities in terms of the entries of the Jacobian matrix <span class="math inline">\(A=A(0)\)</span> of the local dynamics of the two species and the diffusion coefficients: <span id="eq-turingconditions"><span class="math display">\[\begin{split}
a)\qquad&amp;a_{11}+a_{22}&lt;0,\\
b)\qquad&amp;a_{11}a_{22}-a_{12}a_{21}&gt;0,\\
c)\qquad&amp;D_1a_{22}+D_2a_{11}&gt;0,\\
d)\qquad&amp;(D_1a_{22}+D_2a_{11})^2&gt;4D_1D_2(a_{11}a_{22}-a_{12}a_{21}).
\end{split} \tag{7.53}\]</span></span> Conditions a) and b) are the conditions for the spatially homogeneous steady state to be stable in the absence of diffusion. Condition c) and d) are the condition for the spatially homogeneous steady state to be unstable in the presence of diffusion.</p>
<p>We will first look at what these conditions tell us about the sign structure of the Jacobian, which will introduce the concept of activator and inhibitor species. We make three observations:</p>
<ol type="1">
<li><p>We observe that condition a) implies that at least one of <span class="math inline">\(a_{11}\)</span> and <span class="math inline">\(a_{22}\)</span> is negative. We are free to choose the numbering of our species, so, without loss of generality, let’s say that <span class="math inline">\(a_{22}&lt;0\)</span>. This means that species 2 inhibits its own growth above the steady state. We call species 2 an <strong>inhibitor</strong> species.</p></li>
<li><p>From condition c) we see that if <span class="math inline">\(a_{22}&lt;0\)</span> then <span class="math inline">\(a_{11}&gt;0\)</span>. This means that species 1 activates its own growth above the steady state. We call species 1 an <strong>activator</strong> species.</p></li>
<li><p>From condition b) we now observe that, because <span class="math inline">\(a_{11}a_{22}&lt;0\)</span>, we must have that <span class="math inline">\(a_{12}a_{21}&lt;0\)</span>.</p></li>
</ol>
<p>Taking these three observations together tells us that there are only two possibilities for the sign structure of the Jacobian matrix: <span id="eq-turingjac"><span class="math display">\[
\text{sign}(A)=\begin{pmatrix}+&amp;-\\+&amp;-\end{pmatrix}~~~\text{or}~~~\text{sign}(A)=\begin{pmatrix}+&amp;+\\-&amp;-\end{pmatrix}.
\tag{7.54}\]</span></span> If the signs in the Jacobian are different from both of these possibilities you can immediately rule out a Turing instability.</p>
<p>Next we look at what our conditions a) to d) tell us about the magnitude of the diffusion coefficients. From condition a) we know that <span class="math inline">\(a_{11}&lt;-a_{22}\)</span> and hence <span class="math inline">\(-a_{11}/a_{22}&lt;1\)</span>. From condition c) we see that <span class="math inline">\(D_1/D_2&lt;-a_{11}/a_{22}\)</span>. Putting these together gives <span class="math inline">\(D_1/D_2&lt;1\)</span> and hence <span class="math inline">\(D_1&lt;D_2\)</span>: <strong>The inhibitor must diffuse faster than the activator</strong>. This is a necessary condition for a Turing instability.</p>
<p>Exactly how much faster the inhibitor must diffuse than the activator depends on the details of the local interactions and we will next study this in a concrete example.</p>
</section>
<section id="example" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="example"><span class="header-section-number">7.4.3</span> Example</h3>
<p>Let’s consider the following concrete reaction-diffusion system: <span id="eq-schnak"><span class="math display">\[\begin{split}
\partial_tu&amp;=-u+u^2v+D_1\partial_x^2u=f(u,v)+D_1\partial_x^2u,\\
\partial_tv&amp;=b-u^2v+D_2\partial_x^2v=g(u,v)+D_2\partial_x^2v.
\end{split} \tag{7.55}\]</span></span></p>
<p>The Jacobian matrix of the local dynamics is <span id="eq-schnakjac"><span class="math display">\[
A=\begin{pmatrix}\frac{\partial f}{\partial u}&amp;\frac{\partial f}{\partial v}\\
\frac{\partial g}{\partial u}&amp;\frac{\partial g}{\partial v}\end{pmatrix}=
\begin{pmatrix}-1+2uv&amp;u^2\\-2uv&amp;-u^2\end{pmatrix}.
\tag{7.56}\]</span></span> We are interested in the coexistence steady state <span class="math inline">\((u^*,v^*)\)</span> where both species coexist. Imposing that <span class="math inline">\(f(u^*,v^*)=0\)</span> gives us that <span class="math inline">\(u^*v^*=1\)</span> and then imposing that <span class="math inline">\(g(u^*,v^*)=0\)</span> gives us that <span class="math inline">\(u^*=b\)</span> and hence <span class="math inline">\(v^*=1/b\)</span>. So the coexistence steady state is <span id="eq-schnakss"><span class="math display">\[
(u^*,v^*)=\left(b,\frac{1}{b}\right).
\tag{7.57}\]</span></span> The Jacobian matrix evaluated at the coexistence steady state is <span id="eq-schnakjac2"><span class="math display">\[
A=\begin{pmatrix}1&amp;b^2\\-2&amp;-b^2\end{pmatrix}.
\tag{7.58}\]</span></span> We see that the sign structure of this matrix is one of those in <a href="#eq-turingjac" class="quarto-xref">Eq.&nbsp;<span>7.54</span></a> that can give rise to a Turing instability. Species <span class="math inline">\(u\)</span> is the activator and species <span class="math inline">\(v\)</span> is the inhibitor.</p>
<p>Now let us check each of the conditions a) to d) from <a href="#eq-turingconditions" class="quarto-xref">Eq.&nbsp;<span>7.53</span></a>. Condition a) becomes <span class="math inline">\(1-b^2&lt;0\)</span> and hence <span class="math inline">\(b^2&gt;1\)</span>. Condition b) becomes <span class="math inline">\(-b^2+2b^2&gt;0\)</span> which is automatically satisfied. Condition c) becomes <span class="math inline">\(D_2-b^2D_1&gt;0\)</span> which implies <span class="math inline">\(D_1b^2&lt;D_2\)</span>, which means that the ratio <span class="math inline">\(d=D_2/D_1&gt;b^2\)</span>. Condition d) becomes <span class="math inline">\((D_2-b^2D_1)^2&gt;4D_1D_2b^2\)</span>. Multiplying out the square and bringing everything to one side gives <span class="math inline">\(b^4D_1^2-6D_1D_2b^2+D_2^2&gt;0\)</span>. We can rewrite this in terms of the ratio <span class="math inline">\(d=D_2/D_1\)</span> as <span id="eq-schnakcond"><span class="math display">\[
b^4-6db^2+d^2&gt;0.
\tag{7.59}\]</span></span> The graph of the left-hand side against <span class="math inline">\(d\)</span> is a parabola that opens upwards and has roots at <span id="eq-schnakd"><span class="math display">\[
d_\pm=3b^2\pm\sqrt{9b^4-b^4}=b^2(3\pm\sqrt{8}).
\tag{7.60}\]</span></span> The condition in <a href="#eq-schnakcond" class="quarto-xref">Eq.&nbsp;<span>7.59</span></a> tells us that <span class="math inline">\(d\)</span> is outside the interval <span class="math inline">\((d_-,d_+)\)</span>. We have also already derived that <span class="math inline">\(d&gt;b^2&gt;d_-\)</span>. So the final condition on the ratio of the diffusion rates is <span id="eq-schnakcond2"><span class="math display">\[
d=\frac{D_2}{D_1}&gt;b^2(3+\sqrt{8}).
\tag{7.61}\]</span></span> This means that the inhibitor must diffuse at least <span class="math inline">\(b^2(3+\sqrt{8})\)</span> times faster than the activator in order for a Turing instability to occur.</p>
<!---
### Finite domain

We now restrict space to a finite interval $[0,L]$ and impose no-flux boundary conditions at the boundaries:
$$
\partial_xu(0,t)=\partial_xu(L,t)=0,~~~\partial_xv(0,t)=\partial_xv(L,t)=0.
$$ {#eq-schnakbc}
This implies that also the perturbations away from the homogeneous steady state must satisfy these boundary conditions:
$$
\partial_x\xi(0,t)=\partial_x\xi(L,t)=0,~~~\partial_x\eta(0,t)=\partial_x\eta(L,t)=0.
$$ {#eq-schnakbc2}
Substituting our harmonic wave Ansatz @eq-turingpert4 into the boundary condition $\partial_x\xi(0,t)=0$ gives $k\cos(\alpha)=0$ and hence $\alpha=\pi/2$. Substituting it into the boundary condition $\partial_x\xi(L,t)=0$ gives $k\cos(kL+\pi/2)=0$. This means that $kL$ must be a multiple of $\pi$ and hence $k$ must be an integer multiple of $\pi/L$. We can write this as
$$
k=k_n=\frac{n\pi}{L},~~~n=1,2,...
$$ {#eq-schnakk}
The boundary conditions for $\eta$ are satisfied for the same set of wave numbers $k_n$.

We had seen that only perturbations with wave numbers in the interval $[k_-,k_+]$ can grow, with $k_\pm$ given by @eq-turingk. So the condition for a Turing instability in our bounded domain is that there is at least one $n$ for which $k_n$ is in the interval $[k_-,k_+]$. This gives the condition $k_1=\pi/L<k_+$ or equivalently $L>\pi/k_+$. Turing instabilities can only occur in domains that are large enough.


## Directed motion

So far we have only discussed random motion. We now want to consider directed motion. There are many reasons for individuals to move in a directed way. For example, they might move towards a food source or away from a predator. This kind of movement is referred to as __taxis__: the movement towards (or away from) a higher concentration of something (prey, predator, light, nutrient). If the something is a chemical this is called __chemotaxis__. Chemotaxis is a very important mechanism in biology. For example, immune cells move towards sites of infection, sperm cells move towards the egg, and bacteria move towards nutrients.

To model this, we introduce the density $n(\mathbf{x},t)$ of individuals and the density $a(\mathbf{x},t)$ of the chemical, which we will assume is an attractant, i.e., individuals move towards higher concentrations of the chemical. The individuals move in response to the gradient of the chemical, so the chemotactic movement is described by a flux
$$
\mathbf{J}_c=\chi n\mathbf{\nabla} a,
$$ {#eq-chemotaxis}
where $\chi>0$ is the chemotactic sensitivity. Compare this with the diffusive flux
$$
\mathbf{J}_d=-D\mathbf{\nabla} n.
$$ {#eq-diffusion}

The equation for the density of individuals is then
$$
\partial_t n=f(n)-\mathbf{\nabla}\cdot\mathbf{J},
$$ {#eq-chemotaxisn}
where $f(n)$ describes the local population dynamics. This is just the higher-dimensional version of @eq-transport.
We can now plug in the expressions for the fluxes and get
$$
\partial_t n=f(n)-\mathbf{\nabla}\cdot(\chi n\mathbf{\nabla} a)
+\mathbf{\nabla}\cdot(D_n\mathbf{\nabla} n).
$$ {#eq-chemotaxisn3}
The attractant $a$ is governed by the equation
$$
\partial_t a=g(a,n)+\mathbf{\nabla}\cdot(D_a\mathbf{\nabla} n).
$$ {#eq-chemotaxisa}
The local dynamics of the attractant is described by $g(a,n)$ and the diffusion of the attractant has diffusion coefficient $D_a$.

### Slime mould aggregation

A fascinating example of chemotaxis is the aggregation of slime moulds. Slime moulds are single-celled organisms that live in the soil and feed on bacteria. When the food supply runs out, the slime moulds aggregate to form a fruiting body that releases spores. The aggregation is guided by a chemical attractant. The slime moulds move towards higher concentrations of the attractant. The attractant is a chemical that is released by the slime moulds themselves.

When modelling the slime mould aggregation we can neglect the population dynamics which are not relevant for the aggregation process and thus set $f(n)=0$. For the local dynamics of the attractant we use
$$
g(a,n)= h n - q a,
$$ {#eq-slimeg}
where $h>0$ is the rate at which the attractant is produced by the slime moulds and $q>0$ is the rate at which the attractant is degraded. We assume that the chemotactic sensitivity $\chi$ and the diffusion coefficients $D_n$ and $D_a$ are positive constants. We also restrict ourselves again to motion in one dimension. 
Then the equations for the slime mould aggregation are:
$$\begin{split}
\partial_t n&=-\chi\partial_x(n\partial_x a)+D_n\partial_x^2 n,\\
\partial_t a&=hn-q a+D_a\partial_x^2 a.
\end{split}$$ {#eq-slime}
The homogeneous steady state where $n(x,t)=n^*$ and $a(x,t)=a^*$ has to satisfies $h n^*=q a^*$. We can now linearise the equations around the homogeneous steady state by setting $n(x,t)=n^*+\xi(x,t)$ and $a(x,t)=a^*+\eta(x,t)$ with $\xi$ and $\eta$ small. We get
$$\begin{split}
\partial_t \xi&=-\chi n^*\partial_x^2\eta+D_n\partial_x^2\xi,\\
\partial_t \eta&=h\xi-q\eta+D_a\partial_x^2\eta.
\end{split}$$ {#eq-slimepert}
We write this linear system in matrix form as
$$
\partial_t\begin{pmatrix}\xi\\\eta\end{pmatrix}=\begin{pmatrix}D_n\partial_x^2&-\chi n^*\partial_x^2\\h&-q+D_a\partial_x^2\end{pmatrix}\begin{pmatrix}\xi\\\eta\end{pmatrix}.
$$ {#eq-slimemat}
To solve this we make the Ansatz
$$
\begin{pmatrix}\xi\\\eta\end{pmatrix}=\begin{pmatrix}B_1\\B_2\end{pmatrix}e^{\sigma_k t}\sin(kx+\alpha).
$$ {#eq-slimeansatz}
Plugging this into @eq-slimemat and dividing by $e^{\sigma_k t}\sin(kx+\alpha)$ gives
$$
\sigma\begin{pmatrix}B_1\\B_2\end{pmatrix}=\begin{pmatrix}-D_nk^2&\chi n^*k^2\\h&-q-D_ak^2\end{pmatrix}\begin{pmatrix}B_1\\B_2\end{pmatrix}.
$$ {#eq-slimeeig}
We again denote the matrix above as $A(k)$. The condition for the homogeneous steady state to be stable is that the real parts of the eigenvalues $\sigma_k$ are all negative. The condition for the homogeneous steady state to be unstable is that there is at least one $k$ for which the real part of $\sigma_k$ is positive.

To determine the stability we again calculate the trace and determinant of the matrix in @eq-slimeeig. The trace is
$$
\text{tr}(A(k))=-(D_n+D_a)k^2-q.
$$ {#eq-slimetrace}
This is manifestly negative for all $k$, so this does not yet indicate any instability. The determinant is
$$
\det(A(k))=D_nD_ak^4+D_nqk^2-h\chi n^* k^2.
$$ {#eq-slimedet}
This is negative and hence gives an instability if
$$
D_nD_ak^2<h\chi n^* -D_nq
$$ {#eq-slimeinstab}
Because the left-hand side in this inequality is positive, the right-hand side must be positive as well. This gives us the condition
$$
D_n<\frac{h\chi n^*}{q}.
$$ {#eq-slimeinstab2}
This makes sense: if the individuals diffuse too fast, the aggregation can not happen.
We can also rewrite the condition for the aggregation as
$$
h>\frac{qD_n}{\chi n^*}.
$$ {#eq-slimeinstab3}
So aggregation only happens if the rate of production of the attractant is large enough.

--->
</section>
</section>
<section id="exercises" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="exercises"><span class="header-section-number">7.5</span> Exercises</h2>
<section id="fishing-model-with-diffusion-1" class="level4">
<h4 class="anchored" data-anchor-id="fishing-model-with-diffusion-1">* Fishing model with diffusion</h4>
<div id="exr-fish" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.1</strong></span> &nbsp;</p>
<!--- From Exam 2020 --->
<p>A population of fish <span class="math inline">\(F(x,t)\)</span> in a river of width <span class="math inline">\(L\)</span> with banks at <span class="math inline">\(x=0\)</span> and <span class="math inline">\(x=L\)</span> can be modelled by the partial differential equation <span id="eq-fish"><span class="math display">\[
\frac{\partial F}{\partial t} = rF\left( 1-\frac{F}{K} \right) + D\frac{\partial^2 F}{\partial x^2},
\tag{7.62}\]</span></span> where <span class="math inline">\(r\)</span>, <span class="math inline">\(K\)</span> and <span class="math inline">\(D\)</span> are positive constants. No-flux boundary conditions are applied at <span class="math inline">\(x=L\)</span>. On the left bank at <span class="math inline">\(x=0\)</span> the shore-based fishermen catch all of the fish, so that <span class="math inline">\(u(0,t)=0\)</span> for all times. We wish to find the minimum width of the river to ensure the fish population does not collapse.</p>
<ol type="1">
<li><p>First determine the spatially uniform steady states and indicate their stability.</p></li>
<li><p>Linearise the system for small <span class="math inline">\(F\)</span>.</p></li>
<li><p>By considering a solution of the form <span class="math inline">\(F(x,t) = e^{\lambda t} \left( A \cos kx + B \sin kx \right)\)</span> show that <span id="eq-fishlambda"><span class="math display">\[
\lambda = \lambda_n = r-k_n^2D,
\tag{7.63}\]</span></span> where <span class="math display">\[
k = k_n = \frac{(2n+1)\pi }{2L}, ~~~ n = 0,~1,~2,...
\]</span></p></li>
<li><p>Hence, determine the condition on <span class="math inline">\(L\)</span> for the fish population not to collapse.</p></li>
</ol>
</div>
<hr>
</section>
<section id="travelling-wave-in-1-species-reaction-diffusion-model" class="level4">
<h4 class="anchored" data-anchor-id="travelling-wave-in-1-species-reaction-diffusion-model">Travelling wave in 1-species reaction-diffusion model</h4>
<div id="exr-spatial1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.2</strong></span> &nbsp;</p>
<!--- From sheet 4 --->
<p>A reaction-diffusion population model has the form <span id="eq-rd1"><span class="math display">\[
\frac{\partial u}{\partial t}=f(u)+D\frac{\partial^2u}{\partial x^2}
\tag{7.64}\]</span></span> where <span class="math inline">\(D&gt;0\)</span> and where <span class="math inline">\(f\)</span> satisfies <span class="math inline">\(f(0)=f(1)=0\)</span> and <span class="math inline">\(f(u)&gt;0\)</span> for <span class="math inline">\(u\in(0,1)\)</span>.</p>
<ol type="a">
<li><p>Convert this equation into travelling wave form by making the Ansatz that <span class="math inline">\(u(x,t)=U(z)\)</span> and <span class="math inline">\(v(x,t)=V(z)\)</span> with <span class="math inline">\(z=x-ct\)</span>.</p></li>
<li><p>Assuming that a solution exists such that <span class="math inline">\(U(-\infty)=1\)</span>, <span class="math inline">\(U(\infty)=0\)</span> show, by linearising the equation at the leading edge, that for a biologically realistic solution the wave speed <span class="math inline">\(c\)</span> satisfies <span class="math inline">\(c\geq 2\sqrt{Df'(0)}\)</span>.</p></li>
<li><p>Suppose that, instead, <span class="math inline">\(f(u)=0\)</span>. Show that the equation in travelling wave form becomes <span class="math inline">\(DU''+c\,U'=0\)</span>. Give the general solution of this. Does the solution look realistic for a function that represents a population?</p></li>
</ol>
</div>
<hr>
</section>
<section id="travelling-wave-in-2-species-reaction-diffusion-model" class="level4">
<h4 class="anchored" data-anchor-id="travelling-wave-in-2-species-reaction-diffusion-model">* Travelling wave in 2-species reaction-diffusion model</h4>
<div id="exr-spatial2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.3</strong></span> &nbsp;</p>
<!--- From sheet 4 --->
<p>Consider the system <span id="eq-rd2"><span class="math display">\[
\begin{split}
\frac{\partial u}{\partial t}&amp;=-u^2v \\
\frac{\partial v}{\partial t}&amp;=u^2v-\rho
v+\frac{\partial^2v}{\partial x^2}
\end{split}
\tag{7.65}\]</span></span> where <span class="math inline">\(\rho\)</span> is a positive constant. Convert this system into travelling wave form by making the Ansatz that <span class="math inline">\(u(x,t)=U(z)\)</span> and <span class="math inline">\(v(x,t)=V(z)\)</span> with <span class="math inline">\(z=x-ct\)</span>, and show in particular that <span id="eq-rd3"><span class="math display">\[
-c\frac{dV}{dz}=c\frac{dU}{dz}-\frac{\rho
  c}{U^2}\frac{dU}{dz}+\frac{d^2V}{dz^2}.
\tag{7.66}\]</span></span> Consider a solution of the travelling wave equations such that <span class="math inline">\(U(\infty)=1\)</span>, <span class="math inline">\(U(-\infty)=a\)</span>, <span class="math inline">\(V(\pm\infty)=0\)</span> for some <span class="math inline">\(a&lt;1\)</span>. By integrating the above equation from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span> and imposing the boundary conditions, determine the value of <span class="math inline">\(a\)</span>. Also determine a lower bound on the wave velocity <span class="math inline">\(c\)</span> by linearising around the leading edge of the wave.</p>
</div>
<hr>
</section>
<section id="sir-model-with-logistic-growth" class="level4">
<h4 class="anchored" data-anchor-id="sir-model-with-logistic-growth">SIR model with logistic growth</h4>
<div id="exr-spatial3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.4</strong></span> &nbsp;</p>
<!--- From sheet 4 --->
<p>Assume that in the absence of rabies, the fox population is described by a logistic model with intrinsic growth rate <span class="math inline">\(r\)</span> and carrying capacity <span class="math inline">\(K\)</span>. Adding this population dynamics to the SIR model gives the equations <span id="eq-sirlogistic"><span class="math display">\[\begin{split}
\partial_t S&amp;=rS\left(1-\frac{S}{K}\right)-\beta SI\\
\partial_t I&amp;=\beta SI-\gamma I.
\end{split} \tag{7.67}\]</span></span> We ignore the removed component <span class="math inline">\(R\)</span>, which in this case would correspond to dead foxes.</p>
<ol type="a">
<li><p>Show that this model can be written in non-dimensionalised form as <span id="eq-sirlogistic2"><span class="math display">\[\begin{split}
\partial_{\tilde{t}} u&amp;=bu(1-u)-uv\\
\partial_{\tilde{t}} v&amp;=uv-mv.
\end{split} \tag{7.68}\]</span></span></p></li>
<li><p>Determine the steady state solutions (fixed points). Under what condition on the parameters is there an endemic state?</p></li>
</ol>
<p>Now assume that both susceptible and infected foxes move around randomly, but at different rates. This adds diffusion terms to the SIR model, where now <span class="math inline">\(S=S(x,t)\)</span> and <span class="math inline">\(I=I(x,t)\)</span> denote densities in space. <span id="eq-sirlogistic3"><span class="math display">\[\begin{split}
\partial_t S&amp;=rS\left(1-\frac{S}{K}\right)-\beta SI+D_1\partial_x^2S\\\
\partial_t I&amp;=\beta SI-\gamma I+D_2\partial_x^2I.
\end{split} \tag{7.69}\]</span></span></p>
<ol start="3" type="a">
<li>Give expressions for <span class="math inline">\(\tilde{x}\)</span> and <span class="math inline">\(d\)</span> such that this model can be written in non-dimensionalised form as <span id="eq-sirlogistic4"><span class="math display">\[\begin{split}
\partial_{\tilde{t}} u&amp;=bu(1-u)-uv+\partial_{\tilde{x}}^2u\\
\partial_{\tilde{t}} v&amp;=uv-m v+d\,\partial_{\tilde{x}}^2v
\end{split} \tag{7.70}\]</span></span></li>
</ol>
<p>We will now work with these non-dimensional equations but drop the tildes to avoid clutter.</p>
<ol start="4" type="a">
<li><p>Make the travelling wave Ansatz <span id="eq-sirlogistic5"><span class="math display">\[
u(x,t)=A(z),~~~v(x,t)=B(z)
\tag{7.71}\]</span></span> with <span class="math inline">\(z=x-ct\)</span> for some wave speed <span class="math inline">\(c\)</span> and derive the system of ODEs describing the functions <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p></li>
<li><p>If <span class="math inline">\(A(\infty)=1\)</span>, what are <span class="math inline">\(A(-\infty), B(\infty)\)</span> and <span class="math inline">\(B(-\infty)\)</span>? Make a sketch of <span class="math inline">\(A(z)\)</span> and <span class="math inline">\(B(z)\)</span> and indicate the direction of travel with an arrow.</p></li>
<li><p>By linearising about the leading edge of the wave where <span class="math inline">\(B\)</span> is very small, determine a lower limit on the wave speed <span class="math inline">\(c\)</span>.</p></li>
</ol>
</div>
<hr>
</section>
<section id="derive-turing-instability" class="level4">
<h4 class="anchored" data-anchor-id="derive-turing-instability">Derive Turing instability</h4>
<div id="exr-spatial4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.5</strong></span> Consider the reaction-diffusion model <span id="eq-ex_turing"><span class="math display">\[\begin{split}
\frac{\partial u}{\partial t}&amp;=a-u+u^2v+D_1\frac{\partial^2u}{\partial
  x^2} \\
\frac{\partial v}{\partial t}&amp;=b-u^2v+D_2\frac{\partial^2v}{\partial
  x^2}
\end{split} \tag{7.72}\]</span></span> where <span class="math inline">\(b&gt;0\)</span> and <span class="math inline">\(a+b&gt;0\)</span>.</p>
<p>Show that a spatially uniform steady state solution <span class="math inline">\((u^*,v^*)\)</span> exists for this model and is given by <span class="math inline">\((u^*,v^*)=(a+b\,,\;b/(a+b)^2)\)</span>. Show that the conditions for this steady state to be driven unstable by diffusion are that the three inequalities <span class="math display">\[
b-a&lt;(a+b)^3\]</span> <span id="eq-turing2"><span class="math display">\[
\left[D_2\left(\frac{b-a}{a+b}\right)-D_1(a+b)^2\right]^2&gt;4D_1D_2(a+b)^2
\tag{7.73}\]</span></span> <span id="eq-turing3"><span class="math display">\[
D_2\left(\frac{b-a}{a+b}\right)-D_1(a+b)^2&gt;0
\tag{7.74}\]</span></span> should all hold simultaneously.</p>
</div>
<hr>
</section>
<section id="conditions-for-turing-instability" class="level4">
<h4 class="anchored" data-anchor-id="conditions-for-turing-instability">* Conditions for Turing instability</h4>
<div id="exr-spatial6" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.6</strong></span> Consider the reaction-diffusion model <span id="eq-ex_turing4"><span class="math display">\[\begin{split}
\frac{\partial c_1}{\partial t}&amp;=\delta -kc_1 - c_1c_2^2 + D_1\frac{\partial^2c_1}{\partial
  x^2} \\
\frac{\partial c_2}{\partial t}&amp;=kc_1+c_1c_2^2 - c_2 + D_2\frac{\partial^2c_2}{\partial
  x^2}
\end{split} \tag{7.75}\]</span></span> where <span class="math inline">\(k&gt;0\)</span> and <span class="math inline">\(\delta&gt;0\)</span>.</p>
<p>Show that a spatially uniform steady state solution <span class="math inline">\((c_1^*,c_2^*)\)</span> exists for this model and give the conditions for this steady state to be driven unstable by diffusion. You may use any results derived in the lectures.</p>
</div>
<!---
----------------------------------------------------------------------

#### Slime mould with boundary
::: {#exr-spatial5}
In the model for the aggregation of slime mould amoebae
suppose that the spatial domain is $0\leq x\leq L$ rather than
$-\infty<x<\infty$. Show that the conditions for aggregation to occur
are $\chi a^*f>k\mu$ and
$$
L>\pi\sqrt{\frac{D\mu}{\chi a^* f-k\mu}}.
$$ {#eq-slime2}
:::

--->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./epidemics.html" class="pagination-link" aria-label="Epidemics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Epidemics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./solutions.html" class="pagination-link" aria-label="Solutions">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solutions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/edit/main/spatial.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>