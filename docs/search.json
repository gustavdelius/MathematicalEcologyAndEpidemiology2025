[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Mathematical Ecology and Epidemiology",
    "section": "",
    "text": "Welcome\nThis site will contain the lecture notes for the Ecology and Epidemiology part of the “Mathematical Ecology, Epidemiology and Evolution” module taught at the University of York in the Spring of 2025. The mathematics used in Mathematical Ecology and in Mathematical Epidemiology are quite similar, whereas the mathematics used in Mathematical Evolution has a different flair and that part is taught by a different lecturer: George Constable.\nThe Mathematical Ecology and Epidemiology part is taught in three two-week blocks, with each block consisting of 6 lectures and one examples class. Between each block there will be a two-week block of Mathematical Evolution.\nThese days it is no longer necessary to explain why it is important to apply mathematics to ecology or to epidemiology. We are causing global warming and the only way to predict and hence mitigate the ecological consequences is to employ mathematical models. During the Covid epidemic the public was informed daily about the latest prediction about the state of the epdidemic derived from mathematical models, often summarised in terms of the \\(R_0\\) value. People with skills in mathematical modelling are clearly crucial in these fields and will have a great impact. Furthermore, the techniques of mathematical modelling are transferable to other domains. The skills you acquire in this module will also be useful if you want to model the economy or the climate, to mention just two.\nIn this module we will concentrate on mathematical models that capture the essence of the real-world phenomena and strip away most of the details. Our models will be simple enough to allow for an analytical understanding of the model predictions. In practice, more complicated models are also employed, which need to be solved numerically. Only if you are taking this module as an M-level module will you be expected to perform numerical calculations. It is very wise to first start with a simple model for which you can obtain exact results before adding complications that force you to turn to numerics. That way you can test your numerics against the exact results in the regime where they are available. Also the insight from the simple models will allow you to better interpret the output from numerical models. This deeper understanding will give you a big advantage when you continue into applied research. But this understanding is also beneficial to you as a citizen who wants to take part in discussions about ecological preservation or of vaccination or similar questions of societal importance.\nThe notes will be released after each lecture and will continue to be periodically revised. Whenever you spot something that is not quite right, please email me at gustav.delius@york.ac.uk.\nExercises are scattered throughout the notes. Exercises marked with a * are essential and are to be handed in. Exercises marked with a + are important and you are urged to complete them. Other exercises are optional but recommended. Exercises marked with an o are likely to be covered in a problems class.\nYour solutions to the essential exercises covered throughout each 2 week block are due on Monday at 9:00 in the week following that block, i.e., in weeks 3, 5, 7, 9 and 11. The exercises will then be discussed at a seminar in that week. You will then be very well prepared for the summative Moodle Quizzes that will be released at 14:00 on Thursdays in Weeks 3, 5, 7, 9 and 11 and are due 24 hours later (14:00 on Fridays of Weeks 3, 5, 7, 9 and 11). These quizzes should not take you long to complete because they are based on the exercises that have already been discussed at the seminar.\nFor details of how this module will be assessed, see the assessment information on the VLE.\nIn this part of the module you are allowed (and encouraged) to get as much help from AIs (like Gemini) and CASs (Computer Algebra Systems like Wolfram Alpha) as you like. Just be aware that you won’t have access to an AI or to a CAS in the final exam, so make sure that you use the AI to learn things, not to let the AI do the work for you.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "continuous_time.html",
    "href": "continuous_time.html",
    "title": "1  Continuous-time population models",
    "section": "",
    "text": "Learning Objectives\nPopulation dynamics is the study of how populations change over time. A population can be any group of individuals of the same species in a particular area, such as a population of bacteria in a petri dish, a herd of deer in a forest, the Cod stock in the Baltic Sea, or the human population of a country. Understanding how population size evolves is important in many fields, including ecology, conservation biology, epidemiology, and resource management.\nTo model a population mathematically, we introduce a function \\(N(t)\\) that represents the number of individuals in the population at time \\(t\\). We assume that at the starting time, which we take to be \\(t=0\\), the population has some initial size \\(N(0)=N_0\\).\nSince the population size changes over time, we are interested in its rate of change, which describes how quickly individuals are added or removed from the population. There are several fundamental processes that affect population size:\nThese processes together determine the overall rate of change of the population, which we can express mathematically as: \\[\n\\frac{dN}{dt} = \\text{birth rate} - \\text{death rate} + \\text{immigration rate} - \\text{emigration rate}.\n\\tag{1.1}\\] The idea behind this approach is that if we understand how the rates at which these processes take place depend on the population number \\(N\\), then we can find \\(N(t)\\) by solving the above differential equation. Different assumptions about how these rates depend on the population size (or possibly other factors such as available resources or competition) lead to different population models. In the following sections, we will examine some influential models that help us understand different population growth scenarios.\nAfter completing this chapter, you should be able to:",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#learning-objectives",
    "href": "continuous_time.html#learning-objectives",
    "title": "1  Continuous-time population models",
    "section": "",
    "text": "Mathematical Modeling\n\nWrite down differential equations for population dynamics\nIdentify and interpret key parameters in population models\nSolve basic population models analytically\n\nModel Analysis\n\nSketch solutions of population models\nFind steady states of population models\nDetermine stability of steady states\nInterpret phase line diagrams\nPredict long-term behavior of populations\n\nApplications\n\nCompare and contrast different population growth models\nUnderstand how density dependence affects population growth\nAnalyze the effects of different harvesting strategies",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#exponential-model",
    "href": "continuous_time.html#exponential-model",
    "title": "1  Continuous-time population models",
    "section": "1.1 Exponential model",
    "text": "1.1 Exponential model\nThis is the simplest and oldest model, introduced by Thomas Robert Malthus in 1798. If we assume that the per-capita birth rate \\(b\\) and the per-capita death rate \\(d\\) are fixed constants, then the general differential equation Eq. 1.1 becomes the linear equation \\[\n\\frac{dN}{dt}=bN-dN=rN,\n\\tag{1.2}\\] where we introduced the new parameter \\(r=b-d\\). This equation is easy to solve: \\[\nN(t)=N_0\\,e^{rt}.\n\\tag{1.3}\\] If the birth rate exceeds the death rate and hence \\(r&gt;0\\), the model predicts exponential growth. In the opposite case of lower birth rate than death rate the model predicts exponential decay of the population number towards extinction. Only when birth and death rates are perfectly equal can the population stay steady over time. We illustrate that in Figure 1.1.\n\n\n\n\n\n\n\n\nFigure 1.1: Solutions to the exponential model.\n\n\n\n\n\nYou may note that in this model \\(N(t)\\) can take on non-integer values, so strictly speaking it can not describe the number of individuals. When the population is large, this is not a big problem. You can simply round \\(N(t)\\) to the nearest integer without making much of a change. However if one wants to describe small populations correctly, one would have to switch from the deterministic differential equation to a stochastic process that models each birth and death individually. In these notes we will restrict ourselves to deterministic models.\n\n\nExercise 1.1 (* Immigration) Let us try to model the population of a country with currently \\(N_0=70\\) million inhabitants. Let us assume that the per-capita death rate is \\(d = 0.015\\) deaths per year and the per-capita birth rate is \\(b=0.01\\) births per year. In addition there is a constant rate of immigration of \\(a=300,000\\) individuals per year.\n\nWrite down the ODE for the population number \\(N(t)\\). At this point, do not use the numerical values yet but the symbols.\nSolve the ODE for \\(N(t)\\) with the given initial condition. You may not have solved an ODE for some while so may need to look back at your Calculus notes. But don’t panic: the equation from part (i) should be a linear, non-homogeneous, first-order ODE with constant coefficients, so you definitely know how to solve it. The easiest way to go about it is to first convert it into a homogeneous ODE by shifting the dependent variable.\nSubstitute the numerical values to obtain the projected population after \\(10\\) years.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#logistic-model",
    "href": "continuous_time.html#logistic-model",
    "title": "1  Continuous-time population models",
    "section": "1.2 Logistic model",
    "text": "1.2 Logistic model\nExponential population growth can not be maintained for ever. There will be a limit to the size of population that an ecosystem can maintain. When the population gets closer to this limit its growth rate will decrease, for example due to competition for limited food sources or space, or due to disease. This decrease in the growth rate is captured by the logistic equation \\[\n\\frac{dN}{dt}=rN\\left(1-\\frac{N}{K}\\right),\n\\tag{1.4}\\] where \\(K\\) is the carrying capacity of the environment. The extra factor of \\(1-N/K\\) decreases the growth rate towards zero as the population number \\(N\\) approaches the carrying capacity \\(K\\).\nIn Figure 1.2 we make a plot of the right-hand side of the logistic equation Eq. 1.4 to see how the growth rate depends on the population number. While that figure was created by the computer, the plot is easy to sketch by hand because the function we want to sketch is simply an upside-down parabola. The maximum of the parabola is at \\(N=K/2\\) and the parabola crosses the \\(N\\)-axis at \\(N=0\\) and \\(N=K\\).\n\n\n\n\n\n\n\n\nFigure 1.2: The logistic growth rate as a function of the population number.\n\n\n\n\n\nWe see that the growth rate is zero at \\(N=0\\) and \\(N=K\\), and it is maximal at \\(N=K/2.\\) By realising that \\(dN/dt\\) is the slope of the graph of \\(N(t)\\) we can sketch a few solutions to the logistic equation Eq. 1.4 in Figure 1.3.\n\n\n\n\n\n\n\n\nFigure 1.3: Solutions to the logistic equation.\n\n\n\n\n\nThe logistic equation Eq. 1.4 can be solved analytically to give \\[\nN(t)=\\frac{K}{1+\\left(\\frac{K}{N_0}-1\\right)e^{-rt}}=\\frac{N_0 K e^{rt}}{K+N_0(e^{rt}-1)}.\n\\tag{1.5}\\]\n\n\nExercise 1.2 (Solving logistic equation) By using separation of variables and partial fractions, solve the logistic model Eq. 1.4 with initial condition \\(N(0)=N_0\\) to derive Eq. 1.5.\nThis exercise is for you if you like practising your skills at solving ODEs. The logistic model is one a the few non-linear models that can be solved relatively easily",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#allee-effect",
    "href": "continuous_time.html#allee-effect",
    "title": "1  Continuous-time population models",
    "section": "1.3 Allee effect",
    "text": "1.3 Allee effect\nWarder Clyde Allee (1885-1955) was an American ecologist who studied the effects of population density on the growth rate of a population. He found that in some cases the per-capita growth rate can increase with \\(N\\). This is called the Allee effect. It is not captured by the logistic model because there the per-capita growth rate decreases linearly iwth population size.\nThere can be several causes for an Allee effect. For example:\n\nIn many plant species, pollination becomes less effective at low densities because pollinators are less likely to visit sparse populations\nSocial animals like wolves hunt more successfully in packs, so individuals in larger groups have higher survival rates\nColonial seabirds like puffins rely on large colony sizes for protection from predators\nMany marine broadcast spawners (like sea urchins or abalone) require sufficient population density for successful fertilization\nSmall populations of endangered species may suffer from genetic inbreeding, reducing reproductive success\n\nBut even in the case of an Allee effect, eventually the population growth has to slow again as the population reaches the carrying capacity of the ecosystem.\nFigure Figure 1.4 shows the per-capita growth rate as a function of the population number for exponential growth in black, for logistic growth in blue and two different growth rates exhibiting the Allee effect in green and red.\n\n\n\n\n\n\n\n\nFigure 1.4: The per-capita growth rate as a function of the population number.\n\n\n\n\n\nThe green curve in Figure 1.4 shows a weak Allee effect, where the per-capita rate is small but positive for small population sizes, then initially increases with the population size before then decreasing again as the population approaches its carrying capacity. The red curve shows a strong Allee effect, which is similar but so strong that the growth rate starts out not just small but actually negative for small \\(N\\).\nThe simplest model for the Allee effect is the logistic equation with a modified growth rate that includes another factor that decreases the growth rate for small \\(N\\): \\[\n\\frac{dN}{dt}=rN\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{K_0}-1\\right).\n\\tag{1.6}\\] If \\(0&lt;K_0&lt;K\\), this exhibits the strong Allee effect because the growth rate is negative when \\(N&lt;K_0\\). This means that the population will be driven towards extinction when it is below the threshold size \\(K_0\\) and it will grow towards its carrying capacity when it is above \\(K_0\\). This is illustrated in Figure 1.5.\n\n\n\n\n\n\n\n\nFigure 1.5: The Allee growth rate as a function of the population number.\n\n\n\n\n\nThis phenomenon is important for conservation biology because it means that small populations are particularly vulnerable to extinction. It is also important for fisheries management because it means that the population can collapse if it falls below a certain threshold size. The phenomenon is called “critical depensation”. We will meet it again when we discuss harvesting later in this section.\n\n\nExercise 1.3 (*Sketching solutions) Consider the population model with carrying capacity and Allee effect given by Eq. 1.6 with \\(r&gt;0\\) and \\(K&gt;K_0&gt;0\\). Simply by considering the shape of the right hand side, sketch a graph with several solutions for different initial conditions. Choose two initial conditions between \\(0\\) and \\(K_0\\), two initial conditions between \\(K_0\\) and \\(K\\) and one initial condition larger than \\(K\\). Note that the graph only needs to be qualitatively correct, similar to the rough sketch for the solutions of the logistic model sketched in the first lecture. You are explicitly asked not to make the plot with a computer as in Figure 1.3.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#general-autonomous-ode-model",
    "href": "continuous_time.html#general-autonomous-ode-model",
    "title": "1  Continuous-time population models",
    "section": "1.4 General autonomous ODE model",
    "text": "1.4 General autonomous ODE model\nThe logistic model is a special case of a general autonomous ordinary differential equation (ODE) model \\[\n\\frac{dN}{dt}=f(N),\n\\tag{1.7}\\] where \\(f(N)\\) is a function of \\(N\\) only, not \\(t\\). The logistic equation Eq. 1.4 is an example of such a model with\n\\[\nf(N)=rN\\left(1-\\frac{N}{K}\\right).\n\\tag{1.8}\\]\nIf \\(f\\) is Lipschitz continuous, then, given \\(N(0)=N_0\\), there exists a unique solution \\(N(t)\\) to the initial value problem Eq. 1.7. This is a consequence of the Picard-Lindelöf theorem.\nWe are interested in the steady states of the model, i.e. the values \\(N^*\\) for which \\(f(N^*)=0\\). These are the values of \\(N\\) for which the population number does not change. To determine the stability of the steady states, we can look near \\(N^*\\) by writing \\(N(t)=N^*+n(t)\\) with \\(n(t)\\) small. Then \\[\n\\frac{dN}{dt}=\\frac{dN^*}{dt}+\\frac{dn}{dt} = f(N^*+n(t))\\approx f(N^*)+f'(N^*)\\,n(t).\n\\tag{1.9}\\] We now use that \\(dN^*/dt=0\\) and \\(f(N^*)=0\\) to find \\[\n\\frac{dn}{dt}\\approx f'(N^*)\\,n(t).\n\\tag{1.10}\\] This is a linear equation for \\(n(t)\\) with solution \\[\nn(t)=n(0)e^{f'(N^*)t}\n\\tag{1.11}\\] and we can use the sign of \\(f'(N^*)\\) to determine the stability of the steady state:\n\nIf \\(f'(N^*)&lt;0\\), then \\(n(t)\\) will decrease towards zero, and the steady state is stable.\nIf \\(f'(N^*)&gt;0\\), then \\(n(t)\\) will increase away from zero, and the steady state is unstable.\n\nIf \\(f'(N^*)=0\\), then we need to look at higher order terms to determine the stability.\nWe illustrate this in the example of the logistic model. The fixed points are \\(N^*=0\\) and \\(N^*=K\\). The derivative of \\(f(N)\\) is \\[\nf'(N)=r\\left(1-\\frac{2N}{K}\\right).\n\\tag{1.12}\\] So we find that \\(f'(0)=r&gt;0\\) and \\(f'(K)=-r&lt;0\\). This means that the steady state \\(N^*=0\\) is unstable and the steady state \\(N^*=K\\) is stable. This agrees with what we had already seen graphically in Figure 1.2 and Figure 1.3.\nFor a more detailed discussion of one-dimensional autonomous dynamical systems I recommend the first 50 pages of (Strogatz 2000).\n\n\nExercise 1.4 (+Von Bertalanffy growth) Assume the weight \\(w(t)\\) of an individual fish at time \\(t\\) is governed by the differential equation \\[\n\\frac{dw}{dt}=\\alpha\\,w^{2/3}-\\beta w\n\\tag{1.13}\\] with initial condition \\(w(0)=w_0\\) (the weight at birth), and where \\(\\alpha\\) and \\(\\beta\\) are positive parameters depending on the fish species.\n\nWithout solving the differential equation, just thinking about fixed points and their stability, determine \\(\\lim_{t\\rightarrow\\infty}w(t)\\).\nDerive the linear first order ODE for \\(u=w^{1/3}\\) and solve it.\nUse the solution for \\(u\\) to find the solution for \\(w\\).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#harvesting-a-renewable-resource",
    "href": "continuous_time.html#harvesting-a-renewable-resource",
    "title": "1  Continuous-time population models",
    "section": "1.5 Harvesting a renewable resource",
    "text": "1.5 Harvesting a renewable resource\nEcologists model populations not only out of academic interest but also for practical purposes. Humans are interested in exploiting the natural resources. They want to harvest fish from the sea, to hunt deer in the forest, and to cut down trees in the jungle. These days they want to do this in a way that is sustainable, i.e. that does not lead to the extinction of the resource, while at the same time giving the highest yield.\nMy personal interest is in understanding how fish populations react to different kinds of fishing. I use coupled partial integro-differential equations for that purpose, but most fisheries management is based on simpler models and we get a good first idea by using the logistic model, which we will now modify to include harvesting.\n\n1.5.1 Fixed fishing effort\nWe assume that in the absence of fishing the fish population number \\(N(t)\\) is governed by the logistic equation Eq. 1.4. We also assume that the fish are harvested at a rate \\(E N(t)\\), where \\(E\\) is the harvesting rate, which is determined by the effort that is put into fishing. This means that the rate of change in the fish population number is given by \\[\n\\frac{dN}{dt}=rN\\left(1-\\frac{N}{K}\\right)-EN = f(N).\n\\tag{1.14}\\] We can rewrite this equation in the form of a logistic equation with modified parameters: \\[\n\\frac{dN}{dt}=rN\\left(\\left(1-\\frac{E}{r}\\right)-\\frac{N}{K}\\right)\n=(r-E)N\\left(1-\\frac{N}{K\\left(1-\\frac{E}{r}\\right)}\\right).\n\\tag{1.15}\\] This makes it easy to read off the fixed points \\(N^*=0\\) and \\(N^*=K\\left(1-\\frac{E}{r}\\right)\\). The non-zero fixed point gets smaller when fishing effort \\(E\\) increases. This is illustrated in Figure 1.6.\n\n\n\n\n\n\n\n\nFigure 1.6: Growth rate when harvesting with fixed effort.\n\n\n\n\n\nWe are now interested in finding out at what level we should fish in order to achieve the maximum sustainable yield (MSY). This is the level of fishing effort that gives the highest possible yield that can be sustained indefinitely. So we are interested in the yield at the non-zero fixed point \\(N^*=K\\left(1-\\frac{E}{r}\\right)\\). The yield is the amount of fish that can be harvested per unit time, and it is given at the fixed point by \\[\nY^*(E)=EN^*=EK\\left(1-\\frac{E}{r}\\right).\n\\tag{1.16}\\] We can find the maximum of \\(Y^*\\) by differentiating with respect to \\(E\\) and setting the derivative equal to zero: \\[\n\\frac{dY^*}{dE}=K\\left(1-\\frac{2E}{r}\\right)=0.\n\\tag{1.17}\\] We can solve this equation for \\(E\\) to find the optimal fishing effort \\(E^*\\): \\[\nE^*=\\frac{r}{2}.\n\\tag{1.18}\\] The resulting maximum sustainable yield is \\[\nMSY=Y^*(E^*)=\\frac{r}{2}K\\left(1-\\frac{r}{2r}\\right)=\\frac{rK}{4}.\n\\tag{1.19}\\]\n\n\nExercise 1.5 (* Harvesting in Gompertz model) Consider a population \\(N(t)\\) that is described by the by the Gompertz model \\[\n\\frac{dN}{dt} = \\alpha N \\log\\frac{K}{N},\n\\tag{1.20}\\] where \\(\\alpha\\) and \\(K\\) are positive constants. You want to harvest this population, for example by hunting or fishing, with some effort \\(E\\). The rate at which you harvest individuals (which removes them from the population and hence results in an additional source of death) is proportional to the size of the population: \\(Y = E N\\). This is called the yield. Write down the differential equation for \\(N(t)\\) including this harvesting term. Determine the fixed points and their stability. Find the maximum sustainable yield, i.e., the maximum yield that can be sustained indefinitely.\n\n\n\n\n1.5.2 Fixed fishing quota\nFisheries managers in the Mediterranean are aiming to control the fishing effort in order to achieve the maximum sustainable yield, and we have seen how to model that in the previous section. Fisheries in the North Sea or the North Atlantic however are instead managed by setting the total allowable catch (TAC) for the whole fleet. This is a fixed quota for the total amount of fish that can be harvested in a year. To model that policy we use the logistic equation with harvesting, but we replace the harvesting rate \\(EN\\) by a harvesting quota \\(Q\\): \\[\n\\frac{dN}{dt}=rN\\left(1-\\frac{N}{K}\\right)-Q.\n\\tag{1.21}\\] This is visualised in Figure 1.7.\n\n\n\n\n\n\n\n\nFigure 1.7: Growth rate when harvesting with fixed quota.\n\n\n\n\n\nWe see that any non-zero quota leads to critical depensation, i.e., it introduces a critical threshold below which the population will collapse. This is a well-known problem in fisheries management, and it is the reason why the TAC is set to zero for some fish stocks. As the fishing quota is increased, the critical depensation threshold moves to higher population numbers and the stable steady state moves to lower population numbers. Eventually all non-zero fixed points disappear and the population collapses.\n\n\nExercise 1.6 (Harvesting with fixed quota in Gompertz model) As in Exercise 1.5, consider a population \\(N(t)\\) that is described by the Gompertz model. Imagine that this describes a fish population in a lake where fishing is going to be introduced, and that you are tasked with setting the quota that limits the rate at which the fishers are allowed to take fish out of the lake. The fishers demand that you set the quota to the maximum sustainable level. What is the maximum sustainable quota according to the model? Would it be wise to give in to the demand of the fishers and set the quota at this level?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#summary",
    "href": "continuous_time.html#summary",
    "title": "1  Continuous-time population models",
    "section": "Summary",
    "text": "Summary\nThis chapter introduced several key models for population dynamics in continuous time:\n\nExponential Model\n\nSimplest model with constant per-capita birth and death rates\nSolution: \\(N(t) = N_0e^{rt}\\) where \\(r = b-d\\)\nPredicts unlimited growth (\\(r&gt;0\\)) or decay (\\(r&lt;0\\))\nMain limitation: Ignores environmental constraints\n\nLogistic Model\n\nIncorporates carrying capacity \\(K\\)\nGrowth rate decreases as population approaches \\(K\\)\nEquation: \\(\\frac{dN}{dt} = rN(1-\\frac{N}{K})\\)\nHas stable equilibrium at \\(N=K\\) and unstable equilibrium at \\(N=0\\)\n\nAllee Effect Model\n\nCaptures reduced growth at low population densities\nStrong Allee effect has critical population threshold \\(K_0\\)\n\nBelow \\(K_0\\): population declines to extinction\nAbove \\(K_0\\): population grows to carrying capacity\n\n\nHarvesting Models\n\nFixed effort (\\(E\\)): \\(\\frac{dN}{dt} = rN(1-\\frac{N}{K}) - EN\\)\n\nMaximum sustainable yield at \\(E = \\frac{r}{2}\\)\n\nFixed quota (\\(Q\\)): \\(\\frac{dN}{dt} = rN(1-\\frac{N}{K}) - Q\\)\n\nIntroduces critical depensation\nMore risky management approach\n\n\n\nKey concepts:\n\nPopulation dynamics can be modelled by specifying the rates of change coming from processes such as birth, death, immigration, emigration, harvesting, etc.\nFor autonomous models, one can make qualitative sketches of the solutions\nSteady states and their stability determine long-term behavior\nMore realistic models incorporate density dependence\nConservation and management strategies must consider population thresholds\nChoice of harvesting strategy has important implications for sustainability",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "continuous_time.html#further-exercises",
    "href": "continuous_time.html#further-exercises",
    "title": "1  Continuous-time population models",
    "section": "Further exercises",
    "text": "Further exercises\n\nExercise 1.7 (Wasp model) In a colony of the European Hornet there is a single queen that produces all the offspring. It produces two kinds of offspring: workers and reproducers. We’ll denote the number of workers alive at time \\(t\\) by \\(n(t)\\) and the number of reproducers by \\(N(t)\\). The workers are responsible for collecting food. They can’t breed themselves and they die in the winter. However they are necessary to allow the queen to reproduce because without the food that they are collecting the queen would have nothing to eat. So we need workers. But because they die in winter, they don’t help the survival of the colony in the long run. That’s where the reproducers come in. They don’t do any work, but they can, if they survive the winter, breed in the next spring as new queens.\nSo the queen now has a strategy of how to proceed: It first of all needs to produce workers, and from time zero to time \\(t_c\\) it only produces workers. We assume that the birth rate is proportional to the number of workers, so that the total birth rate of workers is \\(r n(t)\\) for some constant \\(r&gt;0\\). The queen then switches to producing only reproducers from time \\(t_c\\) up to the start of winter at time \\(T\\) and we assume that the total birth rate of reproducers is \\(R n(t)\\) for some constant \\(R&gt;0\\). We also assume that until the start of winter there are no deaths.\nWhat is the optimal time \\(t_c\\) at which the queen should switch from producing workers to producing reproducers in order to achieve the largest number of producers \\(N(T)\\) at the start of the winter and therefore to the largest number of wasps in the following year.\n\n\n\nExercise 1.8 (Wasp model with death) In the wasp example from Exercise 1.7, assume that the worker wasps die at a constant per-capita rate \\(d\\) but the reproducers do not die. Also assume that at time t=0 there is one worker, n(0)=1. Keep the birth rates as in Exercise 1.7. Determine the number of workers \\(n(t)\\) for any time between \\(t_c\\) and \\(T\\). Determine the number of reproducers at the onset of winter at time \\(T\\). Derive the optimal time for the switch-over time \\(t_c\\).\n\n\n\nExercise 1.9 (Conceptual Questions)  \n\nHow does the logistic model address the limitations of the exponential model?\nWhy might a population exhibit an Allee effect? Give two biological examples.\nCompare and contrast harvesting with fixed effort versus fixed quota. What are the management implications of each approach?\nUnder what conditions might the exponential model be appropriate, despite its limitations?\n\n\n\n\n\n\n\nStrogatz, Steven H. 2000. Nonlinear Dynamics and Chaos: With Applications to Physics, Biology, Chemistry and Engineering. Perseus Books,U.S.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Continuous-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html",
    "href": "discrete_time.html",
    "title": "2  Discrete-time population models",
    "section": "",
    "text": "Learning Objectives\nSo far we have assumed that the rate of change of the population number has no explicit time dependence. However births and also deaths often happen on an annual cycle. Many fish have their spawning season in the spring, and many birds breed in the summer and annual plants produce their seed and then die in winter. In this case, the rate of change of the population number is not constant, but depends on the time of the year. We can model this by introducing a time dependence in the birth and death rates. However this will lead to equations that will be difficult to analyse. Instead we can give up on the idea of modelling the population numbers continuously through time and instead only follow how the population changes from year to year.\nSo we will use models of the form \\[\nN_{t+1} = f(N_t)\n\\tag{2.1}\\] where \\(N_t\\) is the population number at time \\(t\\) and \\(f\\) is some function. Time \\(t\\) now takes on only integer values, and the population number is only defined at these times. This is called a discrete-time model. Given the initial population number \\(N_0\\), we can calculate the population number at any future time \\(t\\) by iterating the function \\(f\\): \\(N_1 = f(N_0)\\), \\(N_2 = f(N_1)=f(f(N_0)),\\ldots N_t = f(f(\\ldots f(N_0)\\ldots))\\).\nAfter completing this chapter, you should be able to:",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#learning-objectives",
    "href": "discrete_time.html#learning-objectives",
    "title": "2  Discrete-time population models",
    "section": "",
    "text": "Mathematical Modeling\n\nWrite down difference equations for population dynamics\nIdentify and interpret key parameters in discrete-time models\nSolve basic discrete-time population models\n\nModel Analysis\n\nFind fixed points of discrete-time models\nDetermine stability using linear analysis and cobweb diagrams\nInterpret cobweb diagrams\nPredict long-term behavior of populations\n\nBifurcations\n\nIdentify different types of bifurcations in discrete-time models\nAnalyze how model behavior changes at bifurcation points\nUnderstand period-doubling bifurcations unique to discrete systems\n\nApplications\n\nCompare and contrast different discrete-time population models\nAnalyze harvesting strategies in discrete-time models\nUnderstand critical depensation in discrete systems",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#key-ecological-concepts",
    "href": "discrete_time.html#key-ecological-concepts",
    "title": "2  Discrete-time population models",
    "section": "Key Ecological Concepts",
    "text": "Key Ecological Concepts\nBefore diving into the mathematical models, let’s clarify some ecological terminology:\n\nPopulation: A group of individuals of the same species living in a particular area\nCarrying capacity: The maximum sustainable population size in a given environment\nCritical depensation: A threshold effect where populations below a certain size tend to decline to extinction\nDensity dependence: How population growth rates change with population size\nSeasonal reproduction: When breeding occurs at specific times of year rather than continuously\n\nThese concepts will help explain why we choose particular mathematical forms for our models.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#exponential-model",
    "href": "discrete_time.html#exponential-model",
    "title": "2  Discrete-time population models",
    "section": "2.1 Exponential model",
    "text": "2.1 Exponential model\nJust as we started with the exponential model in Chapter 1, we begin here with the simplest discrete-time model \\[\nN_{t+1} = R N_t\n\\tag{2.2}\\] where \\(R&gt;0\\) is the growth factor. This is the discrete-time version of the continuous-time exponential model. The solution to this equation is \\[\nN_t = N_0 R^t.\n\\tag{2.3}\\] It is important to stress that \\(R\\) is not a growth rate but a dimensionless growth factor. Comparing the discrete-time solution to the continuous-time solution \\(N(t)=N_0\\exp(rt)\\) we see that they agree at integer times \\(t\\) if we measure time in years and set \\[\nR=\\exp(r \\cdot 1\\text{ year}).\n\\tag{2.4}\\] If you are confused by the units, remember that the exponential function is dimensionless, so the argument of the exponential function must be dimensionless. We need the extra factor of 1 year because \\(r\\) is a rate and has dimension 1/time.\nThe population number grows exponentially with time if \\(R&gt;1\\) and declines exponentially if \\(R&lt;1\\). To get more realistic models we again need to introduce a limited carrying capacity.\n\nExercise 2.1 (AER) You may be familiar with the distinction between the instantaneous rate \\(r\\) in a continuous-time model and the annual equivalent rate \\(R\\) in the corresponding discrete-time model from your savings account. Assuming that the bank pays interest into your account but you do not withdraw any money, what interest rate \\(r\\) do you need so that the money has increased by 5% after one year, i.e., so that the yearly growth factor is \\(R=1.05\\)?",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#logistic-model",
    "href": "discrete_time.html#logistic-model",
    "title": "2  Discrete-time population models",
    "section": "2.2 Logistic model",
    "text": "2.2 Logistic model\nRecall how we introduced the continuous-time logistic model by assuming that the per-capita birth rate declines linearly with the population number and vanishes when the population reaches its carrying capacity. This gave us the equation \\[\n\\frac{dN}{dt} = rN\\left(1 - \\frac{N}{K}\\right)\n\\tag{2.5}\\] where \\(r\\) is the per-capita growth rate and \\(K\\) is the carrying capacity.\nIt turns out that there are several models which all deserve to be called the discrete-time logistic model. The most famous discrete-time logistic model is the Verhulst model:\n\\[\n\\begin{split}\nN_{t+1}\n&=N_t + R_0 N_t\\left(1 - \\frac{N_t}{K}\\right)\\\\\n&= (R_0+1)N_t\\left(1 - \\frac{N_t}{K(R_0+1)/R_0}\\right)\\\\\n&= RN_t\\left(1-\\frac{N_t}{\\tilde{K}}\\right)=f(N_t),\n\\end{split}\n\\tag{2.6}\\] We have written the model in two alternative forms, with \\(R=R_0+1\\) and \\(\\tilde{K}=K(R_0+1)/R_0\\), because the first form makes it easier to read off the fixed point, while the second form makes the analogy with the continuous-time logistic model more obvious. Eq. 2.6 is also often referred to as the logistic map and is a famous example of a chaotic system.\nAgain it is important to stress that \\(R_0\\) is not a growth rate but a dimensionless growth factor. We are interested in the case where \\(R_0&gt;0\\) and \\(K&gt;0\\).\nA fixed point is a value for which \\(N_{t+1}=N_t\\), i.e. a value of \\(N\\) for which the population number does not change from year to year. Thus it is a value \\(N^*\\) for which \\(f(N^*)=N^*\\). Using the second form of the model, we can see easily that the fixed points are \\(N^*=0\\) and \\(N^*=K\\), so \\(K\\) is the carrying capacity.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#linear-stability-analysis",
    "href": "discrete_time.html#linear-stability-analysis",
    "title": "2  Discrete-time population models",
    "section": "2.3 Linear stability analysis",
    "text": "2.3 Linear stability analysis\nWe now want to study the stability of the fixed points in discrete-time models. As discussed, fixed points \\(N^*\\) satisfy the equation \\(N^*=f(N^*)\\). We study the stability of the fixed points by looking at the sequence \\(N_t\\) for \\(t\\) close to the fixed point. That means we write \\(N(t)=N^*+n_t\\) for \\(n_t&lt;&lt;1\\). We then have \\[\n\\begin{split}\nN_{t+1} = N^*+n_{t+1}=f(N_t) = f(N^*+n_t) = f(N^*) + f'(N^*)n_t + \\ldots\n\\end{split}\n\\tag{2.7}\\] where we have used the Taylor expansion of \\(f\\) around \\(N^*\\). Because \\(N^*\\) is a fixed point, we have \\(f(N^*)=N^*\\). Thus we find that \\[\nn_{t+1} \\approx f'(N^*)n_t\n\\tag{2.8}\\] where we neglected the higher order terms in the Taylor expansion. This is a linear equation for \\(n_t\\) that we know how to solve: \\[\nn_t = n_0 (f'(N^*))^t.\n\\tag{2.9}\\] So we have found that:\n\nIf \\(|f'(N^*)|&lt;1\\), then \\(n_t\\) will decrease with time and the fixed point is stable.\nIf \\(|f'(N^*)|&gt;1\\), then \\(n_t\\) will increase with time and the fixed point is unstable.\n\nIf \\(|f'(N^*)|=1\\), then we cannot say anything about the stability of the fixed point from this analysis.\n\n\nExercise 2.2 (+ Stability in Verhulst model) Use the stability criterion that we just derived to derive a condition on the parameter \\(R_0\\) of the Verhulst model that makes the non-zero fixed point \\(N^*=K\\) a stable fixed point.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#cobweb-diagrams",
    "href": "discrete_time.html#cobweb-diagrams",
    "title": "2  Discrete-time population models",
    "section": "2.4 Cobweb diagrams",
    "text": "2.4 Cobweb diagrams\nIn the continuous-time case we also had a graphical way to see the stability of fixed points. We will now introduce a graphical method for studying the stability of fixed points in discrete-time models, called the cobweb method.\nWe plot the function \\(f(N_t)\\) and the line \\(N_{t+1}=N_t\\). The fixed points are the intersection points of the function and the line. We then draw the graph of the sequence \\(N_t\\) by starting at the initial population number \\(N_0\\) and iterating the function \\(f(N_t)\\) to find \\(N_1\\), then iterating the function again to find \\(N_2\\), and so on. The graph of the sequence \\(N_t\\) is called the cobweb. The stability of the fixed points can be read off from the cobweb. If the cobweb spirals into the fixed point, as shown in Figure 2.1, then the fixed point is stable. If the cobweb spirals out of the fixed point, as shown in Figure 2.2, then the fixed point is unstable. You have to press the play button below the figures to see the cobweb diagrams in action.\n\n\n\n\n\n\n\n\n\n\n\n  \n  \n    \n    \n      \n          \n      \n        \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n    \n    \n      \n      Once\n      \n      Loop\n      \n      Reflect\n    \n  \n\n\n\n\n\n\nFigure 2.1: Cobweb diagram for a stable fixed point.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n  \n    \n    \n      \n          \n      \n        \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n    \n    \n      \n      Once\n      \n      Loop\n      \n      Reflect\n    \n  \n\n\n\n\n\n\nFigure 2.2: Cobweb diagram for an unstable fixed point.\n\n\n\n\nThe oscillatory nature of the sequence \\(N_t\\), hopping from one side of the fixed point to the other, that creates the cobweb pattern is due to the fact that the slope of \\(f\\) is negative at the fixed point. Ecologically, what is happening as the growth factor increases through \\(R=3\\) is that in a single year the population grows so much that it exceeds its carrying capacity. That then leads to unfavourable conditions in the following year, leading to a decrease below carrying capacity. Such oscillations in population numbers are not possible in a continuous-time model for a single un-structured population.\nIn Figure 2.1 the oscillations get damped over time and the system evolves towards a steady state. In Figure 2.1 the system evolves towards a state where the population number oscillates between two values. This is called a period-two orbit. We will have more to say about this in Section 2.7.\nThe graphical method for visualising the iterations will work also when the slope is positive at the fixed point, but it will not look like a cobweb because the system will not be oscillating around the fixed point but will be evolving towards it. Figure 2.3 shows the cobweb for a stable fixed point with positive slope \\(0&lt;f'(N^*)&lt;1\\) and Figure 2.4 shows the cobweb for an unstable fixed point with positive slope \\(f'(N^*)&gt;1\\).\n\n\n\n\n\n\n\n\n\n\n\n  \n  \n    \n    \n      \n          \n      \n        \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n    \n    \n      \n      Once\n      \n      Loop\n      \n      Reflect\n    \n  \n\n\n\n\n\n\nFigure 2.3: Cobweb diagram for a stable fixed point with positive slope.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n  \n    \n    \n      \n          \n      \n        \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n      \n          \n    \n    \n      \n      Once\n      \n      Loop\n      \n      Reflect\n    \n  \n\n\n\n\n\n\nFigure 2.4: Cobweb diagram for an unstable fixed point with positive slope.\n\n\n\n\n\n\nExercise 2.3 (+ Verhulst model) For some choices of the parameters, the Verhulst model \\[\nN_{t+1}=RN_t\\left(1-\\frac{N_t}{\\tilde{K}}\\right)\n\\tag{2.10}\\] can lead to negative population numbers even when initially starting with a positive population below its carrying capacity. Derive the condition on the parameters for this to happen. One good way to approach this is to think about what the cobweb diagram would have to look like for such a scenario.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#other-models-with-limited-carrying-capacity",
    "href": "discrete_time.html#other-models-with-limited-carrying-capacity",
    "title": "2  Discrete-time population models",
    "section": "2.5 Other models with limited carrying capacity",
    "text": "2.5 Other models with limited carrying capacity\nYou showed in Exercise 2.3 that the Verhulst model has the disadvantage that it can give negative population numbers. There are several other models that are discrete-time versions of the logistic model and do not have this problem. We will now look at the two most important of them.\n\n2.5.1 Ricker model\nMany fish species, like salmon, have distinct breeding seasons and their reproduction shows strong density dependence - when population density is too high, fewer offspring survive due to competition for spawning sites. The Ricker model captures this behavior through the equation:\n\\[\nN_{t+1} = N_t\\, e^{R_0\\left(1 - \\frac{N_t}{K}\\right)}.\n\\tag{2.11}\\]\nBy moving the logistic factor inside the exponential, the Ricker model prevents negative population numbers. The fixed points are still \\(N^*=0\\) and \\(N^*=K\\). Ricker introduced this model to describe salmon populations.\n\n\nExercise 2.4 (* Ricker model) Find the fixed points in the Ricker model \\[\nN_{t+1} = N_t\\, e^{R_0\\left(1 - \\frac{N_t}{K}\\right)}.\n\\tag{2.12}\\] and investigate their stability. Do this both analytically and by drawing cobweb diagrams. Allow also negative values of \\(R_0\\) in your analysis, even though this is not ecologically realistic. Note that you will then need at least three cobweb diagrams because there are then two bifurcations.\n\n\n\n\n2.5.2 Beverton-Holt model\nThe Beverton-Holt model, introduced by Ray Beverton and Sidney Holt in 1957, was developed to understand fish population dynamics. The model arose from their groundbreaking work on sustainable fisheries management while working at the Fisheries Laboratory in Lowestoft, UK. They were particularly interested in how the number of young fish (recruits) entering a population depends on the number of parent fish (spawning stock).\nThey proposed the model\n\\[\nN_{t+1} = \\frac{R N_t}{1 + \\frac{R-1}{K}N_t}.\n\\tag{2.13}\\]\nThis has been a very influential model in fisheries science. On the face of it the model does not look very similar to the logistic model, but we will see the relationship when we solve the model. The trick is to make a change of variables from \\(N_t\\) to \\(u_t = 1/N_t\\). Then we have \\[\nu_{t+1} = \\frac{1}{N_{t+1}} = \\frac{1 + \\frac{R-1}{K}N_t}{R N_t} = \\frac{u_t}{R} + \\frac{R-1}{R K}.\n\\tag{2.14}\\] This is a linear equation for \\(u_t\\), and linear equations are easy to solve. The easiest way to proceed is to look at the first few terms of the sequence \\(u_t\\) and guess the general form of the solution. We find \\[\\begin{split}\nu_1 &= \\frac{u_0}{R} + \\frac{R-1}{R K},\\\\\nu_2 &= \\frac{u_0}{R^2} + \\frac{R-1}{R K}\\left(1 + \\frac{1}{R}\\right),\\\\\nu_3 &= \\frac{u_0}{R^3} + \\frac{R-1}{R K}\\left(1 + \\frac{1}{R} + \\frac{1}{R^2}\\right),\\\\\n&\\vdots\\\\\nu_t &= \\frac{u_0}{R^t} + \\frac{R-1}{R K}\\left(1 + \\frac{1}{R} + \\frac{1}{R^2} + \\ldots + \\frac{1}{R^{t-1}}\\right).\n\\end{split}\n\\tag{2.15}\\] The sum in the second term is a geometric series. We know the general formula for a geometric series: \\[\n1 + x + x^2 + \\ldots + x^{t-1} = \\frac{1 - x^t}{1 - x}.\n\\tag{2.16}\\]\nWe can use this with \\(x=1/R\\) to sum terms in the second term. We find \\[\nu_t = \\frac{u_0}{R^t} + \\frac{R-1}{R K}\\frac{1 - (1/R)^t}{1 - 1/R}.\n\\] We simplify this a bit and bring everything on the same denominator. \\[\nu_t = \\frac{u_0}{R^t} - \\frac{(1/R)^t-1}{K}\n=\\frac{Ku_0-1+R^t}{KR^t}.\n\\tag{2.17}\\]\nWe can now change back to \\(N_t=1/u_t\\) to find the solution to the Beverton-Holt model. We find \\[\n\\begin{split}\nN_t &= \\frac{1}{u_t}=\\frac{K R^t}{Ku_0-1+R^t}\\\\\n&=\\frac{K/u_0}{KR^{-t}-R^{-t}/u_0+1/u_0}\\\\\n&=\\frac{KN_0}{N_0+(K-N_0)R^{-t}}.\n\\end{split}\n\\tag{2.18}\\]\nThis is the solution to the Beverton-Holt model. Comparing this to the solution of the continuous-time logistic model from Eq. 1.5, \\[\nN(t) = \\frac{KN_0}{N_0+(K-N_0)\\exp(-rt)},\n\\tag{2.19}\\] we see that they agree at integer times \\(t\\) if we measure time in years and set \\(R=\\exp(r \\cdot 1\\text{ year}).\\)\n\n\nExercise 2.5 (Beverton-Holt model) Find the fixed points in the Beverton-Holt model \\[\nN_{t+1} = \\frac{R N_t}{1 + \\frac{R-1}{K}N_t}.\n\\tag{2.20}\\] and investigate their stability. Do this both analytically and by drawing cobweb diagrams.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#discrete-time-harvesting-model",
    "href": "discrete_time.html#discrete-time-harvesting-model",
    "title": "2  Discrete-time population models",
    "section": "2.6 Discrete-time harvesting model",
    "text": "2.6 Discrete-time harvesting model\nWe will now look at an example of a discrete-time model with harvesting and apply the techniques we have learned. The model has the standard discrete-time model form \\(N_{t+1}=f(N_t)\\), where \\(f\\) in our example is \\[\nf(N) = \\frac{b N^2}{1+N^2}-EN.\n\\] The constant \\(b&gt;2\\) determines the growth rate of the population and the harvesting rate is determined by the harvesting effort \\(E\\).\nWe start by studying the model without harvesting, so we set \\(E=0\\) for now. As usual, we start by looking at the steady states of the model. The fixed points are the solutions to the equation \\[\nN^* = \\frac{b\\,{N^*}^2}{1+{N^*}^2}.\n\\] There is the obvious solution \\(N^*=0\\). We can then find the non-zero solutions by dividing both sides by \\(N^*\\) and multiply them by \\(1+{N^*}^2\\) to get the equation \\[\n1+{N^*}^2 = bN^*.\n\\] This is a quadratic equation for \\(N^*\\), which we could rewrite in the more conventional form \\[\n{N^*}^2 - bN^* + 1 = 0.\n\\] The solutions to this equation are \\[\nN^*_\\pm = \\frac{b\\pm\\sqrt{b^2-4}}{2}.\n\\] The solutions are real if \\(b^2-4\\geq 0\\), i.e. if \\(b\\geq 2\\), which we have stipulated earlier. Both solutions are positive.\nWe now have enough information to draw a good sketch to understand the dynamics of the model. We can draw the function \\(f(N)\\) and the line \\(N_{t+1}=N_t\\). It may not be immediately obvious what the sketch of \\(f(N)=bN^2/(1+N^2)\\) looks like. We’ll reason ourselves through this in steps:\n\nFirst let us consider what happens near \\(N=0\\). There the function is approximately \\(f(N)\\approx bN^2\\). This is a parabola that opens upwards. The function is zero at \\(N=0\\) and increases quadratically with \\(N\\).\nNext we consider what happens as \\(N\\) becomes large. There the function is approximately \\(f(N)\\approx b\\). So the graph has a horizontal asymptote at \\(y=b\\).\nWe know that in between there are two fixed points. That means the graph needs to cross the diagonal line \\(y=N\\) twice.\nFinally we observe that the function is monotonically increasing.\n\nIf we now draw something that has all these features, we will have a sufficiently good sketch of the function for our purpose of understanding the dynamics of the model. We will necessarily end up with something that qualitatively looks like the graph in Figure 2.5.\n\n\n\n\n\n\n\n\nFigure 2.5: Graph of the function \\(f(N)=\\frac{bN^2}{1+N^2}\\).\n\n\n\n\n\nUsing our cobweb technique, or simply looking at the slope of \\(f\\) at the fixed points, we can easily convince ourselves that the extinction fixed point is stable, the smaller non-zero fixed point \\(N^*_-\\) is unstable and the larger fixed point \\(N^*_+\\) is stable. in Figure 2.5 we have indicated the stable fixed points by solid circles and the unstable fixed points by open circles. So when the population number is larger than \\(N^*_-\\) it will grow towards \\(N^*_+\\), and when it is smaller than \\(N^*_-\\) it will go extinct. So this model exhibits a strong Allee effect with critical depensation. \\(N^*_-\\) is the smallest viable population size.\nWe can now add harvesting to the model. The extra term in the function \\(f(N)\\) is \\(-EN\\). This lowers the graph of \\(f(N)\\) by an amount that grows linearly with \\(N\\). This is illustrated in Figure 2.6.\n\n\n\n\n\n\n\n\nFigure 2.6: Graph of the function \\(f(N)=\\frac{bN^2}{1+N^2}-EN\\).\n\n\n\n\n\nWe see that as the harvesting effort \\(E\\) increases, the two fixed points move closer together. At a critical value \\(E_c\\) the two fixed points merge and disappear. The population number will then go extinct for all initial population numbers.\nLet us find the critical value \\(E_c\\). For that we first determine the location of the fixed points in the presence of harvesting. So we solve the equation \\[\nN^* = \\frac{b\\,{N^*}^2}{1+{N^*}^2}-EN^*.\n\\] Again this has a solution \\(N^*=0\\). We can then find the non-zero solutions by dividing both sides by \\(N^*\\) and multiply them by \\(1+{N^*}^2\\) to get the equation \\[\n(1+E){N^*}^2-bN^*+1+E = 0.\n\\] This is solved by \\[\nN^*_\\pm = \\frac{\\frac{b}{1+E}\\pm\\sqrt{\\left(\\frac{b}{1+E}\\right)^2-4}}{2}.\n\\]\nWe see that these solutions are real only if \\(\\left(\\frac{b}{1+E}\\right)^2-4\\geq 0\\), i.e., if \\(E&lt; \\frac{b-2}{2}\\). Thus the critical effort is \\(E_c=\\frac{b-2}{2}\\). Fishing above this level will lead to extinction of the population. But even fishing just near this level is risky because the population number will be very close to the minimum viable population and a small disturbance could lead to extinction.\n\n\n\n\n\n\n\n\nFigure 2.7: Bifurcation diagram for the discrete-time harvesting model.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#sec-period-doubling",
    "href": "discrete_time.html#sec-period-doubling",
    "title": "2  Discrete-time population models",
    "section": "2.7 Period-doubling route to chaos",
    "text": "2.7 Period-doubling route to chaos\nTake another look at Figure 2.1 and Figure 2.2. Just a little change in the function \\(f(N)\\) changed the nature of the fixed point. Such a change can be the consequence of a small change in a model parameter, for example the intrinsic growth rate.\nWe will use the logistic map to illustrate the period-doubling route to chaos, although the phenomenon is more general. The logistic map is a simple discrete-time model for population growth that exhibits a period-doubling route to chaos. It is defined as \\[\nX_{t+1} = R\\,X_t\\,(1-X_t) =: f(X_t).\n\\] It is the same as the Verhulst model Eq. 2.6, just written in terms of \\(X_t = N_t/\\tilde{K}\\). Figure 2.8 shows the graph of \\(f(X)\\) of the Verhulst model at three different values of the intrinsic growth factor \\(R\\). For \\(R=2.8\\) the slope of \\(f\\) at the fixed point is less steep than \\(-1\\) and thus the fixed point is stable, as in Figure 2.1. For \\(R=3.2\\) the slope of \\(f\\) at the fixed point is steeper than \\(-1\\) and thus the fixed point is unstable and the population number starts to oscillate, as in Figure 2.2. At \\(R=3\\) the system switches from one behaviour to the other. That is the bifurcation point.\n\n\n\n\n\n\n\n\nFigure 2.8: Plot showing a period-doubling bifurcation in the Verhulst model.\n\n\n\n\n\nFigure 2.9 shows a simplified bifurcation diagram for the Verhulst model. A bifurcation diagram shows the location of fixed points or periodic orbits, with stable fixed points or stable periodic orbits represented by solid lines and unstable fixed points or unstable periodic orbits represented by dashed lines. Reading the diagram from left to right, which corresponds to increasing growth factor \\(R\\) in the Verhulst model, we see how at first the stable fixed point (which is located at the carrying capacity \\(K\\)) moves towards larger population sizes. At \\(R=3\\) it becomes unstable and spawns a stable periodic orbit whose amplitude grows until that periodic orbit itself becomes unstable, in another period-doubling bifurcation.\n\n\n\n\n\n\n\n\nFigure 2.9: Bifurcation diagram for the period-doubling bifurcation.\n\n\n\n\n\nFigure 2.9 does not show the period 4 orbit that emerges when the period 2 orbit becomes unstable. The full diagram quickly becomes very messy as \\(R\\) increases, as shown in Figure 2.10. Period-doubling cascades continue until the system enters a chaotic regime for \\(R&gt;3.56995\\).\n\n\n\n\n\n\n\n\nFigure 2.10: Bifurcation diagram for the period-doubling bifurcation.\n\n\n\n\n\nIn the chaotic regime the system displays highly sensitive dependence on initial conditions, where small differences in the starting population can result in vastly different outcomes over time. The period-doubling route to chaos, as seen in the logistic map, is a classic example of how simple nonlinear equations can produce complex and unpredictable behavior. How important chaos is for ecological systems is a subject of ongoing debate.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#transcritical-and-pitchfork-bifurcations",
    "href": "discrete_time.html#transcritical-and-pitchfork-bifurcations",
    "title": "2  Discrete-time population models",
    "section": "2.8 Transcritical and pitchfork bifurcations",
    "text": "2.8 Transcritical and pitchfork bifurcations\nAs mentioned before, a bifurcation is a change in the existence and stability of fixed points or periodic orbits as the parameters of the model are varied. You have met bifurcations in continuous-time models already in your Classical Dynamics module. You have seen there that in one-dimensional systems described by a single ODE there are three different types of bifurcation: saddle-node, pitchfork, transcritical. The same types of bifurcations can occur in discrete-time models and we will discuss and visualise each of these bifurcation types below. These bifurcations happen if there is a fixed point with \\(f'(N^*)=1\\). Then there is also one more type: the period-doubling bifurcation, which happens when \\(f'(N^*)=-1\\), and which we have met in Section 2.7.\n\n2.8.1 Saddle-node bifurcation\nWe have already seen a saddle-node bifurcation in the discrete-time harvesting mode, where two fixed points merge and disappear as the parameter is varied. This is also sometimes referred to as a tangent bifurcation. Figure 2.11 shows an example of a function \\(f(N)\\) that depends on a parameter \\(r\\) in such a way that for \\(r&gt;0\\) the graph of \\(f(N)\\) crosses the diagonal twice, which means that there are two fixed points. Then at exactly \\(r=0\\) the function is tangent to the diagonal, i.e, there is only a single fixed point. Then for \\(r&lt;0\\) the function does not touch the diagonal so that there are no fixed points left.\n\n\n\n\n\n\n\n&lt;Figure size 768x576 with 0 Axes&gt;\n\n\n(a) Plot showing a saddle-node bifurcation.\n\n\n\n\n\n\n\n\n\n\n(b)\n\n\n\n\n\n\nFigure 2.11\n\n\n\n\nFigure 2.12 shows the corresponding bifurcation diagram.\n\n\n\n\n\n\n\n\nFigure 2.12: Bifurcation diagram for a saddle-node bifurcation.\n\n\n\n\n\n\n\n2.8.2 Transcritical bifurcation\n\n\n\n\n\n\n\n\nFigure 2.13: Plot showing a transcritical bifurcation.\n\n\n\n\n\n\n\n\n\n\nBifurcation diagram for a transcritical bifurcation.\n\n\n\n\n\n\n2.8.3 Pitchfork bifurcation\n\n\n\n\n\n\n\n\nFigure 2.14: Plot showing a pitchfork bifurcation.\n\n\n\n\n\n\n\n\n\n\nBifurcation diagram for a pitchfork bifurcation.\n\n\n\n\n\n\nExercise 2.6 (o House finches) [Note: in this problem we combine a continuous time model for the dynamics within a single year with a discrete model for the dynamics from one year to the next. The subscript \\(t \\in \\mathbb{Z}\\) refers to the discrete year whereas \\(\\tau\\in\\mathbb{R}\\) will indicate the continuous time within a single year.]\nA population of house finches resides in an isolated region in North America. In this problem you want to find out about the long-term prospects for the population.\nEach year the males and females begin their search for mates at the beginning of winter with a combined population number \\(N_t\\) in year \\(t\\), and form \\(P_t\\) breeding pairs by the end of this search period, the start of the breeding season.\nThe mate search period lasts from within-year time \\(\\tau = 0\\) to the end of the search period at within-year time \\(\\tau = T\\). Assume that there is a 1:1 sex ratio and that males \\(M(\\tau)\\) and females \\(F(\\tau)\\) locate one another randomly to make a pair at rate \\(\\sigma\\), such that the number \\(M(\\tau)\\) of males that are not in a pair at time \\(\\tau\\) satisfies \\[\\frac{dM}{d\\tau}=-\\sigma \\,M\\,F \\] and similarly the number \\(F\\) of females that are not in a pair at time \\(\\tau\\) satisfies \\[\\frac{dF}{d\\tau}=-\\sigma \\,M\\,F. \\]\nYou are given that the number of breeding pairs that establish a nest and breed successfully is \\(G(P_t)P_t\\), where the fraction \\(G(P_t)\\) takes the particular form \\[G(P_t) = \\frac{1}{1+P_t/\\delta},\\] where \\(\\delta\\) represents the density of available nesting sites. Each pair that reproduces successfully has a mean number \\(c\\) of offspring.\nThe probability that a bird will survive from one year to the next is \\(s\\).\n\nShow that the number \\(n(\\tau)=M(\\tau)+F(\\tau)\\) of birds not in a pair is governed by \\[\\frac{dn}{d\\tau}=-\\frac{\\sigma}{2}n^2, ~~~n(0)=N_t.\\]\nUsing the above, show that the number \\(n(T)\\) of birds that have not found a mate at the start of the breeding season in year \\(t\\) is \\[n(T)=\\frac{r\\,N_t}{r+2N_t}\\] where \\(N_t\\) is the number of birds at the start of the season in that particular year and where \\(r=4/(\\sigma T)\\).\nExplain why the number of pairs \\(P(\\tau)\\) is governed by \\[\\frac{dP}{d\\tau}=-\\frac12\\frac{dn}{d\\tau},~~~P(0)=0.\\]\nUse the above to show that the number of breeding pairs at the start of the breeding season in year \\(t\\) is \\[P_t:=P(T)=\\frac{N_t^2}{r+2N_t}.\\]\nShow that the population \\(N_{t+1}\\) at the beginning of winter in year \\(t+1\\) is given by \\[\nN_{t+1}=s\\,N_t+\\frac{c\\,N_t^2}{r+2N_t+N_t^2/\\delta}.\n\\tag{2.21}\\]\nFind the realistic steady states of the model in Eq. 2.21 for the case that \\[\\frac{c}{1-s}-2\\geq \\sqrt{\\frac{4r}{\\delta}}.\\]\nDraw a cobweb diagram to illustrate the stability of the steady states in the case that there are two positive steady states. Label key features of the curves.\nWhat type of bifurcation occurs when there is equality in the condition in part f)?\n\n\n\n\nExercise 2.7 (Period-doubling and tangent bifurcations) Consider the discrete time model \\[\nN_{t+1}=\\frac{rN_t}{1+(N_t/K)^b}\n\\tag{2.22}\\] where \\(r\\), \\(b\\) and \\(K\\) are positive parameters with \\(b&gt;1\\). Show that the model has two steady states. Investigate the stability of the extinction steady state. Show that the non-trivial (non-zero) steady state can lose stability through a period doubling bifurcation at \\(b=2r/(r-1)\\), or a tangent bifurcation at \\(r=1\\).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "discrete_time.html#summary",
    "href": "discrete_time.html#summary",
    "title": "2  Discrete-time population models",
    "section": "Summary",
    "text": "Summary\nThis chapter introduced several key concepts in discrete-time population dynamics:\n\nDiscrete vs Continuous Time\n\nDiscrete models track populations at fixed time intervals\nUseful for populations with seasonal reproduction\nCan exhibit more complex dynamics than continuous models\n\nKey Models\n\nDiscrete exponential: \\(N_{t+1} = RN_t\\)\nVerhulst model: Shows logistic-type growth but can give negative populations\nRicker model: Prevents negative populations, used for salmon populations\nBeverton-Holt model: Important in fisheries science\n\nAnalysis Tools\n\nFixed points found by solving \\(N^* = f(N^*)\\)\nLinear analysis near fixed points: Stability when \\(|f'(N^*)|&lt;1\\)\nCobweb diagrams visualize iteration dynamics\n\nBifurcations\n\nFour types possible in discrete-time models:\n\nSaddle-node (tangent)\nTranscritical\nPitchfork\nPeriod-doubling (unique to discrete-time models)\n\nPeriod-doubling leads to oscillatory behavior\n\nHarvesting\n\nCan introduce critical depensation\nCritical harvesting thresholds exist\nRisk of population collapse near thresholds\n\n\nKey differences from continuous models:\n\nCan exhibit more complex dynamics\nPeriod-doubling bifurcations possible\nCobweb diagrams replace phase lines\nSolutions can oscillate or become chaotic",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Discrete-time population models</span>"
    ]
  },
  {
    "objectID": "interacting.html",
    "href": "interacting.html",
    "title": "3  Interacting populations",
    "section": "",
    "text": "3.1 Lotka-Volterra Model\nEcological systems are complex networks of interactions involving multiple species, which can be categorized into different trophic levels based on their roles in the ecosystem. Understanding these interactions is crucial for studying ecosystem dynamics, population control, and biodiversity. While the study of multiple interacting species can become quite intricate, analysing the interactions between two species offers a more manageable framework while still providing significant insights into the dynamics of ecological relationships. This chapter focuses on two-species interactions, offering a foundational understanding that can be applied or extended to more complex scenarios.\nMathematical Framework for Two-Species Interactions\nTo model the interactions between two species, we employ a system of two autonomous coupled ordinary differential equations (ODEs). These equations describe the rate of change of the population sizes over time, capturing the essence of their interaction. The general form of these equations is given by: \\[\n\\frac{dX}{dt} = f(X,Y), ~~~~~ \\frac{dY}{dt} = g(X,Y).\n\\tag{3.1}\\] where \\(X\\) and \\(Y\\) represent the population sizes of the two species, and \\(f(X,Y)\\) and \\(g(X,Y)\\) are functions that describe how the populations influence each other. These functions are crafted based on the nature of the interaction between the species, reflecting the underlying biological processes.\nTypes of Two-Species Interactions\nThe dynamics of two interacting species are generally categorized into three primary types, each with its unique characteristics and implications for the populations involved:\nWhile this chapter focuses on these primary interaction types, it’s important to recognize the spectrum of interactions in nature, including parasitism, amensalism, and others. Moreover, the real-world ecological systems often exhibit a mix of these interactions, adding layers of complexity. By starting with the analysis of two-species systems, we lay the groundwork for understanding more intricate interactions and the overall dynamics of ecosystems.\nThe Lotka-Volterra model, developed independently by Alfred Lotka in 1925 and Vito Volterra in 1926, serves as a foundational mathematical model for understanding the dynamic interplay between a prey population (denoted by \\(N\\)) and a predator population (denoted by \\(P\\)).\nModel Formulation\nThe model assumes that the prey population, in the absence of predators, grows exponentially with a per capita growth rate \\(a &gt; 0\\). However, the prey die due to being eaten by predators, and we assume that the per-capita mortality rate grows in proportion to the abundance of predators, with some proportionality constant \\(b \\geq 0\\). This leads to the equation \\[\n\\frac{dN}{dt} = N(a - bP).\n\\tag{3.2}\\]\nConversely, the predators benefit from the abundance of prey and we encode that by giving them a per-capita growth \\(cN\\), where \\(c \\geq 0\\). We assume that the per capita mortality rate is a constant \\(d\\). This yields the following equation for the predator dynamics: \\[\n\\frac{dP}{dt} = P(cN - d).\n\\tag{3.3}\\]\nThe two plots in Figure 3.1 generated from the Lotka-Volterra model provide a visual representation of the dynamics between a predator and prey population over time. The phase plane plot illustrates the cyclic nature of the interaction between the prey (N) and predator (P) populations, depicting a closed trajectory that indicates the continuous oscillation of both populations in relation to each other: as the prey population increases, it provides more food for the predators, which then also increase in number. However, as the predator population grows, it puts more pressure on the prey, leading to a decline in the prey population, which eventually causes the predator population to decrease due to lack of food.\nThe plot at the bottom shows the prey and predator populations over time. It highlights the periodic rises and falls of each population, showing how the increase in the prey population precedes the increase in the predator population, followed by a subsequent decline in the prey and then the predator population. The time series plot complements the phase plane by showing how the dynamics unfold over time.\nFigure 3.1: Solutions to the Lotka-Volterra model with parameters \\(a = 1.0\\), \\(b = 0.1\\), \\(c = 0.1\\), and \\(d = 1.0\\) and initial conditions \\(N_0 = 10\\) and \\(P_0 = 5\\).\nNon-dimensionalization of the Model\nNon-dimensionalization is a crucial step to reduce the complexity of the model by decreasing the number of parameters, thereby simplifying the analysis. By introducing the non-dimensional variables \\(u = \\frac{cN}{d}\\), \\(v = \\frac{bP}{a}\\), and the non-dimensional time \\(\\tau = at\\), along with the parameter \\(\\alpha = \\frac{d}{a}\\), we can transform the Lotka-Volterra equations into a more tractable form:\n\\[\n\\frac{du}{d\\tau} = u(1 - v), \\quad \\frac{dv}{d\\tau} = \\alpha v(u - 1).\n\\tag{3.4}\\]\nPhase plane paths\nTo determine the phase plane paths we consider \\(v\\) as a function of \\(u\\) which satisfies the equation \\[\n\\frac{dv}{du} = \\frac{\\frac{dv}{d\\tau}}{\\frac{du}{d\\tau}} = \\frac{\\alpha v(u - 1)}{u(1 - v)}.\n\\tag{3.5}\\] We rewrite this by separating the variable and integrate: \\[\n\\int\\frac{1-v}{v}dv = \\alpha \\int\\frac{u-1}{u}du.\n\\tag{3.6}\\] This gives \\[\n\\log v - v - \\alpha (u - \\log u) = \\text{constant}.\n\\tag{3.7}\\] So even though \\(u\\) and \\(v\\) are changing with time, this particular combination stays constant. This is a conserved quantity. Let us suggestively call the constant of the motion \\(H\\) for Hamiltonian and write it in terms of new variables \\(p = \\log u\\) and \\(q = \\log v\\): \\[\nH(q,p)= v- \\log v + \\alpha (u - \\log u) = e^q - q + \\alpha(e^p - p).\n\\tag{3.8}\\] Hamilton’s equations \\[\\dot{q} = \\frac{dH}{dp},~~~~\\dot{p} = -\\frac{dH}{dq} \\tag{3.9}\\] then reproduce our equations of motion.\nThis formulation underscores the conservative nature of the model, where the energy-like quantity \\(H\\) is conserved, leading to neutrally stable periodic orbits. This Hamiltonian nature is a rather special feature of the Lotka-Volterra model. Any slight modification of the model will destroy the conserved quantity and the periodic orbits. Thus we should not expect to see such perfect periodic predator-prey cycles in nature. We will discuss more realistic predator-prey models later.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Interacting populations</span>"
    ]
  },
  {
    "objectID": "interacting.html#linear-stability-analysis",
    "href": "interacting.html#linear-stability-analysis",
    "title": "3  Interacting populations",
    "section": "3.2 Linear Stability Analysis",
    "text": "3.2 Linear Stability Analysis\nBefore we study more realistic models, we revisit the concept of linear stability analysis, an essential tool in understanding the dynamics near the fixed points of systems described by autonomous coupled ordinary differential equations (ODEs) of the form\n\\[\n\\frac{dX}{dt} = f(X,Y), \\quad \\frac{dY}{dt} = g(X,Y).\n\\tag{3.10}\\]\nLet us denote the fixed points (stable states) of the system as \\((x^*, y^*)\\). They satisfy \\(f(x^*, y^*) = 0\\) and \\(g(x^*, y^*) = 0\\).\nLinearisation around the Fixed Points\nTo analyse the stability of these fixed points, we introduce small perturbations \\(x\\) and \\(y\\) around them, setting \\(X = x^* + x\\) and \\(Y = y^* + y\\). By applying a Taylor expansion and retaining only the linear terms, we obtain a linearised system:\n\\[\n\\frac{d}{dt}\\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\mathbf{A}(x^*, y^*) \\begin{pmatrix} x \\\\ y \\end{pmatrix},\n\\tag{3.11}\\] where the Jacobian matrix \\(\\mathbf{A}\\) is defined as: \\[\n\\mathbf{A} = \\begin{pmatrix} f_X & f_Y \\\\ g_X & g_Y \\end{pmatrix}_{(x^*, y^*)}.\n\\tag{3.12}\\]\nEigenvalue Analysis for Stability\nThe solution to the linearised system takes the form \\((x, y) = \\mathbf{v} e^{\\lambda t}\\), where \\(\\mathbf{v}\\) is an eigenvector of \\(\\mathbf{A}\\), and \\(\\lambda\\) is the corresponding eigenvalue. By setting the determinant of \\(\\mathbf{A} - \\lambda \\mathbf{I}\\) to zero, we obtain the characteristic equation:\n\\[\n\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = \\begin{vmatrix} f_X - \\lambda & f_Y \\\\ g_X & g_Y - \\lambda \\end{vmatrix}_{(x^*, y^*)} = 0,\n\\tag{3.13}\\] which leads to the eigenvalues: \\[\n\\lambda = \\frac{\\text{Tr} \\mathbf{A} \\pm \\sqrt{(\\text{Tr} \\mathbf{A})^2 - 4\\det \\mathbf{A}}}{2}.\n\\tag{3.14}\\]\nThe stability of the fixed point is determined by the sign of the real parts of the eigenvalues:\n\nIf both eigenvalues have negative real parts, the fixed point is stable (attracting).\nIf both eigenvalues have positive real parts, the fixed point is unstable (repelling).\nIf the eigenvalues have real parts of opposite signs, the fixed point is a saddle point, which is unstable.\nFor a complex conjugate pair of eigenvalues, if the real part is positive, the system exhibits an unstable spiral; if the real part is negative, the system exhibits a stable spiral.\n\nThis analysis is pivotal for understanding how small deviations from equilibrium evolve over time, providing insights into the system’s long-term behaviour near the fixed points. For instance, in the context of the predator-prey dynamics, such analysis helps elucidate under what conditions the populations will return to equilibrium after a disturbance or potentially diverge away from it.\nWe can reformulate the stability conditions of a fixed point in terms of the determinant and trace of the Jacobian matrix. We need to recall how these two characteristics of the Jacobian relate to the eigenvalues. For a 2x2 matrix \\(A\\) with eigenvalues \\(\\lambda_1\\) and \\(\\lambda_2\\), the trace \\(\\text{Tr}(A)\\) is the sum of the eigenvalues, and the determinant \\(\\text{Det}(A)\\) is the product of the eigenvalues:\n\n\\(\\text{Tr}(A) = \\lambda_1 + \\lambda_2\\)\n\\(\\text{Det}(A) = \\lambda_1 \\lambda_2\\)\n\nUsing these relationships, we can express the conditions for the stability of fixed points as follows:\n\nStable (Attracting) Fixed Point: If both eigenvalues have negative real parts, their sum (the trace) is negative, and their product (the determinant) is positive because the product of two negative numbers is positive. Therefore, for stability, \\(\\text{Tr}(A) &lt; 0\\) and \\(\\text{Det}(A) &gt; 0\\). Additionally, to ensure that both eigenvalues are real and negative, we require that \\(\\text{Tr}(A)^2 - 4\\text{Det}(A) \\geq 0\\) to avoid complex eigenvalues.\nUnstable (Repelling) Fixed Point: If both eigenvalues have positive real parts, the trace is positive, and the determinant is positive (the product of two positive numbers is positive). Thus, for instability, \\(\\text{Tr}(A) &gt; 0\\) and \\(\\text{Det}(A) &gt; 0\\).\nSaddle Point (Unstable): If the eigenvalues have real parts of opposite signs, the determinant (the product of the eigenvalues) is negative. So, for a saddle point, \\(\\text{Det}(A) &lt; 0\\), regardless of the trace.\nSpiral Points: For a complex conjugate pair of eigenvalues, the determinant will be positive (since the product of complex conjugates is positive), but the stability depends on the sign of the real part of the eigenvalues, which is represented by the trace. Here, we also need to ensure that \\(\\text{Tr}(A)^2 - 4\\text{Det}(A) &lt; 0\\) to confirm that the eigenvalues are complex.\n\nUnstable Spiral: If the real part is positive, \\(\\text{Tr}(A) &gt; 0\\) and \\(\\text{Det}(A) &gt; 0\\).\nStable Spiral: If the real part is negative, \\(\\text{Tr}(A) &lt; 0\\) and \\(\\text{Det}(A) &gt; 0\\).\n\n\nThese conditions provide a concise way to determine the stability of fixed points using only the determinant and trace of the Jacobian matrix, without explicitly computing the eigenvalues.\n\nExample 3.1 (Linear Stability Analysis of the Lotka-Volterra Model) To explore the stability of steady states in the Lotka-Volterra model, we analyse the system near its fixed points using the Jacobian matrix \\(\\mathbf{A}\\). For the non-dimensionalized Lotka-Volterra system, the Jacobian matrix is given by \\[\n\\mathbf{A} =\n\\begin{pmatrix}\n1 - v & -u \\\\\n\\alpha v & \\alpha (u - 1)\n\\end{pmatrix}.\n\\tag{3.15}\\]\nSteady State at \\((u, v) = (0, 0)\\)\nFor the fixed point \\((u, v) = (0, 0)\\), we substitute these values into the Jacobian matrix and find the eigenvalues:\n\\[\n\\mathbf{A} =\n\\begin{pmatrix}\n1 & 0 \\\\\n0 & -\\alpha\n\\end{pmatrix}.\n\\tag{3.16}\\]\nThe eigenvalues are \\(\\lambda_1 = 1\\) and \\(\\lambda_2 = -\\alpha\\), indicating that this fixed point is a saddle point due to the eigenvalues having opposite signs. This configuration is inherently unstable as trajectories near the point will diverge away along the direction associated with the positive eigenvalue.\nSteady State at \\((u, v) = (1, 1)\\)\nAt the fixed point \\((u, v) = (1, 1)\\), the Jacobian matrix becomes:\n\\[\n\\mathbf{A} =\n\\begin{pmatrix}\n0 & -1 \\\\\n\\alpha & 0\n\\end{pmatrix}.\n\\tag{3.17}\\]\nThe characteristic equation for the eigenvalues \\(\\lambda\\) is \\(\\lambda^2 + \\alpha = 0\\), leading to complex eigenvalues \\(\\lambda = \\pm i\\sqrt{\\alpha}\\). The real part of these eigenvalues is zero, indicating that this fixed point is a centre. Trajectories around this point are closed loops, implying that the system exhibits neutrally stable periodic behaviour around the \\((1, 1)\\) steady state.\nThe period \\(T\\) of the oscillations can be determined from the imaginary part of the eigenvalues, which is \\(\\sqrt{\\alpha}\\), so the period \\(T = \\frac{2\\pi}{\\sqrt{\\alpha}}\\).",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Interacting populations</span>"
    ]
  },
  {
    "objectID": "interacting.html#more-realistic-predator-prey-models",
    "href": "interacting.html#more-realistic-predator-prey-models",
    "title": "3  Interacting populations",
    "section": "3.3 More Realistic Predator-Prey Models",
    "text": "3.3 More Realistic Predator-Prey Models\nWhile the basic Lotka-Volterra model provides a fundamental understanding of predator-prey interactions, more nuanced models incorporate additional biological realism. These models may account for factors like limited resources, satiation, prey switching, predator avoidance, and many others.\n\n3.3.1 Generalized Predator-Prey Model\nThe generalized model introduces a function \\(F(N, P)\\) representing the prey population’s per-capita growth and a function \\(G(N, P)\\) for the predator’s per-capita growth rate, so that the dynamics are:\n\\[\n\\frac{dN}{dt} = NF(N, P), \\quad \\frac{dP}{dt} = PG(N, P).\n\\tag{3.18}\\]\nThe prey might exhibit logistic growth in the absence of predators. To model this we could choose \\[\nF(N, P) = r\\left(1 - \\frac{N}{K}\\right) - R(N)P,\n\\tag{3.19}\\]\nwhere \\(r\\) is the intrinsic growth rate, \\(K\\) is the carrying capacity, and \\(R(N)\\) models how the predation rate of a predator changes with the prey population size. \\(NR(N)\\) is the rate at which each individual predator consumes prey. The dependence of this rate on the prey population size \\(N\\) is often referred to as “functional response” in the ecological literature. Holling introduced three types of functional responses, which are widely used in predator-prey models:\n\nHolling Type functional responses\n\nType I \\(NR(N) = bN\\), which corresponds to the standard Lotka-Volterra model. This simplification lacks realism as it assumes an unlimited predator appetite regardless of prey population size.\nType II \\(NR(N) = \\frac{AN}{N + B}\\), with \\(A\\) and \\(B\\) being positive constants. In this model, the rate approaches a saturation level \\(A\\) for large \\(N\\), reflecting a limit to the predator’s consumption rate. This model is more realistic as it accounts for the predator’s limited appetite, which might be because there is a minimum handling time, the time the predator needs to consume a prey item.\nType III \\(NR(N) = \\frac{AN^2}{N^2 + B^2}\\). This response includes a saturation effect like the previous example but also models that if the prey is rare the predator may not be able to find it. This model is more complex and captures the idea that predators may switch to alternative prey when the primary prey is scarce. It may also encode a learning effect, where the predator’s efficiency in capturing prey increases with experience so that initially the predator’s consumption rate increases with prey density.\n\n\n\n\n3.3.2 Example\nConsider a model where the prey growth rate follows logistic dynamics in the absence of prey and predation mortality is described by a Holling type II function encoding satiation effects. The predator’s growth rate goes down as the prey population decreases. The model equations are: \\[\n\\frac{dN}{dt} = N\\left[r\\left(1 - \\frac{N}{K}\\right) - \\frac{A}{N + B}P\\right], \\quad \\frac{dP}{dt} = Ps\\left(1 - \\frac{hP}{N}\\right),\n\\tag{3.20}\\] where \\(r\\), \\(K\\), \\(A\\), \\(B\\), \\(s\\), and \\(h\\) are positive constants.\nNondimensionalization\nTo reduce the complexity, we nondimensionalize the system with \\(\\tau = tr\\), \\(u = \\frac{N}{K}\\), \\(v = \\frac{hP}{K}\\), \\(a = \\frac{A}{hr}\\), \\(b = \\frac{B}{K}\\), and \\(c = \\frac{s}{r}\\), leading to:\n\\[\n\\frac{du}{d\\tau} = u(1 - u) - a\\frac{uv}{u + b}, \\quad \\frac{dv}{d\\tau} = cv\\left(1 - \\frac{v}{u}\\right).\n\\tag{3.21}\\]\nStability Analysis of Steady States\nThe steady states \\((u^*, v^*)\\) include \\((1, 0)\\) and a coexistence steady state \\((u^*_+, u^*_+)\\), where \\[\nu^*_+ = \\frac{1-a-b+\\sqrt{(1-a-b)^2+4b}}{2}.\n\\tag{3.22}\\] The community matrix \\(\\mathbf{A}(u, v)\\) at these points helps determine their stability. For the fixed point \\((1, 0)\\), where the prey population is at carrying capacity and there are no predators, we have find \\[\n\\mathbf{A}(1, 0) = \\begin{pmatrix} -1 & -\\frac{a}{1 + b} \\\\ 0 & c \\end{pmatrix}.\n\\tag{3.23}\\] The eigenvalues \\(-1\\) and \\(c\\) have opposite sign, indicating that the fixed point is a saddle point.\nAt the coexistence fixed point \\((u^*_+, u^*_+)\\) the Jacobian is more complex and we will skip the analysis here.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Interacting populations</span>"
    ]
  },
  {
    "objectID": "interacting.html#competition-models",
    "href": "interacting.html#competition-models",
    "title": "3  Interacting populations",
    "section": "3.4 Competition Models",
    "text": "3.4 Competition Models\nIn ecological systems, species often compete for limited resources, such as food or territory. This competition influences their growth rates and can determine their survival and dominance within an ecosystem. The Lotka-Volterra competition model provides a framework to study these dynamics, extending the principles of logistic growth to account for interspecies interactions.\n\n3.4.1 Lotka-Volterra Competition Dynamics\nThe model is formulated as follows for two competing species \\(N_1\\) and \\(N_2\\):\n\\[\n\\begin{split}\n\\frac{dN_1}{dt} &= r_1N_1 \\left(1 - \\frac{N_1 + b_{12}N_2}{K_1}\\right),\\\\\n\\frac{dN_2}{dt} &= r_2N_2 \\left(1 - \\frac{N_2 + b_{21}N_1}{K_2}\\right),\n\\end{split}\n\\tag{3.24}\\]\nwhere \\(r_i\\) is the intrinsic growth rate and \\(K_i\\) is the carrying capacity of species \\(i\\). The coefficients \\(b_{ij}\\) represent the competitive effect of species \\(j\\) on species \\(i\\), effectively reducing the carrying capacity for species \\(i\\) due to the presence of species \\(j\\).\n\n\n3.4.2 Nondimensionalization of the Model\nTo simplify the analysis, we nondimensionalize the system using:\n\\[\nu_i = \\frac{N_i}{K_i}, \\quad a_{ij} = \\frac{b_{ij}K_j}{K_i}, \\quad \\tau = r_1 t, \\quad \\rho = \\frac{r_2}{r_1},\n\\tag{3.25}\\] leading to: \\[\n\\frac{du_1}{d\\tau} = u_1(1 - u_1 - a_{12}u_2), ~~~~~ \\frac{du_2}{d\\tau} = \\rho u_2(1 - u_2 - a_{21}u_1).\n\\tag{3.26}\\]\n\n\n3.4.3 Analysis of Steady States\nThe system has four potential steady states: \\((0, 0)\\), \\((0, 1)\\), \\((1, 0)\\), and a coexistence steady state \\(\\left(\\frac{1-a_{12}}{1-a_{12}a_{21}}, \\frac{1-a_{21}}{1-a_{12}a_{21}}\\right)\\).\nTo determine the stability of these points, we evaluate the Jacobian matrix \\(\\mathbf{A}(u_1, u_2)\\) at each steady state and analyse its eigenvalues:\n\nAt \\((0, 0)\\): The eigenvalues are \\(1\\) and \\(\\rho\\), indicating an unstable node as both are positive.\nAt \\((1, 0)\\): The eigenvalues are \\(-1\\) and \\(\\rho(1 - a_{21})\\). This point is a saddle if \\(a_{21} &lt; 1\\) and a stable node if \\(a_{21} &gt; 1\\).\nAt \\((0, 1)\\): By symmetry, this point behaves like \\((1, 0)\\) with roles reversed between species.\nCoexistence point \\(\\left(\\frac{1-a_{12}}{1-a_{12}a_{21}}, \\frac{1-a_{21}}{1-a_{12}a_{21}}\\right)\\): The stability is determined by the sign of the trace and the determinant of \\(\\mathbf{A}\\). The system’s behaviour at this point depends on the specific values of \\(a_{12}\\) and \\(a_{21}\\), indicating potential scenarios where both species can coexist or one outcompetes the other.\n\n\n\n3.4.4 Nullclines and Phase Portraits\nNullclines, where the growth rate of one of the species are zero, are a very useful aid when drawing phase plane diagrams, also known as phase portraits. The nullclines for the Lotka-Volterra competition model are:\n\n\\(u_1\\) nullclines: \\(du_1/d\\tau = 0\\) when \\(u_1 = 0\\) or \\(u_2 = \\frac{1-u_1}{a_{12}}\\).\n\\(u_2\\) nullclines: \\(du_2/d\\tau = 0\\) when \\(u_2 = 0\\) or \\(u_2 = 1 - a_{21}u_1\\).\n\nAlong the \\(u_1\\) nullclines the flow is purely vertical and along the \\(u_2\\) nullclines the flow is purely horizontal. The intersection of the nullclines gives the steady states of the system. We can now draw the phase portrait to visualize the dynamics of the system. Very rough sketches are enough to understand the dynamics.\n\n\n\n\n\n\nFigure 3.2: Phase portrait of competition model when \\(a_{12}&lt;1\\) and \\(a_{21}&lt;1\\).\n\n\n\nFigure 3.2 shows the phase portrait of the competition model when \\(a_{12}&lt;1\\) and \\(a_{21}&lt;1\\). The nullclines are shown in grey and red, the flow lines in blue, with the arrows indicating the direction of the flow. The system exhibits a stable coexistence steady state, where both species persist in the ecosystem.\n\n\n\n\n\n\nFigure 3.3: Phase portrait of competition model when \\(a_{12}&gt;1\\) and \\(a_{21}&gt;1\\).\n\n\n\nFigure 3.3 illustrates the phase portrait of the competition model when \\(a_{12}&gt;1\\) and \\(a_{21}&gt;1\\). In this scenario, the coexistence steady state is a saddle, leading to the exclusion of one species. Which species dominates depends on the initial conditions. If the initial condition is below the separatrix, species 1 will dominate, and if it is above, species 2 will dominate.\n\n\n\n\n\n\nFigure 3.4: Phase portrait of competition model when \\(a_{12}&lt;1\\) and \\(a_{21}&gt;1\\).\n\n\n\nFigure 3.4 depicts the phase portrait of the competition model when \\(a_{12}&lt;1\\) and \\(a_{21}&gt;1\\). In this case, the coexistence steady state has disappeared (it has moved into a region with negative population numbers that is not ecologically relevant). Irrespective of initial conditions, the system will evolve towards the state where only species 1 exists. Species 2 is driven to extinction.\nWe are not drawing the case \\(a_{12}&gt;1\\) and \\(a_{21}&lt;1\\) as it is similar to the case \\(a_{12}&lt;1\\) and \\(a_{21}&gt;1\\) just with the role of species 1 and 2 reversed. In this case species 2 will dominate and species 1 will go extinct.\n\n\n3.4.5 Competitive Exclusion Principle\nThe competitive exclusion principle, proposed by Gause in the 1930s, states that two species competing for the same resources cannot coexist indefinitely, with one species eventually outcompeting the other.\nIn the model we studied the two species shared resources but each also had its own resources, hence we observed a weaker form of the competitive exclusion principle. The coexistence steady state was stable when the competition was weak enough, allowing both species to persist in the ecosystem. This highlights the delicate balance between competition and coexistence in ecological systems, where the strength of interspecies interactions plays a crucial role in determining the long-term dynamics of species populations.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Interacting populations</span>"
    ]
  },
  {
    "objectID": "interacting.html#mutualism-models",
    "href": "interacting.html#mutualism-models",
    "title": "3  Interacting populations",
    "section": "3.5 Mutualism Models",
    "text": "3.5 Mutualism Models\nIn ecological systems, mutualism refers to interactions where all participating species benefit, leading to increased growth rates. An example is the relationship between plants and their seed dispersers, such as insects, where both parties gain advantages from their association.\n\n3.5.1 Example\nThis model incorporates logistic growth, akin to the competition model, but with a twist to account for the mutualistic interaction:\n\\[\n\\frac{dN_1}{dt} = r_1N_1 \\left[ 1 - \\frac{N_1}{K_1} + b_{12}\\frac{N_2}{K_1} \\right], ~~~~~ \\frac{dN_2}{dt} = r_2N_2 \\left[ 1 - \\frac{N_2}{K_2} + b_{21}\\frac{N_1}{K_2} \\right],\n\\tag{3.27}\\]\nwhere \\(r_i\\), \\(K_i\\), and \\(b_{ij}\\) are all positive constants, with \\(b_{ij}\\) representing the mutualistic benefit to species \\(i\\) from species \\(j\\). Notice that we simply changed the sign of the competition terms in the competition model to turn them into mutualistic terms\n\n\n3.5.2 Nondimensionalization of the Model\nUsing nondimensional variables \\(u_i = N_i/K_i\\), \\(a_{ij} = b_{ij}K_j/K_i\\), \\(\\tau = r_1t\\), and \\(\\rho = r_2/r_1\\), the equations transform to:\n\\[\n\\frac{du_1}{d\\tau} = u_1(1 - u_1 + a_{12}u_2), ~~~~~ \\frac{du_2}{d\\tau} = \\rho u_2(1 - u_2 + a_{21}u_1).\n\\tag{3.28}\\] This is as in the competition model but with the signs in front of \\(a_{12}\\) and \\(a_{21}\\) reversed.\n\n\n3.5.3 Steady States and Stability\nThe system has the steady states \\((0, 0)\\), \\((0, 1)\\), \\((1, 0)\\), and \\(\\left(\\frac{1 + a_{12}}{\\delta}, \\frac{1 + a_{21}}{\\delta}\\right)\\), where \\(\\delta = 1 - a_{12}a_{21}\\). The coexistence steady state is ecologically relevant only if \\(\\delta &gt; 0\\).\n\nAt \\((0, 0)\\): The eigenvalues are \\(1\\) and \\(\\rho\\), indicating an unstable node.\nAt \\((0, 1)\\) and \\((1, 0)\\): These points are saddles, with eigenvalues showing a mix of positive and negative signs.\nAt the mutualistic steady state: The trace and determinant of the community matrix \\(\\mathbf{A}\\) suggest that this point is stable if \\(\\delta &gt; 0\\).\n\n\n\n3.5.4 Nullclines and Phase Portraits\nThe equations for the nullclines for this model are similar to those in the competition model, but now with positive slope rather than negative slope.\n\n\\(u_1\\) nullclines: \\(du_1/d\\tau = 0\\) when \\(u_1 = 0\\) or \\(u_2 = \\frac{u_1-1}{a_{12}}\\).\n\\(u_2\\) nullclines: \\(du_2/d\\tau = 0\\) when \\(u_2 = 0\\) or \\(u_2 = 1 + a_{21}u_1\\).\n\n\n\n\n\n\n\nFigure 3.5: Phase portrait of mutualistic model when \\(a_{12}a_{21}&lt;1\\).\n\n\n\nFigure 3.5 illustrates the phase portrait of the mutualism model when \\(a_{12}a_{21}&lt;1\\). The nullclines are shown in grey and red, with the flow lines in blue. The system exhibits a stable coexistence steady state, where both species benefit from the mutualistic interaction.\n\n\n3.5.5 Limitations and Unbounded Growth\nA cautionary note is that if the mutualistic coefficients \\(a_{12}a_{21}\\) are too large, leading to \\(\\delta &lt; 0\\), the model predicts unbounded growth, which is unrealistic. This phenomenon, known as May’s “orgy of mutual benefaction,” highlights the need for constraints in mutualism models to avoid predicting ecological impossibilities.\nThrough this mutualism model, we gain insights into how species interactions can foster increased growth and stability, contrasting with competitive dynamics. It underscores the diversity of ecological interactions and their varying implications for species survival and community structure.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Interacting populations</span>"
    ]
  },
  {
    "objectID": "interacting.html#exercises",
    "href": "interacting.html#exercises",
    "title": "3  Interacting populations",
    "section": "3.6 Exercises",
    "text": "3.6 Exercises\n\n* Two-species model 1\n\nExercise 3.1  \n\nConsider a model for the interaction of two species with populations \\(N_1\\) and \\(N_2\\) \\[\n\\frac{dN_1}{dt} = r_1 N_1 \\left( 1 - \\frac{N_1}{K_1} - b_{12}\\frac{ N_2}{K_1} \\right),\n\\tag{3.29}\\] \\[\n\\frac{N_2}{dt} = r_2 N_2 \\left( 1  - b_{21}\\frac{ N_1}{K_2} \\right),\n\\tag{3.30}\\] where all the parameters are positive.\n\nWhat type of interaction exists between \\(N_1\\) and \\(N_2\\)?\nNon-dimensionalize the system by introducing \\(u=N_1/K_1\\) and \\(v=N_2/K_2\\) as well as a non-dimensional time variable. What are the resulting non-dimensional parameters? Give the equations of motion for \\(u\\) and \\(v\\) in terms of these parameters.\nDetermine the steady states in the non-dimensionalised system. Investigate their stability. At what values of the parameters do bifurcations take place?\nDetermine the nullclines and use these to make rough phase-plane sketches (You will need two sketches).\nDescribe under what ecological circumstances \\(N_2\\) becomes extinct.\nDo the same for \\(N_1\\). Show that the principle of competitive exclusion holds irrespective of the size of the parameters.\n\n\n\n\n\nTwo-species model 2\n\nExercise 3.2  \n\nA model for the interaction between two species with populations \\(N_1\\) and \\(N_2\\) is determined to be \\[\n\\begin{split}\n\\frac{dN_1}{dt} &= rN_1\\left(1 - \\frac{N_1}{K}\\right) - aN_1N_2\\left(1 - \\exp(-bN_1)\\right),\\\\\n\\frac{dN_2}{dt} &= -dN_2 + cN_2\\left(1 - \\exp(-bN_1)\\right),\n\\end{split}\n\\tag{3.31}\\] where \\(a, b, c, d, r\\) and \\(K\\) are positive constants.\n\nIntroducing the dimensionless variables and parameters \\[\nu = \\frac{N_1}{K}, \\quad v = \\frac{aN_2}{r}, \\quad \\tau = rt, \\quad \\beta = bK,\n\\tag{3.32}\\] show that \\[\n\\begin{split}\n\\frac{du}{d\\tau} &= u(1 - u) - uv\\left(1 - e^{-\\beta u}\\right),\\\\\n\\frac{dv}{d\\tau} &= -\\delta v + \\alpha v\\left(1 - e^{-\\beta u}\\right),\n\\end{split}\n\\tag{3.33}\\] giving the positive constants \\(\\alpha\\) and \\(\\delta\\) in terms of \\(c, d\\) and \\(r\\).\nDescribe the relevance of each term and, hence, determine the type of interaction between the two populations.\nShow that the non-negative fixed points are given by \\((u^*, v^*) = (0, 0), (1,0)\\) and \\((u_1, (1 - u_1)\\alpha/\\delta)\\), where \\(u_1 = -\\ln(1 - \\delta/\\alpha)/\\beta\\), and that the steady state where \\(u^*\\) and \\(v^*\\) are both non-zero can only exist if \\(\\alpha &gt; \\delta\\) and \\(\\beta &gt; \\beta_c = -\\ln(1 - \\delta/\\alpha)\\).\nShow that the community matrix, \\(A\\), is given by \\[\nA = \\begin{pmatrix}\n1 - 2u - v(1 - e^{-\\beta u}) - \\beta uve^{-\\beta u} & -u\\left(1 - e^{-\\beta u}\\right) \\\\\n\\alpha v\\beta e^{-\\beta u} & -\\delta + \\alpha(1 - e^{-\\beta u})\n\\end{pmatrix}.\n\\tag{3.34}\\]\nAssuming henceforth that \\(\\delta/\\alpha &lt; 1\\), determine the linear stability of each of the fixed points.\nSketch the \\((u, v)\\) phase portrait to indicate the stability of each steady state for the two cases \\(\\beta &gt; \\beta_c\\) and \\(0 &lt; \\beta &lt; \\beta_c\\) (remember \\(\\alpha &gt; \\delta\\)).\n\n\n\n\n\nPredator-prey model with Allee effect\n\nExercise 3.3  \n\nConsider the predator-prey model with Allee effect in the prey: \\[\n\\begin{split}\n\\frac{dN}{dT} &= rN\\left(\\frac{N}{K_0} - 1\\right)\\left(1 - \\frac{N}{K}\\right) - cNP,\\\\\n\\frac{dP}{dT} &= bNP - mP,\n\\end{split}\n\\tag{3.35}\\] where \\(N(T)\\) is the number of prey and \\(P(T)\\) is the number of predators at time \\(T\\), and \\(r, K, c, b, m\\) are positive constants with \\(0 &lt; K_0 &lt; K\\). The populations \\(N(T), P(T)\\) are non-negative quantities.\n\nProvide brief biological interpretations for \\(r, K, K_0, c, b, m\\) for the above predator-prey model. What is the biological role of \\(K_0\\) in the modified prey growth rate?\nIntroduce the dimensionless variables \\(\\frac{N}{K} = x, \\frac{cP}{r} = y, rT = t\\) and show that the above system can be reduced to\n\n\\[\\begin{split}\n\\frac{dx}{dt} &= x\\left(\\left(\\frac{x}{\\gamma} - 1\\right)(1 - x) - y\\right) = x[g(x) - y],\\\\\n\\frac{dy}{dt} &= \\beta(x - \\alpha) y.\n\\end{split} \\tag{3.36}\\] How are the new dimensionless constants \\(\\alpha, \\beta\\) and \\(\\gamma\\) expressed in terms of the original parameters?\n\nFor the dimensionless system:\n\nCalculate the nullclines, clearly stating any conditions for their existence.\nUse your answer from (i) to sketch nullclines, depicting their intersections and the vector field direction along each isocline in the phase plane.\nFind the fixed points.\n\nFor the non-trivial fixed point, where both predators and preys may coexist:\n\nCalculate the Jacobian at this point in terms of the function \\(g(x), g'(x)\\), where \\('\\) denotes derivative in respect with \\(x\\).\nEvaluate the characteristic equation and study the stability of this fixed point as the parameter α varies within the range \\(\\gamma&lt;\\alpha&lt;1\\), classifying the non-trivial fixed point accordingly (i.e. node, spiral, centre or saddle point).",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Interacting populations</span>"
    ]
  },
  {
    "objectID": "sex_structured.html",
    "href": "sex_structured.html",
    "title": "4  Sex-structured population models",
    "section": "",
    "text": "Learning Objectives\nUp to this point we have completely ignored that there are differences between the individuals making up a population. So we ignored all structure within a population. We will now start to remedy this. In this chapter we will start with the simplest possible structure by splitting the population into males and females. Keeping track of both the abundance of males and of females separately makes sense because\nAfter completing this chapter, you should be able to:",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "sex_structured.html#learning-objectives",
    "href": "sex_structured.html#learning-objectives",
    "title": "4  Sex-structured population models",
    "section": "",
    "text": "Formulate and solve differential equations for sex-structured populations\nAnalyze how sex-specific birth and death rates affect population dynamics\nCalculate long-term sex ratios\nCompare different functional forms for the mating function \\(\\phi(F,M)\\).\nUnderstand female-limited reproduction and harmonic mean models",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "sex_structured.html#key-ecological-concepts",
    "href": "sex_structured.html#key-ecological-concepts",
    "title": "4  Sex-structured population models",
    "section": "Key Ecological Concepts",
    "text": "Key Ecological Concepts\nBefore diving into the mathematical models, let’s clarify some ecological terminology:\n\nSex ratio: The proportion of males to females in a population\nFemale-limited reproduction: When population growth is primarily limited by female numbers\nMating function: Mathematical representation of how males and females interact to produce offspring\nVital rates: Birth and death rates that may differ between sexes\nDemographic structure: How a population is divided into different groups (in this case, by sex)\n\nIn this chapter, instead of just looking at a single function \\(N(t)\\) giving the total population number, we will look at two functions \\(M(t)\\) and \\(F(t)\\) giving the number of males and females respectively. This division represents the most basic form of demographic structure in a population. We again describe them by differential equations that capture that the numbers can decrease due to deaths and increase due to births. \\[\n\\begin{split}\n\\frac{dF}{dt} &= -\\mu_F F + b_F\\,\\varphi(F,M)\\\\\n\\frac{dM}{dt} &= -\\mu_M M + b_M\\,\\varphi(F,M).\n\\end{split}\n\\tag{4.1}\\] Here \\(\\mu_F\\) and \\(\\mu_M\\) are the death rates of females and males respectively, which are examples of sex-specific vital rates. The rate of births now depends both on the number of females and the number of males, because both males and females are needed to produce offspring. We formulate that dependence on the number of females and the number of males as a mating function \\(\\varphi(F,M)\\). The functional dependence of the rate on \\(F\\) and \\(M\\) is the same for births of females and for births of males, but the extra factors \\(b_F\\) and \\(b_M\\) account for the differences between female and male birth rates, which are also vital rates that differ between sexes.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "sex_structured.html#symmetric-model",
    "href": "sex_structured.html#symmetric-model",
    "title": "4  Sex-structured population models",
    "section": "4.1 Symmetric model",
    "text": "4.1 Symmetric model\nWe first consider the simpler situation where birth and mortality rates are the same for males and females: \\[\n\\mu_F=\\mu_M=\\mu, ~~~b_F=b_M=b.\n\\tag{4.2}\\] In this case we can get a simple ODE for the difference \\(F-M\\) between the number of females and males: \\[\n\\frac{d(F-M)}{dt}=-\\mu(F-M).\n\\tag{4.3}\\] This equation has the solution \\[\nF(t)-M(t)=(F(0)-M(0))e^{-\\mu t}.\n\\tag{4.4}\\] This means that the difference decreases exponentially over time. In particular, if we start with equal number females and males then the they will stay equal for all times.\nTo make further progress we need to make a concrete choice for the function \\(\\varphi(F,M)\\). We will consider the choice \\[\n\\varphi(F,M)=F\\,M.\n\\tag{4.5}\\] This choice is motivated by the fact that both a male and a female is needed to produce offspring. Also the rate of births should increase if there are more females but also when there are more males.\nA simple thing to note is that if \\(M(0)=0\\) then \\(M(t)=0\\) for all times. Then the number of females satisfies \\[\n\\frac{dF}{dt}=-\\mu F.\n\\tag{4.6}\\] This has the solution \\[\nF(t)=F(0)e^{-\\mu t}.\n\\tag{4.7}\\] So if there are no males, the females have to die out as well.\nWe noted above that if initially \\(F(0)=M(0)\\) then \\(F(t)=M(t)\\) for all times. In that case the number of females satisfies \\[\n\\frac{dF}{dt}=-\\mu F+bF^2.\n\\tag{4.8}\\] This is illustrated in Figure 4.1.\n\n\n\n\n\n\n\n\nFigure 4.1: Quadratically increasing growth rate.\n\n\n\n\n\nNote that the non-zero fixed point at \\(F=\\mu/b\\) is unstable. If \\(F(0)&lt;\\mu/b\\) then the females and hence the males go extinct. If \\(F(0)&gt;\\mu/b\\) then the females and hence the males grow rapidly. In fact, they grow so rapidly that the population size becomes infinite in finite time, as we can see when we solve the ODE.\nWe can solve Eq. 4.8 by separation of variables: \\[\n\\int\\frac{dF}{-\\mu F+bF^2}=\\int dt.\n\\] We could do the integral on the left hand side by partial fractions. But to see the problem of the population size becoming infinite in finite time it is sufficient to consider the case of \\(F&gt;&gt;1\\) where we can neglect the term \\(-\\mu F\\) in the denominator. Then we get \\[\n\\int_{F(0)}^{F(t)}\\frac{dF}{F^2}=\\frac{1}{F(0)}-\\frac{1}{F(t)}=\\int_0^t b\\, d\\tilde{t}=bt.\n\\] and hence \\[\nF(t)=\\frac{1}{1/F(0)-bt}.\n\\tag{4.9}\\] So the population size becomes infinite at time \\(t=1/(bF(0))\\). So clearly this model is not ecologically sensible.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "sex_structured.html#female-limited-reproduction",
    "href": "sex_structured.html#female-limited-reproduction",
    "title": "4  Sex-structured population models",
    "section": "4.2 Female-limited reproduction",
    "text": "4.2 Female-limited reproduction\nWe will now consider a model where the birth rate depends only on the number of females: \\[\n\\varphi(F,M)=F.\n\\tag{4.10}\\] This is clearly a strong simplification but is reasonable for populations where there are always more than enough males to fertilize all females.\nWith this simplification, the ODE for \\(F\\) becomes \\[\n\\frac{dF}{dt}=-\\mu_F F+b_F F=(-\\mu_F+b_F)F.\n\\tag{4.11}\\] This has the solution \\[\nF(t)=F(0)e^{(-\\mu_F+b_F)t}.\n\\tag{4.12}\\] We can now use this in the equation for \\(M\\): \\[\n\\frac{dM}{dt}=-\\mu_M M+b_M F=-\\mu_M M+b_M F_0\\,e^{(-\\mu_F+b_F)t}.\n\\tag{4.13}\\] (We have used \\(F(0)=F_0\\) to make the equation more readable.) This is a first-order linear ODE with time-dependent inhomogeneity. We can solve it by the method of integrating factors. We first rewrite it in the form \\[\n\\frac{dM}{dt}+\\mu_M M=b_M F_0\\,e^{(-\\mu_F+b_F)t}\n\\tag{4.14}\\] and then observe that the left-hand side is proportional to a total derivative: \\[\n\\frac{dM}{dt}+\\mu_M M=\\frac{d}{dt}(e^{\\mu_M t}M)e^{-\\mu_M t}\n\\tag{4.15}\\] Thus after multiplying both sides by \\(e^{\\mu_M t}\\) we get \\[\n\\frac{d}{dt}(e^{\\mu_M t}M)=b_M F_0\\,e^{(\\mu_M-\\mu_F+b_F)t}.\n\\tag{4.16}\\] We can now integrate both sides to get \\[\ne^{\\mu_M t}M(t)-e^{\\mu_M t}M_0=\\frac{b_M F_0}{\\mu_M-\\mu_F+b_F}\\left(e^{(\\mu_M-\\mu_F+b_F)t}-1\\right).\n\\tag{4.17}\\] This can be solved for \\(M(t)\\): \\[\nM(t)=M_0+\\frac{b_M F_0}{\\mu_M-\\mu_F+b_F}\\left(e^{(-\\mu_F+b_F)t}-e^{-\\mu_M t}\\right).\n\\tag{4.18}\\] We have been able to fully solve this model. At this stage it is worth checking that the dependence of the solution on the parameters and on the initial conditions is reasonable.\nNext let us take a look at the sex ratio as \\(t\\to\\infty\\). Of course this only makes sense in the case where \\(b_F\\geq \\mu+F\\) because otherwise, according to Eq. 4.12, the females go extinct and then so do the males. With \\(b_F\\geq \\mu+F\\) we find \\[\\begin{split}\ns=\\lim_{t\\to\\infty}\\frac{M(t)}{F(t)}\n&=\\lim_{t\\to\\infty}\\frac{M_0+\\frac{b_M F_0}{\\mu_M-\\mu_F+b_F}\\left(e^{(-\\mu_F+b_F)t}-e^{-\\mu_M t}\\right)}{F_0e^{(-\\mu_F+b_F)t}}\\\\\n&=\\frac{b_M}{b_F-\\mu_F+\\mu_M}.\n\\end{split} \\tag{4.19}\\]\nJust for fun let us check what this model would predict for the sex ratio in the population of the US, using data about births and deaths from 1992. \\[\n\\begin{split}\n\\mu_F&=807/100,000/\\text{year}, ~~~\\mu_M=902/100,000/\\text{year},\\\\\nb_F&=1480/100,000/\\text{year}, ~~~b_M=1550/100,000/\\text{year}.\n\\end{split}\n\\tag{4.20}\\] Substituting these values into Eq. 4.19 we get \\(s \\approx 0.9841\\). The actual ratio in the US in 1992 was \\(0.953\\). Of course this is not to be taken seriously. To start with, human populations are not solely female-limited. But there are many other criticisms that can be made of this model when applied to human populations.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "sex_structured.html#harmonic-mean-model",
    "href": "sex_structured.html#harmonic-mean-model",
    "title": "4  Sex-structured population models",
    "section": "4.3 Harmonic mean model",
    "text": "4.3 Harmonic mean model\nWe will now consider a model where the birth rate depends on both the number of males and the number of females. We choose to set \\(\\varphi(F,M)\\) to a weighted average of \\(F\\) and \\(M\\): \\[\n\\varphi(F,M)=D\\,M+(1-D)F\n\\tag{4.21}\\] with some suitably chosen weighting factor \\(D\\). We want to keep the feature that when there is an over-abundance of males, then the birth rate is limited mostly by the number of females and vice versa. So we choose \\(D=M/(F+M)\\), which is the relative abundance of males. This makes \\(1-D=F/(F+M)\\), which is the relative abundance of females. This gives \\[\n\\varphi(F,M)=\\frac{M}{F+M}F+\\frac{F}{F+M}M=\\frac{2FM}{F+M}.\n\\tag{4.22}\\] We can now use this in the ODEs for \\(F\\) and \\(M\\): \\[\n\\begin{split}\n\\frac{dF}{dt} &= -\\mu_F F+b_F\\frac{2FM}{F+M},\\\\\n\\frac{dM}{dt} &= -\\mu_M M+b_M\\frac{2FM}{F+M}.\n\\end{split}\n\\tag{4.23}\\] We will not try to solve this coupled system of non-linear ODEs. Instead we will directly look at the long-term sex ratio. We can derive an ODE for the sex ration \\(M/F\\): \\[\n\\frac{d}{dt}\\frac{M}{F}=\\frac{\\frac{dM}{dt}F-M\\frac{dF}{dt}}{F^2}.\n\\tag{4.24}\\] Because we are only interested in the long-term behaviour we look at the fixed point of this equation, hence we set the left-hand side to zero. We then get \\[\n\\frac{dM}{dt}F-M\\frac{dF}{dt}=0.\n\\tag{4.25}\\] We can now use the ODEs for \\(F\\) and \\(M\\) to get \\[\n\\begin{split}\n\\frac{dM}{dt}F-M\\frac{dF}{dt}=&\\left(-\\mu_M M+b_M\\frac{2FM}{F+M}\\right)F\\\\\n&-M\\left(-\\mu_F F+b_F\\frac{2FM}{F+M}\\right)=0.\n\\end{split}\n\\tag{4.26}\\] We multiply by \\(F+M\\) and divide by \\(FM\\) to get \\[\n-\\mu_M(F+M)+2b_MF+\\mu_F(F+M)-2b_FM=0.\n\\tag{4.27}\\] Collecting terms proportional to \\(F\\) and \\(M\\) we get \\[\n(-\\mu_M+2b_M+\\mu_F)F=(\\mu_M-\\mu_F+2b_F)M.\n\\tag{4.28}\\] We can now solve this equation for the asymptotic sex ratio \\[\ns=\\lim_{t\\to\\infty}\\frac{M(t)}{F(t)}=\\frac{\\mu_M-\\mu_F+2b_F}{-\\mu_M+2b_M+\\mu_F}.\n\\tag{4.29}\\]\nEven though the sex ratio approaches a fixed point as \\(t\\to\\infty\\), the population numbers themselves do not. Once the sex ratio has settled to the value \\(s\\), we have \\(M=sF\\) and we can use this to get a single ODE for \\(F\\): \\[\n\\begin{split}\n\\frac{dF}{dt}&=-\\mu_F F+b_F\\frac{2MF}{F+M}\\\\\n&=-\\mu_F F+\\frac{2s}{s+1}b_FF\\\\\n&=rF\n\\end{split}\n\\tag{4.30}\\] where \\[\nr=-\\mu_F+b_F\\frac{2s}{s+1}=\\frac{2b_Mb_F-\\mu_Mb_F-\\mu_Fb_M}{b_M+b_F}.\n\\] This is a linear equation and has the solution \\[\nF(t)=F_0e^{rt}.\n\\tag{4.31}\\]\nSo we have an exponential growth model for both \\(F\\) and \\(M\\), but the exponent has a modified birth rate that takes the sex ratio into account.\nTo arrive at more realistic models we should introduce a carrying capacity into the model.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "sex_structured.html#exercises",
    "href": "sex_structured.html#exercises",
    "title": "4  Sex-structured population models",
    "section": "4.4 Exercises",
    "text": "4.4 Exercises\n\n* Geometric mean sex-structured model\n\nExercise 4.1 Consider the sex-structured population model \\[\n\\frac{dF}{dt}=-\\mu_F F+b_F\\phi(F,M), ~~~\\frac{dM}{dt}=-\\mu_M M+b_M\\phi(F,M),\n\\] where \\(F(t)\\) denotes the number of females and \\(M(t)\\) the number of males and \\(\\mu_F,\\mu_M,b_F,b_M\\) are positive constants. Make the choice \\[\n\\phi(F,N)=\\sqrt{FM}.\n\\] Determine the asymptotic sex ratio \\[\ns=\\lim_{t\\to\\infty}\\frac{M(t)}{F(t)}?\n\\] What is the numerical value of s when \\(\\mu_F=2,\\mu_M=1,b_F=1/2,b_M=3/2\\) per year?\n\n\n\n\nDominance structure\n\nExercise 4.2 We consider a population of primates and split this into three components:\n\\(M\\): dominant (alpha) males,\n\\(F\\): dominant (alpha) females,\n\\(Q\\): subordinate males or females.\nOnly alpha males and alpha females mate to reproduce offspring. The subordinate individuals are prevented from mating. The alpha females are too engaged with looking after their young to gather food and instead rely on the food gathered by the subordinate individuals. We propose to model this with the equations \\[\n\\begin{split}\n\\frac{dF}{dt}&=b_F F-\\frac{\\mu_F F}{Q}F,\\\\\n\\frac{dM}{dt}&=b_M F-\\mu_M M,\\\\\n\\frac{dQ}{dt}&=b_{Q} F-\\mu_{Q} Q ,\n\\end{split}\n\\] where \\(b_F&gt;\\mu_F,b_M&gt;\\mu_M\\) and \\(b_Q &gt;\\mu_Q\\) are all positive constants.\n\nOne of the terms incorporates a ratio of different components. Describe what this might be intended to model.\nDerive an ODE for the ratio \\(F/Q\\). Either by recognising the ODE for \\(F/Q\\) as equivalent to one for which the solution was given in the lecture notes, or by integrating the ODE, give the solution for \\(F/Q\\) as a function of time, with initial condition \\(F(0)=F_0,\nQ (0)=Q_0\\).\nBy using your solution from the previous part or by other means, show that as \\(t\\to\\infty\\) the ratio between alpha females and subordinate individuals goes to \\[\n\\frac{b_F+\\mu_Q }{b_Q +\\mu_F}.\n\\]\nDerive an expression for the long-term alpha female to alpha male ratio \\(R=\\lim_{t\\to\\infty}F/M\\) in terms of the model parameters and show that it is positive.\nDescribe a limitation of the birth terms in the model and suggest improved expressions.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "sex_structured.html#summary",
    "href": "sex_structured.html#summary",
    "title": "4  Sex-structured population models",
    "section": "Summary",
    "text": "Summary\nThis chapter introduced several key concepts in sex-structured population dynamics:\n\nBasic Model Structure\n\nPopulation divided into males (M) and females (F)\nEach sex has its own vital rates\nReproduction requires both sexes, encoded in the mating function \\(\\phi(F,M)\\)\n\nSymmetric Model\n\nWhen birth and death rates are equal for both sexes\nDifference between male and female numbers decreases exponentially\nQuadratic mating function can lead to population explosion in finite time\n\nFemale-Limited Reproduction\n\nMating function depends only on female numbers\nApplicable when males are abundant relative to females\nLeads to predictable long-term sex ratio\n\nHarmonic Mean Model\n\nMating function depends on weighted average of male and female numbers\nMore realistic for populations where both sexes can be limiting\nProduces stable long-term sex ratio\n\n\nIn the next chapters, we will explore more complex demographic structures, including age structure and spatial distribution.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Sex-structured population models</span>"
    ]
  },
  {
    "objectID": "age_structured.html",
    "href": "age_structured.html",
    "title": "5  Age-structured population model",
    "section": "",
    "text": "Learning Objectives\nIn the previous chapter we structured the population by a discrete variable, the sex of the individuals. This gave rise to a system of coupled ODEs, one ODE for each class of individuals. In this section we will structure the population by a continuous variable, the age of the individuals. In the continuous-time model this will give rise to a partial differential equation (PDE) for the age-dependent population density. We will discuss that PDE in Section 5.2. But first, in Section 5.1, we will discuss the discrete-time model, where also age is discrete. This will give rise to a system of coupled difference equations, one equation for each age class.\nBy the end of this chapter, you should be able to:",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Age-structured population model</span>"
    ]
  },
  {
    "objectID": "age_structured.html#learning-objectives",
    "href": "age_structured.html#learning-objectives",
    "title": "5  Age-structured population model",
    "section": "",
    "text": "Understand how age structure affects population dynamics in both discrete and continuous time models\nFormulate and analyze discrete-time age-structured models using Leslie matrices\nSolve the McKendrick-von Foerster equation for continuous-time age-structured populations\nApply the condition for population persistence or extinction based on the reproductive number\nDetermine the stable age distribution and long-term growth factor of a population\nDerive and interpret the Euler-Lotka equation for both discrete and continuous time models",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Age-structured population model</span>"
    ]
  },
  {
    "objectID": "age_structured.html#sec-age-discrete",
    "href": "age_structured.html#sec-age-discrete",
    "title": "5  Age-structured population model",
    "section": "5.1 Discrete time model",
    "text": "5.1 Discrete time model\nAs we discussed in Chapter 2, a discrete-time model is the natural choice if reproduction is an annual event, taking place in a short breeding season for example. We will now introduce a discrete-time age-structured population model. We will derive the model and then study the long-term behaviour of the population and its age distribution.\n\n5.1.1 Model description\nBoth time and age will be discrete variables. We will take them to be integers counting years. We will describe the population by the numbers \\(N_{a,t}\\) of individuals of age \\(a\\) at time \\(t\\), with \\(a\\) and \\(t\\) both integers and \\(a\\geq 0\\). The total number \\(N_t\\) of individuals in the population at time \\(t\\) is then given by the sum of \\(N_{a,t}\\) over all ages.\nThe parameters of our model will be the probabilities \\(S_a\\) of surviving from age \\(a\\) to age \\(a+1\\) and the number of offspring \\(b_a\\) produced by an individual when they reach age \\(a\\). Because the number of individuals at age \\(a\\) at time \\(t+1\\) is the number of individuals that a year earlier were at age \\(a-1\\) and have survived to age \\(a\\), we have \\[\nN_{a,t+1} = S_{a-1} N_{a-1,t}\n\\tag{5.1}\\] for \\(a=1,2,\\dots\\).\nWhen individuals reach age \\(a\\), they each produce \\(b_a\\) offspring. The total number of offspring produced at time \\(t\\) is therefore obtained by summing over all ages \\(a\\) the number of individuals at age \\(a\\) at time \\(t\\) times the number of offspring produced by an individual of age \\(a\\): \\[\nN_{0,t} = \\sum_{a=1}^\\infty b_a N_{a,t}.\n\\tag{5.2}\\]\nIn Eq. 5.2 both sides of the equation are at time \\(t\\). That is because reproduction is taken to happen instantaneously at the start of year \\(t\\). It is conventional to use Eq. 5.1 to rewrite Eq. 5.2 as an equation for \\(N_{0,t+1}\\): \\[\nN_{0,t+1} = \\sum_{a=1}^\\infty b_a N_{a,t+1}= \\sum_{a=1}^\\infty b_a S_{a-1} N_{a-1,t}\n= \\sum_{a=1}^\\infty F_{a-1} N_{a-1,t},\n\\tag{5.3}\\] where we have introduced the fecundity \\[\nF_a:=b_{a+1} S_{a}.\n\\]\nEq. 5.1 and Eq. 5.3 are the equations for the discrete-time age-structured population model. They are a system of coupled difference equations, one equation for each age class. Let us write them out again more explicitly: \\[\n\\begin{split}\nN_{0,t+1}&=F_0 N_{0,t}+F_1N_{1,t}+\\cdots +F_{m-1}N_{m-1}+F_{m}N_{m}+\\cdots, \\\\\nN_{1,t+1}&=S_0 N_{0,t}, \\\\\nN_{2,t+1}&=S_1 N_{1,t}, \\\\\n&\\vdots \\\\\nN_{m-1,t+1}&=S_{m-2} N_{m-2,t}, \\\\\nN_{m,t+1}&=S_{m-1} N_{m-1,t}, \\\\\n&\\vdots\n\\end{split}\n\\tag{5.4}\\] Annoyingly, the equation for \\(N_{0,t+1}\\) couples all these infinitely many equations together. We would like to solve these coupled equations to determine the numbers \\(N_{a,t}\\) of individuals at each age at each time, given the initial numbers \\(N_{a,0}\\) for all ages \\(a\\) at time \\(t=0\\). This can generally not be done analytically.\n\n\n\n5.1.2 Leslie matrix\nSo far we have dealt with an infinite set of age classes. However there are two situations where we can reduce the infinite set of equations Eq. 5.4 to a finite set. In those cases we can rewrite the equations in matrix form and analyse them using matrix algebra.\nThe first situation where only a finite number of equations is coupled together is when there is a maximal age \\(m\\) beyond which there is no reproduction, either because \\(b_a = 0\\) for \\(a&gt;m\\) or because there are no older individuals because \\(S_{m} = 0\\). In this case we can collect the equations for \\(N_{a,t+1}\\) for \\(a=0,1,2,\\ldots,m-1\\) into the matrix equation \\[\n\\begin{pmatrix}\nN_{0} \\\\\nN_{1} \\\\\nN_{2} \\\\\n\\vdots \\\\\nN_{m-1}\n\\end{pmatrix}_{t+1}\n=\n\\begin{pmatrix}\nF_0 & F_1 & \\cdots & F_{m-2} & F_{m-1} \\\\\nS_0 & 0 & \\cdots & 0 & 0 \\\\\n0 & S_1 & \\cdots & 0 & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & \\cdots & S_{m-2} & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nN_{0} \\\\\nN_{1} \\\\\nN_{2} \\\\\n\\vdots \\\\\nN_{m-1}\n\\end{pmatrix}_{t}.\n\\tag{5.5}\\] The matrix on the right-hand side is called the Leslie matrix.\nWe can represent this Leslie matrix with the directed graph in Figure 5.1. The graph has one node for each age class \\(a=0,1,2,\\ldots,m-1\\) and a directed edge from node \\(i\\) to node \\(j\\) if and only if the Leslie matrix has a non-zero entry in column \\(i\\) and row \\(j\\). The graph is called the Leslie graph.\n\n\n\n\n\n\nFigure 5.1: Leslie graph when there is no reproduction from ages greater than \\(m\\).\n\n\n\nNote that we did not need to include the age class \\(m\\) because it is not needed to calculate the reproduction because \\(F_m=b_{m+1}S_{m}=0\\). Once the matrix equation Eq. 5.5 is solved, we can determine \\(N_{m,t+1}\\) separately from Eq. 5.1 if we are interested, and similarly for all older age classes that do not reproduce, if any.\nLet us denote the Leslie matrix by \\(L\\). The equations Eq. 5.5 and Eq. 5.12 are matrix equations of the form \\[\n\\mathbf{N}_{t+1} = L\\, \\mathbf{N}_t,\n\\tag{5.6}\\] where \\(\\mathbf{N}_t\\) is the column vector of the numbers \\(N_{a,t}\\) and \\(L\\) is the Leslie matrix.\n\n\nExample 5.1 Consider a population with the reproduction numbers \\(b_a\\) and the survival probabilities \\(S_a\\) given in the following table:\n\n\n\n\\(a\\)\n\\(b_a\\)\n\\(S_a\\)\n\\(F_a\\)\n\n\n\n\n0\n0\n1\n0\n\n\n1\n0\n1/2\n1/2\n\n\n2\n1\n1/2\n1\n\n\n3\n2\n1/2\n0\n\n\n4\n0\n\\(\\vdots\\)\n\\(\\vdots\\)\n\n\n5\n\\(\\vdots\\)\n\\(\\vdots\\)\n\\(\\vdots\\)\n\n\n\nThe final column in that table is calculated from the previous ones using \\(F_a:=b_{a+1}S_{a}\\). In this example the maximum age \\(m\\) beyond which there is no reproduction is \\(m=3\\). Hence the corresponding Leslie matrix is a \\(3\\times 3\\) matrix. It is given by \\[\nL = \\begin{pmatrix}\nF_0&F_1&F_2 \\\\\nS_0 & 0 & 0 \\\\\n0 & S_1 & 0\n\\end{pmatrix}=\\begin{pmatrix}\n0 & 1/2 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 1/2 & 0\n\\end{pmatrix}.\n\\tag{5.7}\\]\nAssume that the at time \\(t=0\\) we only have 10 individuals all of age 0, i.e., \\[\n\\mathbf{N}_0 = \\begin{pmatrix}\n10 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n\\tag{5.8}\\] We can then calculate the numbers at the following times \\(t=1,2,3,\\ldots\\) by repeated multiplication by the Leslie matrix \\(L\\): \\[\n\\mathbf{N}_1 = L \\mathbf{N}_0 = \\begin{pmatrix}\n0 & 1/2 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 1/2 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n10 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\\n10 \\\\\n0\n\\end{pmatrix},\n\\] \\[\n\\mathbf{N}_2 = L \\mathbf{N}_1\n= \\begin{pmatrix}\n5 \\\\\n0 \\\\\n5\n\\end{pmatrix},\n~~~\n\\mathbf{N}_3 = L \\mathbf{N}_2 = \\begin{pmatrix}\n5 \\\\\n5 \\\\\n0\n\\end{pmatrix}, \\cdots.\n\\tag{5.9}\\] Continuing like this (using a computer) we observe that the population converges to a stable age distribution. \\[\n\\lim_{t\\to\\infty}\\mathbf{N}_t = \\begin{pmatrix}\n4 \\\\\n4 \\\\\n2\n\\end{pmatrix}.\n\\tag{5.10}\\] This means that the population will eventually consist of \\(4\\) individuals of age \\(0\\), \\(4\\) individuals of age \\(1\\), and \\(2\\) individuals of age \\(2\\). We can calculate the number of older individuals as follows \\(N_{3,t} = S_2 N_{2,t} = 1, N_{4,t}=S_3N_{3,t}=1/2,\\cdots\\) as \\(t\\to\\infty\\).\n\n\nThe other situation where we only need a finite number of age classes is where the survival probabilities and the reproduction numbers are constant for all ages above a certain age \\(m-1\\). We can then collapse all individuals of age \\(m\\) or larger into the same age class \\(m\\). The survivors from age class \\(m\\) are thus put back into the same age class \\(m\\). This modifies the equation for \\(N_{m,t+1}\\) to \\[\nN_{m,t+1} = S_{m-1} N_{m-1,t} + S_{m} N_{m,t}.\n\\tag{5.11}\\] In this case we can write the model as a matrix equation of the form \\[\n\\begin{pmatrix}\nN_{0} \\\\\nN_{1} \\\\\nN_{2} \\\\\n\\vdots \\\\\nN_{m}\n\\end{pmatrix}_{t+1}\n=\n\\begin{pmatrix}\nF_0 & F_1 & \\cdots & F_{m-1} & F_{m} \\\\\nS_0 & 0 & \\cdots & 0 & 0 \\\\\n0 & S_1 & \\cdots & 0 & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & \\cdots & S_{m-1} & S_m\n\\end{pmatrix}\n\\begin{pmatrix}\nN_{0} \\\\\nN_{1} \\\\\nN_{2} \\\\\n\\vdots \\\\\nN_{m}\n\\end{pmatrix}_{t}.\n\\tag{5.12}\\] Now \\(N_{m,t}\\) is the number of all individuals of age \\(m\\) or older at time \\(t\\). We can represent this Leslie matrix with the graph in Figure 5.2 .\n\n\n\n\n\n\nFigure 5.2: Leslie graph when the last age class contains all individuals with age \\(\\geq m\\).\n\n\n\n\n\n5.1.3 Stable age distribution\nThe phenomenon that we observed in Example 5.1 that the age distribution settles down to a stable age distribution as time goes on is a general phenomenon. To understand it we will now look for a solution such that \\[\nN_{a,t+1} = \\lambda N_{a,t}\n\\tag{5.13}\\] This is a solution in which the age distribution remains stable from one year to the next, but the total population grows or shrinks by a factor \\(\\lambda\\) each year. It was untypical that in Example 5.1 we had \\(\\lambda=1\\) so that the population neither grew nor shrank.\nFor \\(a=1\\) Eq. 5.13 gives \\[\nN_{1,t+1} = \\lambda N_{1,t} = S_0 N_{0,t}\n\\tag{5.14}\\] and hence \\[\nN_{1,t} = \\frac{S_0}{\\lambda} N_{0,t}.\n\\tag{5.15}\\] Similarly we can express \\(N_{2,t}\\) in terms of \\(N_{0,t}\\): \\[\nN_{2,t} = \\frac{S_1}{\\lambda} N_{1,t} = \\frac{S_1 S_0}{\\lambda^2} N_{0,t}.\n\\tag{5.16}\\] We can continue this process to express \\(N_{a,t}\\) in terms of \\(N_{0,t}\\): \\[\nN_{a,t} = \\frac{S_{a-1}S_{a-2}\\cdots S_0}{\\lambda^a} N_{0,t}= \\frac{l_{a}}{\\lambda^a} N_{0,t}\n\\tag{5.17}\\] where \\[\nl_a:=S_{a-1}S_{a-2}\\cdots S_0.\n\\tag{5.18}\\] is the probability of surviving from age \\(0\\) to age \\(a\\).\nSubstituting Eq. 5.17 into Eq. 5.2 for the newborns gives \\[\nN_{0,t} = \\sum_{a=1}^\\infty b_{a} N_{a,t} = \\sum_{a=1}^\\infty b_{a} \\frac{l_{a}}{\\lambda^{a}} N_{0,t}.\n\\tag{5.19}\\] Dividing the equation by \\(N_{0,t}\\) gives \\[\n1 = \\sum_{a=1}^\\infty b_a \\,l_a\\,\\lambda^{-a} =:\\psi(\\lambda).\n\\tag{5.20}\\] This is the Euler-Lotka equation for the population growth factor \\(\\lambda\\) in the stable age distribution. Once we have solved it to determine \\(\\lambda\\), we can use Eq. 5.13 to determine the stable age distribution, \\[\nN_{a,t} = \\lambda^{t-a}l_{a} N_{0,0}.\n\\tag{5.21}\\] Unfortunately solving the Euler-Lotka equation analytically is normally not feasible. You will however find a solvable example in Exercise 5.1 below.\n\n\n5.1.4 Condition for extinction\nLuckily we do not need to solve the Euler-Lotka equation in order to determine whether the population grows or goes extinct. We note that \\[\n\\psi(1)=\\sum_{a=1}^\\infty b_a \\,l_a=:R\n\\tag{5.22}\\] is the expected number of offspring produced by an individual during its lifetime. This quantity is known as the reproductive number. If this reproductive number is greater than \\(1\\), then the population grows exponentially. If it is less than \\(1\\), then the population goes extinct. The way to see this from the Euler-Lotka equation Eq. 5.31 is to note that \\(\\psi(\\lambda)\\) is a decreasing function of \\(\\lambda\\). This means that there is a unique solution \\(\\lambda\\) to the Euler-Lotka equation and\n\nIf \\(R&gt;1\\) then \\(\\lambda&gt;1\\) and population grows exponentially;\nIf \\(R&lt;1\\) then \\(\\lambda&lt;1\\) and population goes extinct.\n\n\n\nExercise 5.1 (Spotted owl) For the spotted owl the age-dependent reproduction numbers are \\[\nb_a = \\begin{cases}\n0 & \\text{if } a &lt; 2, \\\\\nb & \\text{if } a \\geq 2\n\\end{cases}\n\\tag{5.23}\\] for some constant \\(b\\). The age-dependent survival probabilities are \\[\nS_a = \\begin{cases}\n1 & \\text{if } a = 0, \\\\\nl & \\text{if } a = 1, \\\\\np & \\text{if } a &gt; 1\n\\end{cases}\n\\tag{5.24}\\] for some constants \\(l\\) and \\(p\\).\n\nDetermine the probability that an individual survives from birth up to at least age \\(a\\).\nDetermine the expected number of offspring produced by a single individual during their lifetime.\nGive the condition on \\(b\\) for the population to be able to persist.\nDetermine the long-term growth factor of the population.\nDetermine the stable age distribution of the population.\n\n\n\n\n\n5.1.5 Solving the Leslie equation\nThe Leslie matrix equation Eq. 5.6 is a homogeneous linear difference equation with constant coefficients (the Leslie matrix \\(L\\) does not depend on time). You know from earlier modules that when confronted with a homogeneous linear differential equation with constant coefficients you can solve it with an exponential Ansatz. The same works for linear difference equations.\nSolving the Leslie matrix equation will give us another route to understanding the stable age distribution and the condition for extinction or survival of the population.\nWe make the Ansatz \\[\n\\mathbf{N}_t = \\lambda^t \\mathbf{v}\n\\tag{5.25}\\] and substitute it into Eq. 5.6. This gives \\[\n\\lambda^{t+1} \\mathbf{v} = L \\lambda^t \\mathbf{v}.\n\\tag{5.26}\\] Dividing by \\(\\lambda^t\\) gives \\[\n\\lambda \\mathbf{v} = L \\mathbf{v}.\n\\tag{5.27}\\] This means that our Ansatz works if we choose \\(\\lambda\\) to be an eigenvalue of the Leslie matrix \\(L\\) and \\(\\mathbf{v}\\) to be the corresponding eigenvector.\nIn the case where all eigenvalues of the Leslie matrix are distinct1, the general solution is the linear combination of the solutions for each eigenvalue. \\[\n\\mathbf{N}_t = c_1 \\lambda_1^t \\mathbf{v}_1 + c_2 \\lambda_2^t \\mathbf{v}_2 + \\cdots + c_n \\lambda_n^t \\mathbf{v}_n,\n\\tag{5.28}\\] where \\(\\lambda_1,\\lambda_2,\\ldots,\\lambda_n\\) are the distinct eigenvalues of the Leslie matrix and \\(\\mathbf{v}_1,\\mathbf{v}_2,\\ldots,\\mathbf{v}_n\\) are the corresponding eigenvectors. The constants \\(c_1,c_2,\\ldots,c_n\\) are determined by the eigenvector expansion of the initial values \\(\\mathbf{N}_0\\): \\[\n\\mathbf{N}_0 = c_1 \\mathbf{v}_1 + c_2 \\mathbf{v}_2 + \\cdots + c_n \\mathbf{v}_n.\n\\tag{5.29}\\]\nWe can now look at the long-term fate of the population. If the Leslie matrix has a unique dominant eigenvalue which we will denote \\(\\lambda_1\\) then by definition \\[\n|\\lambda_1| &gt; |\\lambda_2| \\geq |\\lambda_3| \\geq \\cdots \\geq |\\lambda_n|.\n\\] Then \\[\n\\lim_{t\\to\\infty}\\frac{\\mathbf{N}_t}{\\lambda_1^t} = c_1 \\mathbf{v}_1.\n\\tag{5.30}\\] This means that the population converges to a stable age distribution, given by the eigenvector corresponding to the dominant eigenvalue of the Leslie matrix.\nLuckily, there is a theorem about the eigenvalues and eigenvectors of non-negative matrices that we can use to determine whether a Leslie matrix has a unique dominant eigenvalue.\n\nDefinition 5.1 We call the Leslie matrix irreducible if its Leslie graph is strongly connected, which means that there is a directed path from any node to any other node.\n\n\nDefinition 5.2 We call the Leslie matrix primitive if the greatest common divisor of the lengths of all circuits in the Leslie graph is \\(1\\).\n\n\nTheorem 5.1 If the Leslie matrix is irreducible and primitive, then it has a unique dominant eigenvalue that is real and positive. The corresponding right eigenvector is real and strictly positive.\n\nThis is a special case of the Perron-Frobenius theorem, which is a general theorem about non-negative matrices, and is used extensively in the theory of Markov chains. The above theorem is exactly what we need, because it tells us when the Leslie matrix has a unique dominant eigenvalue and a corresponding eigenvector that gives the stable age distribution.\n\nExample 5.1 continued\nWe return to Example 5.1. The Leslie graph is shown in Figure 5.3.\n\n\n\n\n\n\nFigure 5.3: Leslie graph for Example 5.1.\n\n\n\nIt is irreducible and primitive, so we expect there to be a unique dominant eigenvalue. Let us verify this. The eigenvalues are the solutions of the characteristic equation \\[\n\\begin{split}\n0&=\\det(L-\\lambda I)=\\begin{vmatrix}\n-\\lambda & 1/2 & 1 \\\\\n1 & -\\lambda & 0 \\\\\n0 & 1/2 & -\\lambda\n\\end{vmatrix}\n= -\\lambda^3 + \\frac{1}{2}\\lambda+\\frac12\\\\\n&= (1-\\lambda)\\left(\\lambda^2+\\lambda+\\frac12\\right)\n\\end{split}\n\\tag{5.31}\\] We can read off that the solutions are \\[\n\\lambda_1 = 1, \\quad \\lambda_\\pm = -\\frac{1}{2} \\pm \\frac{1}{2}i.\n\\tag{5.32}\\] Because the magnitude of the eigenvalues \\(\\lambda_\\pm\\) are less than \\(1\\), we have that \\(\\lambda_1\\) is the dominant eigenvalue and that \\(\\lim_{t\\to\\infty}\\lambda_\\pm^t=0\\). This means that the stable age distribution is given by the eigenvector \\(\\mathbf{v}_1\\) corresponding to the eigenvalue \\(\\lambda_1=1\\). And indeed \\[\n\\begin{pmatrix}\n0 & 1/2 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 1/2 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n4 \\\\\n4 \\\\\n2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4 \\\\\n4 \\\\\n2\n\\end{pmatrix}.\n\\tag{5.33}\\] This confirms our numerical result from Eq. 5.19.\nThe convergence to this stable age distribution happens regardless of the initial age distribution.\n\n\n\n5.1.6 Exercises\n\nExercise 5.2 (* Fibonacci population) Consider a population in which individuals on average produce one offspring when they turn 1 year old and another offspring when they turn 2 years old. After that they die. Assume that there is no mortality before they turn 2 year old.\n\nFormulate the above information in terms of values for the reproduction numbers \\(b_a\\) and the survival probabilities \\(S_a\\).\nWrite down the Leslie matrix for this population.\nAssume that at \\(t=0\\) we start with 1 individual of age 0. By hand, calculate the numbers of individuals at each age at time \\(t=1,2,3,4\\) and \\(5\\).\nDraw the directed graph associated with this Leslie matrix. Is the Leslie matrix irreducible? Is it primitive? What does this tell you about the long-term behaviour of the population?\nUsing the Leslie matrix, calculate the long-term growth factor (the factor by which the total population changes from one year to the next) and the stable age distribution.\n\n\n\n\nExercise 5.3 (Semelparous population) Consider a population in which individuals die after having given birth for the first time at age 3. The life history parameters are given by the following table:\n\n\n\n\\(a\\)\n\\(b_a\\)\n\\(S_a\\)\n\n\n\n\n0\n0\n1\n\n\n1\n0\n1/2\n\n\n2\n0\n1/3\n\n\n3\n6\n0\n\n\n\n\nCalculate the fecundities and give the Leslie matrix for this population.\nAssume that at \\(t=0\\) we start with 10 individual, all of age 0. Use the Leslie matrix to calculate the numbers of individuals of ages \\(0,1,2\\) at times \\(t=1,2,3\\). What will happen in the long run? Will the population evolve towards a stable age distribution?\nDraw the graph associated with the Leslie matrix and determine whether the Leslie matrix is irreducible and primitive.\n\n\n\n\nExercise 5.4 (Eastern Screech Owl) This exercise is most suitable for you if you are willing to use a computer to find eigenvalues and eigenvectors of matrices.\nThe Eastern Screech Owl is a small owl that is found in the eastern United States and Canada. It is a cavity-nesting bird, which means that it nests in holes in trees. It is able to adapt to diverse habitats, including wooded residential neighbourhoods and parks in suburban areas. In suburban areas, these owls find a variety of nesting opportunities, such as tree cavities, nest boxes, and even abandoned buildings, which may be less available in intensively farmed rural areas or dense forests. Additionally, the suburban settings can offer a rich supply of prey, including insects, small mammals, and other small creatures, partly due to the lower prevalence of large predators.\nBelow is a life table collected for two different habitats, suburban and rural, in Texas.\n\n\n\nAge\nSuburban\n\nRural\n\n\n\n\n\n\\(a\\)\n\\(l_a\\)\n\\(b_a\\)\n\\(l_a\\)\n\\(b_a\\)\n\n\n—\n————\n———\n————\n———\n\n\n1\n0.49\n0.8\n0.30\n0.8\n\n\n2\n0.18\n1.3\n0.11\n1.1\n\n\n3\n0.10\n1.5\n0.06\n1.6\n\n\n4\n0.06\n1.6\n0.04\n1.0\n\n\n5\n0.04\n1.3\n0.02\n1.0\n\n\n6\n0.03\n1.3\n\n\n\n\n7\n0.02\n1.3\n\n\n\n\n8\n0.02\n1.3\n\n\n\n\n9\n0.01\n1.3\n\n\n\n\n10\n0.01\n1.3\n\n\n\n\n\nFor each of the two populations do the following:\n\nCalculate the reproductive number, i.e., the expected number of offspring produced by a single individual during its lifetime.\nCalculate the Leslie matrix. Note that the table gives the survival probabilities \\(l_a\\) from birth to age \\(a\\) instead of the yearly survival probabilities \\(S_a\\). The yearly survival probabilities can be calculated from the life table by \\(S_{a-1} = l_a/l_{a-1}\\).\nUse the Leslie matrix to calculate the stable age distribution and the long-term growth factor (the factor by which the total population changes from one year to the next).\nCalculate the average age in the stable age distribution as well as the average age of parents of newborns.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Age-structured population model</span>"
    ]
  },
  {
    "objectID": "age_structured.html#sec-age-continuous",
    "href": "age_structured.html#sec-age-continuous",
    "title": "5  Age-structured population model",
    "section": "5.2 Continuous time model",
    "text": "5.2 Continuous time model\nOf course in the real world, time and age are not discrete variables and the population is not structured by age classes. This was only a simplification to make the model more tractable in the case where there is a clear annual cycle of reproduction. If we want to describe a species where individuals are born throughout the year and age continuously, it is more natural to use a continuous-time model.\n\n5.2.1 Model description\nWe now describe the population by the density \\(n(t,a)\\) of individuals at age \\(a\\). The total number \\(N(t)\\) of individuals in the population is then given by the integral of \\(n(t,a)\\) over all ages. More generally, the total number of individuals in the population that are between age \\(a_1\\) and \\(a_2\\) is given by the integral of \\(n(t,a)\\) over the interval \\([a_1,a_2]\\). This is illustrated in Figure 5.4. You are familiar with the concept of density from probability theory, where continuous random variables are described by a probability density rather than a probability. You may also be familiar with the concept from physics, where the density of a material describes how the mass is distributed over space. Here, the density \\(n(t,a)\\) describes how the individuals are distributed over ages.\n\n\n\n\n\n\n\n\nFigure 5.4: A sketch of a population density. The number of individuals in an age range is given by the area under the curve.\n\n\n\n\n\nTo derive the PDE for the age-structured population density, we consider how the density changes over an infinitesimal time interval \\(\\delta t\\) due to deaths: \\[\nn(t+\\delta t, a+\\delta t) = n(t,a) - \\mu(a) n(t,a) \\delta t.\n\\tag{5.34}\\] Note how we had to take into account that over the time interval \\(\\delta t\\) the age of the individuals has increased by \\(\\delta t\\). We now Taylor-expand the left-hand side around \\(t\\) and \\(a\\): \\[\nn(t+\\delta t, a+\\delta t) = n(t,a) + \\frac{\\partial n}{\\partial t} \\delta t + \\frac{\\partial n}{\\partial a} \\delta t + \\mathcal{O}(\\delta t^2).\n\\tag{5.35}\\] Cancelling the \\(n(t,a)\\) terms on both sides, dividing by \\(\\delta t\\) and taking the limit \\(\\delta t\\to 0\\) gives us the PDE for the age-structured population density: \\[\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial n}{\\partial a} = -\\mu(a) n.\n\\tag{5.36}\\]\nThis equation is known as the McKendrick-von Foerster equation. It captures the effect of individuals ageing and dying, but it does not capture how they are born. Individuals are born with age \\(0\\). These offspring can be produced by parents of any ages, but with an age-dependent rate \\(b(a)\\). This gives \\[\nn(t,0) = \\int_0^\\infty b(a) n(t,a) \\, da.\n\\tag{5.37}\\] This is a boundary condition for the PDE. It says that the density of individuals at age \\(0\\) is given by the total rate at which offspring are produced by the individuals of all ages. This is the continuous-time version of Eq. 5.2, but note that now \\(n(t,0)\\) is a density and \\(b(a)\\) is a rate, whereas in the discrete-time model \\(N_{0,t}\\) is a number and \\(b_a\\) is a number.\n\n\n5.2.2 Stable age distribution\nWe will now solve the PDE for the age-structured population density by the method of separation of variables. We will make the Ansatz \\(n(t,a) = f(t) r(a)\\). This is a solution where the age distribution \\(r(a)\\) stays stable but the total population number varies with time according to \\(f(t)\\). You have seen this trick for finding solutions of linear, homogeneous PDEs in other modules, for example when you solved the wave equation. Substituting this Ansatz into the PDE gives \\[\nf'(t) r(a) + f(t) r'(a) = -\\mu(a) f(t) r(a).\n\\tag{5.38}\\] Dividing by \\(f(t) r(a)\\) gives \\[\n\\frac{f'(t)}{f(t)} + \\frac{r'(a)}{r(a)} = -\\mu(a).\n\\tag{5.39}\\] We now collect all terms that depend on \\(t\\) on the left-hand side and all terms that depend on \\(a\\) on the right-hand side: \\[\n\\frac{f'(t)}{f(t)} = - \\frac{r'(a)}{r(a)} - \\mu(a).\n\\tag{5.40}\\] Because the left-hand side is independent of \\(a\\) and the right-hand side is independent of \\(t\\), both sides must be equal to a constant. We introduce the separation constant \\(\\gamma\\) and write \\[\n\\frac{f'(t)}{f(t)} = \\gamma, \\quad \\frac{r'(a)}{r(a)} = -\\gamma - \\mu(a).\n\\tag{5.41}\\] These are now linear ODEs and hence easy to solve. The first ODE has the solution \\[\nf(t) = f(0) e^{\\gamma t}\n\\tag{5.42}\\] and the second ODE has the solution \\[\nr(a) = r(0) \\exp\\left(-\\int_0^a \\mu(a') \\, da'-\\gamma a\\right).\n\\tag{5.43}\\] The factor \\[\n\\exp\\left(-\\int_0^a \\mu(a') \\, da'\\right)=:l(a)\n\\tag{5.44}\\] is the probability that an individual survives up to age \\(a\\). This is the continuous-time version of Eq. 5.18. So altogether we have the population density \\[\nn(t,a) = n(0,0) l(a) e^{\\gamma (t-a)} ,\n\\tag{5.45}\\] where \\(n(0,0)=f(0)r(0)\\) is the initial density of individuals at age \\(0\\). This is the continuous-time version of Eq. 5.17.\nSo far we don’t yet know the value of the separation constant \\(\\gamma\\). This will be determined by the boundary condition. If we substitute the solution Eq. 5.45 into the boundary condition Eq. 5.37, we get \\[\nn(0,0)e^{\\gamma t} = \\int_0^\\infty b(a) n(0,0)l(a)e^{\\gamma (t-a)} \\, da.\n\\tag{5.46}\\] We can cancel the common factor \\(n(0,0)e^{\\gamma t}\\) on both sides to get the condition \\[\n1= \\int_0^\\infty b(a) l(a)e^{-\\gamma a} \\, da =: \\phi(\\gamma).\n\\tag{5.47}\\] We have introduced the shorthand notation \\(\\phi(\\gamma)\\) for the integral on the right-hand side. The condition Eq. 5.47 is the continuous-time version of the Euler-Lotka equation Eq. 5.31. It is a transcendental equation for \\(\\gamma\\), so we cannot solve it analytically for \\(\\gamma\\).\n\n\n5.2.3 Condition for extinction\nLuckily we do not need to solve the integral equation Eq. 5.47 to determine whether the population grows or goes extinct. We note that \\[\n\\phi(0)=\\int_0^\\infty b(a) l(a) \\, da=:R\n\\tag{5.48}\\] is the expected number of offspring produced by an individual during its lifetime. This quantity is known as the reproductive number. If this reproductive number is greater than \\(1\\), then the population grows exponentially. If it is less than \\(1\\), then the population goes extinct. The way to see this from the Euler-Lotka equation is to note that \\(\\phi(\\gamma)\\) is a decreasing function of \\(\\gamma\\). This means that there is a unique solution \\(\\gamma\\) to the Euler-Lotka equation Eq. 5.47 and\n\nIf \\(R &gt; 1\\), then \\(\\phi(\\gamma)=1\\) implies that \\(\\gamma &gt; 0\\) and the population grows exponentially.\nIf \\(R &lt; 1\\), then \\(\\phi(\\gamma)=1\\) implies that \\(\\gamma &lt; 0\\) and the population goes extinct.\n\nYou will notice the close analogy to the discussion of extinction in the discrete-time model in #sec-extinction-discrete.\n\n\n\n5.2.4 Exercises\n\nExercise 5.5 (* Age-independent rates) In the continuous-time age-structured population model consider the case where \\(b(a)=b\\) and \\(\\mu(a)=\\mu\\) are both constant. Repeat all steps of the analysis but simplifying the expressions at each step by using the constant values for birth and death rates. Try to do this without looking at your notes from the lecture.\n\nSolve the partial differential equation of the age-structured model by making the Ansatz \\(n(t,a)=f(t)r(a)\\) and introducing the separation constant \\(\\gamma\\).\nUse the boundary condition at \\(a=0\\) to determine the value of \\(\\gamma\\).\nGive the condition under which the population goes extinct and compare it to the condition in the exponential model from chapter 1.\n\n\n\n\nExercise 5.6 (Seasonal mortality) Consider an age-structured population model in which, in addition to an age-dependent mortality, there is also a seasonal mortality. The population is described by a function \\(n(t,a)\\) giving the density of individuals of age \\(a\\) at time \\(t\\) which satisfies the equations \\[\n\\partial_t n(t,a)+\\partial_a n(t,a)=-(\\mu(a)+m(t))\\,n(t,a),\n\\tag{5.49}\\] \\[\nn(t,0) = \\int_0^\\infty b(a) n(t,a) da.\n\\tag{5.50}\\] The birth rate \\(b(a)\\) and the mortality rates \\(\\mu(a)\\) and \\(m(t)\\) are all positive.\n\nBy substituting the Ansatz \\(n(t,a)=p(t)r(a)\\) into equation Eq. 5.49 and separating variables with a separation constant \\(\\gamma\\), derive solutions for \\(p(t)\\) and \\(r(a)\\) and hence for \\(n(t,a)\\), involving \\(\\gamma\\).\nBy substituting your solution from part (a) into equation Eq. 5.50, derive an equation for \\(\\gamma\\). Write this in the form \\(\\phi(\\gamma)=1\\) for some function \\(\\phi\\). Show that this \\(\\phi\\) is a monotonic function.\nAssume that the seasonal mortality rate \\(m(t)\\) is periodic with period \\(1\\) and denote by \\(F\\) the averaged seasonal mortality. By considering the population at the end of each season, show that the population will go extinct if \\(\\gamma &lt;F\\).\nExplain how you can use a property of the function \\(\\phi\\) to eliminate \\(\\gamma\\) from the condition for extinction. Thus finally give the condition for extinction in terms of \\(b(a), \\mu(a)\\) and \\(F\\).",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Age-structured population model</span>"
    ]
  },
  {
    "objectID": "age_structured.html#summary",
    "href": "age_structured.html#summary",
    "title": "5  Age-structured population model",
    "section": "Summary",
    "text": "Summary\nIn this chapter, we explored how age structure affects population dynamics:\n\nDiscrete-time models are appropriate when reproduction occurs in distinct breeding seasons. These models use:\n\nLeslie matrices to represent age-specific survival and reproduction\nEigenvalue analysis to determine the stable age distribution and growth rate\nThe Perron-Frobenius theorem to establish conditions for a unique dominant eigenvalue\n\nContinuous-time models are suitable when reproduction occurs continuously. These models use:\n\nThe McKendrick-von Foerster partial differential equation\nSeparation of variables to find solutions with stable age distributions\nBoundary conditions to represent reproduction\n\nKey insights from both model types:\n\nThe reproductive number (expected lifetime offspring per individual) determines population persistence\nWhen the reproductive number exceeds 1, the population grows; when less than 1, it declines\nPopulations tend toward a stable age distribution regardless of initial conditions\nThe Euler-Lotka equation determines the long-term growth rate\n\nLimitations of these models include:\n\nThey assume constant vital rates (survival and reproduction) that don’t change over time\nThey ignore density dependence, which becomes important as populations grow\nThey assume populations are well-mixed with no spatial structure\nIn real populations, demographic parameters may vary with factors beyond age\n\n\nThese age-structured models provide a foundation for understanding how demographic processes shape population dynamics, with applications ranging from conservation biology to human demography.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Age-structured population model</span>"
    ]
  },
  {
    "objectID": "age_structured.html#footnotes",
    "href": "age_structured.html#footnotes",
    "title": "5  Age-structured population model",
    "section": "",
    "text": "In the case where there are repeated eigenvalues, the general solution is just a bit more complicated. Luckily in ecology, we are rarely interested in that case, because the probability that a real ecosystem is exactly so that this special case arises is zero.↩︎",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Age-structured population model</span>"
    ]
  },
  {
    "objectID": "epidemics.html",
    "href": "epidemics.html",
    "title": "6  Epidemics",
    "section": "",
    "text": "6.1 SIR model\nMathematical epidemiology applies mathematical modelling and statistical analysis to understand the spread of infectious diseases within populations. This is an important topic for several reasons:\nBefore we get started, let us explain some terms used to describe different levels of disease prevalence and spread:\nThe SIR model is a very idealised mathematical model that is commonly used to describe the spread of infectious diseases in a population. The acronym SIR stands for Susceptible, Infected, and Recovered, which are the three main compartments of the model.\nThe SIR model was first introduced in 1927 by Kermack and McKendrick in their landmark paper “A Contribution to the Mathematical Theory of Epidemics”. The model was developed in response to the major epidemics of the early 20th century, such as the Spanish flu pandemic of 1918-1919, which highlighted the need for a quantitative understanding of the spread of infectious diseases.\nThe SIR model was one of the first mathematical models to be developed for the study of infectious disease dynamics, and it remains one of the most widely used and influential models in the field of mathematical epidemiology. The model has been used to study a wide range of infectious diseases, including measles, tuberculosis, HIV/AIDS, and COVID-19, and has been extended and adapted to address new challenges and incorporate new data sources.\nThe SIR model and its variants have played a key role in informing public health policy and practice, by providing insights into the impact of different intervention strategies, such as vaccination, quarantine, and social distancing. The model has also helped to guide the design of clinical trials and the development of new drugs and vaccines, and has contributed to our understanding of the fundamental principles of infectious disease transmission.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "epidemics.html#sec-sir",
    "href": "epidemics.html#sec-sir",
    "title": "6  Epidemics",
    "section": "",
    "text": "6.1.1 Three-compartment model\nIn the SIR model, individuals in a population are divided into three groups (or compartments): those who are susceptible to the disease (\\(S\\)), those who are infected with the disease (\\(I\\)), and those who have recovered from the disease and are now immune (\\(R\\)). The model assumes that individuals can move between these compartments over time as the disease spreads through the population.\nThe \\(R\\) compartment is also sometimes referred to as the “Removed” compartment in case where it also contains individuals that have been removed from being affected by the illness by other causes. For example in the case of a fatal disease they might have died.\nThe SIR model is based on a set of ordinary differential equations, which describe the rate of change of each compartment over time. The equations are\n\\[\\begin{split}\n\\frac{dS}{dt} &= -\\beta IS/N,\\\\\n\\frac{dI}{dt} &= \\beta IS/N -\\gamma I,\\\\\n\\frac{dR}{dt} &= \\gamma I,\n\\end{split}\n\\tag{6.1}\\]\nwhere:\n\n\\(S\\) is the number of susceptible individuals in the population\n\\(I\\) is the number of infected individuals in the population\n\\(R\\) is the number of recovered (and immune) individuals in the population\n\\(N=S+I+R\\) is the total population size\n\\(\\beta\\) is the transmission rate of the disease, which describes how easily the disease is transmitted from an infected individual to a susceptible individual\n\\(\\gamma\\) is the recovery rate of the disease, which describes how quickly infected individuals recover and become immune to the disease\n\nThe first equation describes the rate of change of the susceptible compartment over time. It states that the number of susceptible individuals decreases over time as they become infected with the disease at a rate proportional to the proportion \\(I/N\\) of infected individuals and the transmission rate \\(\\beta\\). The minus sign indicates that the number of susceptible individuals is decreasing over time.\nThe second equation describes the rate of change of the infected compartment over time. It states that the number of infected individuals increases over time at the same rate at which the susceptibles become infected, and decreases over time as infected individuals recover at a rate \\(\\gamma\\).\nThe third equation describes the rate of change of the recovered compartment over time. It states that the number of recovered individuals increases over time as infected individuals recover and become immune at the recovery rate \\(\\gamma\\).\nWe can represent the SIR model graphically by a directed graph with one node for each compartment and directed edges between the nodes to represent the flow of individuals between the compartments. This is illustrated in Figure 6.2. We have labelled the edges by the per-capita rates.\n\n\n\n\n\n\nFigure 6.1: Graphical representation of the SIR model.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "epidemics.html#condition-for-an-epidemic",
    "href": "epidemics.html#condition-for-an-epidemic",
    "title": "6  Epidemics",
    "section": "6.2 Condition for an epidemic",
    "text": "6.2 Condition for an epidemic\nLet us investigate the possibility of an epidemic. So we start with initial conditions where the number of infecteds is small and the number of susceptibles is high. There are no recovereds yet. We’ll write the initial conditions as\n\\[\nS(0)=S_0, ~~~ I(0)=I_0, ~~~R(0)=0,\n\\tag{6.2}\\] with \\(S_0\\approx N\\) and \\(I_0 &lt;&lt; N\\).\nIn order for an epidemic to start we need a positive rate of increase in the number of infecteds. Thus we need \\[\n\\left.\\frac{dI}{dt}\\right|_{t=0} = \\beta I_0S_0/N -\\gamma I_0&gt;0.\n\\tag{6.3}\\] This happens when \\[\nR_0 :=\\frac{\\beta S_0}{\\gamma N} &gt; 1.\n\\tag{6.4}\\]\nWe have introduced the basic reproduction ratio \\(R_0\\). It is a key parameter in infectious disease epidemiology that measures the average number of secondary infections that a single infectious individual will produce. It is a useful metric for understanding the potential for an infectious disease to spread through a population, because if \\(R_0\\) is greater than \\(1\\), then an epidemic can occur, as each infectious individual will produce more than one secondary infection on average, leading to a sustained increase in the number of infected individuals. If\\(R_0\\) is less than \\(1\\), then an epidemic can not occur, as each infectious individual will produce less than one secondary infection on average, leading to a decline in the number of infected individuals over time.\nThe basic reproduction ratio is also sometimes referred to as the basic reproductive number. Do not call it the basic reproductive rate because it is not a rate. There is also potential confusion due to the notation between \\(R_0\\) and \\(R(0)\\).\nThere are three ways an epidemic can start:\n\nThe infectiousness of the illness can increases until \\(\\beta &gt; \\gamma \\frac{N}{S_0}\\). This can happen for example if a new variant of the virus emerges that is more transmissible than the original strain, or if the population becomes more susceptible to the disease due to changes in behaviour or environmental factors.\nThe recovery rate drops until \\(\\gamma &lt; \\beta \\frac{S_0}{N}\\). This can happen for example if the virus mutates to become more virulent, or if the population becomes less able to recover from the disease due to changes in health status or access to healthcare.\nThe proportion of the population that is susceptible rises until \\(\\frac{S_0}{N}&gt;\\frac{\\gamma}{\\beta}\\). This can happen for example if a vaccination program is stopped or if the population is not vaccinated.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "epidemics.html#sec-unfold",
    "href": "epidemics.html#sec-unfold",
    "title": "6  Epidemics",
    "section": "6.3 How an epidemic unfolds",
    "text": "6.3 How an epidemic unfolds\nLet us think about how an epidemic unfolds, once started. The epidemic begins with an initial number of infectious individuals, and as these individuals come into contact with susceptible individuals, the number of infectious individuals increases, and the number of susceptible individuals decreases. The number of individuals in the recovered compartment also increases as more individuals recover from the infection and become immune to the disease.\nThe epidemic reaches its peak when the number of infectious individuals in the population is at its maximum. After this point, the number of infectious individuals begins to decrease, and the number of recovered individuals continues to increase. The epidemic ends when the number of infectious individuals reaches zero and the disease is no longer spreading in the population.\nAs is usual with non-linear models, a direct solution of the set of differential equations in Eq. 6.1 is only possible numerically. Such a numerical solution is displayed in Figure 6.2.\n\n\nCode\nimport numpy as np\nfrom scipy.integrate import odeint\nimport matplotlib.pyplot as plt\n\n# Total population, N.\nN = 1000\n# Initial number of infected and recovered individuals, I0 and R0.\nI0, R0 = 1, 0\n# Everyone else, S0, is susceptible to infection initially.\nS0 = N - I0 - R0\n# Contact rate, beta, and mean recovery rate, gamma, (in 1/days).\nbeta, gamma = 0.3, 0.1\n\n# A grid of time points (in days)\nt = np.linspace(0, 160, 160)\n\n# The SIR model differential equations.\ndef deriv(y, t, N, beta, gamma):\n    S, I, R = y\n    dSdt = -beta * S * I / N\n    dIdt = beta * S * I / N - gamma * I\n    dRdt = gamma * I\n    return dSdt, dIdt, dRdt\n\n# Initial conditions vector\ny0 = S0, I0, R0\n# Integrate the SIR equations over the time grid, t.\nret = odeint(deriv, y0, t, args=(N, beta, gamma))\nS, I, R = ret.T\n\n# Plot the data on three separate curves for S(t), I(t), and R(t)\nfig = plt.figure(facecolor='w')\nax = fig.add_subplot(111, facecolor='#dddddd', axisbelow=True)\nax.plot(t, S/N, 'b', alpha=0.5, lw=2, label='Susceptible')\nax.plot(t, I/N, 'r', alpha=0.5, lw=2, label='Infected')\nax.plot(t, R/N, 'g', alpha=0.5, lw=2, label='Recovered')\nax.set_xlabel('Time [days]')\nax.set_ylabel('Proportion of Population')\nax.set_ylim(0,1.1)\nax.yaxis.set_tick_params(length=0)\nax.xaxis.set_tick_params(length=0)\nax.grid(True, which='major', c='w', lw=2, ls='-')\nlegend = ax.legend()\nlegend.get_frame().set_alpha(0.5)\nfor spine in ('top', 'right', 'bottom', 'left'):\n    ax.spines[spine].set_visible(False)\nplt.title(\"SIR Model Evolution\")\nplt.show()\n\n\n\n\n\n\n\n\nFigure 6.2: Evolution of an epidemic as described by the SIR model. The graph shows the dynamics of the susceptible \\(S\\), infected \\(I\\), and recovered \\(R\\) population fractions over time. In this scenario, we start with a single infected individual in a population of 1000, with a contact rate of \\(\\beta=0.3\\) and a recovery rate of \\(\\gamma=0.1\\). The plot demonstrates how the infection spreads through the population, peaks, and eventually declines as individuals recover and gain immunity.\n\n\n\n\n\nWe however are interested in analytic insights. It turns out that it is easy to determine the shape of the trajectories in the SIR phase space.\n\n6.3.1 Trajectory in R-S plane\nFirst we will determine the relationship between the number of susceptibles and the number of recovereds, by using \\[\n\\frac{dS}{dR}=\\frac{dS/dt}{dR/dt}= -\\frac{\\beta}{\\gamma}\\frac{S}{N}.\n\\tag{6.5}\\] This is solved by \\[\nS(R) = S_0 \\exp\\left(-\\frac{\\beta}{\\gamma}\\frac{R}{N}\\right)\n\\tag{6.6}\\] This is depicted in Figure 6.3. We see in particular that the number of susceptibles decreases exponentially with the number of recovereds but never reaches zero. This means that at the time where the last infected individual recovers and the epidemic ends, there are still individuals that never caught the disease.\n\n\nCode\ndef S(R, S0, N, beta, gamma):\n    return S0 * np.exp(-beta / gamma * R / N)\n\n# R values\nRv = np.linspace(1, N, 100)\n\n# Compute S(R)\nSv = S(Rv, S0, N, beta, gamma)\n\n# Plot setup with style similar to the SIR model plot\nplt.figure(figsize=(5.5, 4), facecolor='w')\nax = plt.subplot(111, facecolor='#dddddd')\n\n# Plotting S(R) and initial conditions\nax.plot(Rv, Sv, 'b-', lw=2, label='$S(R)$')\nax.plot(R0, S0, 'ro', label='Initial condition $(R_0, S_0)$')\n\n# Adding grid, labels, title, and legend\nax.set_xlabel('Number of Recovered Individuals (R)')\nax.set_ylabel('Number of Susceptible Individuals (S)')\nax.set_title('Trajectory of the Epidemic in the R-S Plane')\nax.grid(True, which='major', c='w', lw=2, ls='--')\nlegend = ax.legend(loc='upper right')\nlegend.get_frame().set_alpha(0.5)\n\n# Adjusting spines to match the SIR model plot style\nfor spine in ('top', 'right', 'bottom', 'left'):\n    ax.spines[spine].set_visible(False)\n\n\n\n\n\n\n\n\nFigure 6.3: Shape of epidemic in R-S plane\n\n\n\n\n\n\n\n6.3.2 Size of an epidemic\nWe can describe the size of an epidemic by the proportion of the initially susceptible individuals that catches the disease in the course of the epidemic. As we saw above, this will be less than one. We will now determine this proportion.\nLet us denote the numbers at the end of the epidemic by a subscript \\(\\infty\\). We have that \\(I(\\infty)=0\\) and \\(S(\\infty)\\) is the solution to the equation \\[\n\\begin{split}\nS_\\infty&=S(R_\\infty)=S_0\\exp\\left(-\\frac{\\beta}{\\gamma N}R_\\infty\\right)\\\\\n&=S_0\\exp\\left(-\\frac{\\beta}{\\gamma N}(N-S_\\infty)\\right)\\\\\n&=S_0\\exp\\left(-\\frac{\\beta}{\\gamma}\\right)\\exp\\left(\\frac{\\beta}{\\gamma N}S_\\infty\\right).\n\\end{split}\n\\tag{6.7}\\]\nThis is a transcendental equation. It can be solved numerically. We can also get an approximate analytic solution in the case where the epidemic is large so that the fraction of the population that never gets infected is small compared to \\(\\gamma/\\beta\\), \\(S_\\infty/N&lt;&lt;\\gamma/\\beta\\). In this case we can expand the last exponential in the equation above to first order in \\(S_\\infty/N\\) to get the approximate equation \\[\nS_\\infty\\approx S_0\\exp\\left(-\\frac{\\beta}{\\gamma}\\right)\\left(1+\\frac{\\beta}{\\gamma N}S_\\infty\\right)\n\\tag{6.8}\\] This we can now easily solve for \\(S_\\infty\\) to get \\[\nS_\\infty\\approx \\frac{S_0e^{-\\beta/\\gamma}}{1-\\frac{\\beta}{\\gamma}\\frac{S_0}{N}e^{-\\beta/\\gamma}}.\n\\tag{6.9}\\] We can express this in terms of the basic reproduction ratio \\(R_0\\) as \\[\n\\frac{S_\\infty}{S_0}\\approx \\frac{1}{e^{\\beta/\\gamma}-R_0}.\n\\tag{6.10}\\]\n\n\n6.3.3 Trajectory in S-I plane\nNext we will determine how the number of infecteds changes with the number of susceptibles. This is described by the differential equation\n\\[\n\\frac{dI}{dS}=\\frac{dI/dt}{dS/dt}=\\frac{\\beta IS-\\gamma IN}{-\\beta IS}=-1+\\frac{\\gamma}{\\beta}\\frac{N}{S}\n\\tag{6.11}\\] We can easily integrate this equation: \\[\n\\int_{I_0}^{I(S)} d\\tilde{I}=\\int_{S_0}^S\\left(-1+\\frac{\\gamma N}{\\beta \\tilde{S}}\\right)d\\tilde{S}\n\\tag{6.12}\\] gives \\[\nI(S)-I_0 = -S+S_0+\\frac{\\gamma N}{\\beta}\\log\\left( \\frac{S}{S_0}\\right),\n\\tag{6.13}\\] which we can rewrite as \\[\nI(S) = N-S + \\frac{\\gamma N}{\\beta}\\log \\frac{S}{S_0},\n\\tag{6.14}\\] where we used that \\(N=S_0+I_0\\).\n\n\nCode\ndef I(S, S0, N, beta, gamma):\n    return N - S + gamma * N / beta * np.log(S / S0)\n\n# S values\nSv = np.linspace(1, N, 100)\n\n# Compute I(S)\nIv = I(Sv, S0, N, beta, gamma)\nIv[Iv &lt; 0] = 0  # Ensure I(S) is non-negative\nS_threshold = gamma / beta * N\nImax = I(S_threshold, S0, N, beta, gamma)\n\n# Plot setup with style similar to the SIR model plot\nplt.figure(figsize=(5.5, 4), facecolor='w')\nax = plt.subplot(111, facecolor='#dddddd')\n\n# Plotting I(S) and initial conditions\nax.plot(Sv, Iv, 'b-', lw=2, label='$I(S)$')\nax.plot(S0, I0, 'ro', label='Initial condition $(S_0, I_0)$')\n\n# Adding horizontal and vertical lines for Imax and S=gamma N/beta\nax.axhline(y=Imax, color='k', linestyle='--', lw=1.5, label=r'$I_{max}$')\nax.axvline(x=S_threshold, color='k', linestyle='--', lw=1.5, label=r'$S=\\gamma N/\\beta$')\n\n# Adding grid, labels, title, and legend\nax.set_xlabel('Number of Susceptible Individuals (S)')\nax.set_ylabel('Number of Infected Individuals (I)')\nax.set_title('Trajectory of the Epidemic in the S-I Plane')\nax.grid(True, which='major', c='w', lw=2, ls='--')\nlegend = ax.legend(loc='lower center')\nlegend.get_frame().set_alpha(0.5)\n\n# Adjusting spines to match the SIR model plot style\nfor spine in ('top', 'right', 'bottom', 'left'):\n    ax.spines[spine].set_visible(False)\n\n\n\n\n\n\n\n\nFigure 6.4: Shape of epidemic in S-I plane\n\n\n\n\n\nThis is depicted in Figure 6.4. It agrees with our earlier intuitive description of how an epidemic unfolds. The number of infecteds increases with the number of susceptibles until the number of susceptibles is low enough that the number of infecteds reaches its maximum. After this point, the number of infecteds begins to decrease as the number of susceptibles decreases further.\nWe can use this result to determine the number \\(I_{max}\\) of infected individuals at the peak of the epidemic.\n\n\n6.3.4 Peak of an epidemic\nKnowing the maximum number of infected individuals can help public health officials plan for the allocation of resources such as hospital beds, medical staff, and equipment. This information can be used to anticipate the surge in demand for healthcare services and to prepare for the management of large numbers of patients. It can also be used to guide the planning of interventions such as vaccinations in order to avoid over-stretching the health system at the peak of the epidemic. We will discuss that in Section 6.5.\nThe peak is where \\(dI/dS=0\\), which according to Eq. 6.11 happens at \\(S=\\gamma N/\\beta\\). Thus according to Eq. 6.14 \\[\nI_{max}=I\\left(\\frac{\\gamma}{\\beta}N\\right)\n=N-\\frac{\\gamma}{\\beta}N\\left(1-\\log\\frac{\\gamma N}{\\beta S_0}\\right)\n\\tag{6.15}\\] We can express this in terms of the basic reproduction ratio \\(R_0\\) as \\[\nI_{max}= N-\\frac{S_0}{R_0}(1+\\log R_0)\n\\tag{6.16}\\]\n\n\n6.3.5 Initial exponential growth\nAt the start of the epidemic when the number of infecteds is small and hence the number of susceptibles is close to \\(N\\), we can approximate \\[\n\\frac{dI}{dt}=\\beta I\\frac{S}{N}-\\gamma I\\approx (\\beta -\\gamma)I\n\\tag{6.17}\\] and hence \\[\nI(t)\\approx I_0e^{(\\beta -\\gamma)t}.\n\\tag{6.18}\\]\nEpidemiologists often express the speed at which an epidemic is spreading in terms of the doubling time, which is the time it takes for the number of infected individuals to double. It is an important metric for understanding the rate of spread of an infectious disease and can help public health officials anticipate the growth of an epidemic and plan for the allocation of resources such as hospital beds, medical staff, and equipment.\nFrom our initial exponential approximation for \\(I(t)\\) in Eq. 6.18, we see that the number of infecteds doubles in a time \\(t_d\\) when \\[\n2I_0 = I_0 e^{(\\beta -\\gamma)t_d},\n\\tag{6.19}\\] which gives the doubling time \\[\nt_d = \\frac{\\log 2}{\\beta-\\gamma}.\n\\tag{6.20}\\]\nWe can also get an equation for \\(R(t)\\) by using the equation for \\(S(R)\\) as follows: \\[\n\\begin{split}\n\\frac{dR}{dt}&=\\gamma I=\\gamma \\left(N-R-S\\right)\\\\\n&=\\gamma \\left(N-R-S_0\\exp\\left(-\\frac{\\beta}{\\gamma}\\frac{R}{N}\\right)\\right)\n\\end{split}\n\\tag{6.21}\\]\nAt the initial stages of the epidemic while the number of recovereds is small we can expand the exponential and keep only the first-order term to get \\[\n\\begin{split}\n\\frac{dR}{dt}&\n\\approx \\gamma \\left(N-R-S_0\\left(1-\\frac{\\beta}{\\gamma}\\frac{R}{N}\\right)\\right)\\\\\n&=\\gamma I_0 - \\gamma (1 - R_0)R\n\\end{split}\n\\tag{6.22}\\] where we used that \\(N-S_0=I_0\\). Again we must not be confused by the notation: \\(R_0\\) is the basic reproduction number, not the number of recovered at time \\(0\\). We have a linear differential equation for \\(R(t)\\) that can be solved to give \\[\nR(t) = \\frac{I_0}{R_0-1} \\left(e^{(R_0-1)\\gamma t}-1\\right).\n\\tag{6.23}\\]\n\n\nCode\nimport numpy as np\nfrom scipy.integrate import odeint\nimport matplotlib.pyplot as plt\n\n# Total population, N.\nN = 1000\n# Initial number of infected and recovered individuals, I0 and R0.\nI0, R0 = 1, 0\n# Everyone else, S0, is susceptible to infection initially.\nS0 = N - I0 - R0\n# Contact rate, beta, and mean recovery rate, gamma, (in 1/days).\nbeta, gamma = 0.3, 0.1\n# Basic reproduction number\nbrn = beta*S0/gamma/N\n\n# A grid of time points (in days)\nt = np.linspace(0, 40, 160)\n\n# The SIR model differential equations.\ndef deriv(y, t, N, beta, gamma):\n    S, I, R = y\n    dSdt = -beta * S * I / N\n    dIdt = beta * S * I / N - gamma * I\n    dRdt = gamma * I\n    return dSdt, dIdt, dRdt\n\n# Initial conditions vector\ny0 = S0, I0, R0\n# Integrate the SIR equations over the time grid, t.\nret = odeint(deriv, y0, t, args=(N, beta, gamma))\nS, I, R = ret.T\n\n# Plot the data on three separate curves for S(t), I(t), and R(t)\nfig = plt.figure(facecolor='w')\nax = fig.add_subplot(111, facecolor='#dddddd', axisbelow=True)\nax.plot(t, I/N, 'r', alpha=0.5, lw=2, label='Infected')\nax.plot(t, R/N, 'g', alpha=0.5, lw=2, label='Recovered')\nax.set_xlabel('Time [days]')\nax.set_ylabel('Proportion of Population')\nax.set_ylim(0,0.4)\nax.yaxis.set_tick_params(length=0)\nax.xaxis.set_tick_params(length=0)\nax.grid(True, which='major', c='w', lw=2, ls='-')\nlegend = ax.legend()\nlegend.get_frame().set_alpha(0.5)\nfor spine in ('top', 'right', 'bottom', 'left'):\n    ax.spines[spine].set_visible(False)\nplt.title(\"SIR Model Evolution\")\n\n# Now add approximate results for beginning of epidemic\nIi = I0*np.exp((beta - gamma)*t)\nax.plot(t, Ii/N, 'r:', alpha=0.5, lw=4)\nRi = I0/(brn-1)*(np.exp((brn-1)*gamma*t)-1)\nax.plot(t, Ri/N, 'g:', alpha=0.5, lw=4)\n\nplt.show()\n\n\n\n\n\n\n\n\nFigure 6.5: Exponential approximation of initial growth of an epidemic. The solid lines are the numeric solutions and the dotted lines are the exponential approximations.\n\n\n\n\n\nFigure 6.5 compares the approximate expressions Eq. 6.18 and Eq. 6.23 that we have derived above with the numerical solution of the SIR model for the choice of parameters from Figure 6.2. We see that the exponential approximation is very good for the initial stages of the epidemic.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "epidemics.html#assumptions-made-by-sir-model",
    "href": "epidemics.html#assumptions-made-by-sir-model",
    "title": "6  Epidemics",
    "section": "6.4 Assumptions made by SIR model",
    "text": "6.4 Assumptions made by SIR model\nLike all models, the SIR model makes a number of simplifying assumptions to make the calculations tractable and the results interpretable. It is important to note that therefore an SIR model will not capture all of the nuances of disease transmission in a real population. The assumptions made by the SIR model include:\n\nFixed population: The SIR model assumes that the total population size \\(N=S+I+R\\) is fixed and does not change over time. We can see that by observing that \\[\n\\frac{dN}{dt}=\\frac{dS}{dt}+\\frac{dI}{dt}+\\frac{dR}{dt}=0.\n\\tag{6.24}\\] So there is no population dynamics such as birth or natural death (death from the illness itself can be included by viewing the \\(R\\) compartment as the “removed” compartment) or immigration or emigration. Neglecting population dynamics is fine if the spread of the disease happens much faster than the population dynamics.\nWell-mixed population: The SIR model assumes that the population is well-mixed, meaning that all individuals have the same probability of coming into contact with one another, regardless of their location or social network. That is why the total rate of infection is simply proportional to both \\(S\\) and \\(I\\), which is also known as the mass-action dynamics, a concept taken over from the modelling of chemical reactions.\nNo vaccinations: The SIR model assumes that there are no vaccinations available for the disease, and that individuals can only become immune to the disease by recovering from the infection.\nNo incubation period: The SIR model assumes that there is no incubation period, which means that individuals move directly from the susceptible compartment to the infectious compartment once they become infected. This assumption is often referred to as the “instantaneous transmission” assumption.\nHowever, in reality, many infectious diseases have an incubation period, during which the person is infected but not yet infectious to others. We will later discuss an extension of the SIR model called the SEIR model in which a new compartment is added, called the exposed (E) compartment. The exposed compartment represents individuals who have been infected but are not yet infectious.\nConstant transmission and recovery rates: The SIR model assumes that the transmission rate \\(\\beta\\) and the recovery rate \\(\\gamma\\) remain constant over time. Constant \\(\\beta\\) means that the probability of an infected individual transmitting the disease to a susceptible individual is the same at any point during the epidemic as well as at any point during an individual’s illness. Similarly, constant \\(\\gamma\\) means that the probability of and infected individual recovering from the illness is the same at any time.\nIn reality, the transmission rate and recovery rate of an infectious disease can vary over time due to factors such as changes in behavior and public health interventions, or evolution of the virus.\nNo loss of immunity: The SIR model assumes that individuals who recover from the disease become permanently immune to the disease and do not lose their immunity over time. This means that individuals who have recovered from the disease cannot become re-infected. We will however later make modifications of the model that allow for loss of immunity.\nNo age structure: The SIR model assumes that the population is homogeneous, meaning that all individuals have the same susceptibility, infectiousness, and recovery rates. This means that the model does not take into account the age structure of the population, which can affect disease transmission.\nNo spatial structure: The SIR model does not model how the disease spreads spatially. We will however later introduce spatial structure and model the movement of infected individuals so that we can study how the disease spreads through space.\n\nEven though the assumptions made by the SIR model may not be true in the real world, the model still provides a useful framework for understanding the spread of infectious diseases and how different interventions can affect the course of an outbreak.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "epidemics.html#sec-vaccinations",
    "href": "epidemics.html#sec-vaccinations",
    "title": "6  Epidemics",
    "section": "6.5 Effect of vaccination",
    "text": "6.5 Effect of vaccination\nVaccination is a way to move individuals directly from the S compartment to the R compartment. This is illustrated in Figure 6.6 .\n\n\n\n\n\n\nFigure 6.6: Graphical representation of the SIR model with vaccination.\n\n\n\nThe extra flow from S to R adds a negative term to the equation for \\(dS/dt\\) and a positive term to the equation for \\(dR/dt\\). The equations become \\[\\begin{split}\n\\frac{dS}{dt} &= -\\beta IS/N - \\nu S,\\\\\n\\frac{dI}{dt} &= \\beta IS/N -\\gamma I,\\\\\n\\frac{dR}{dt} &= \\gamma I + \\nu S,\n\\end{split}\n\\tag{6.25}\\]\nwhere \\(\\nu\\) is the per-capita vaccination rate.\nThe modified model still has the feature that the total population size is constant, \\(dN/dt=0\\). This is because the vaccinated individuals simply move from the S compartment to the R compartment and stay part of the total population.\nAlso the expression for the basic reproduction number \\(R_0\\) is the same as before: \\(R_0=\\beta S_0/\\gamma N\\). The condition for an epidemic to start is also the same: \\(R_0&gt;1\\). However, if a vaccination program has already been in place before the start of an epidemic, the number \\(S_0\\) of susceptibles is reduced and hence the basic reproduction number is reduced. If the proportion of unvaccinated individuals in the population \\(S_0/N\\) is less than \\(\\gamma/\\beta\\), then the basic reproduction number is below 1 and the epidemic will not start. Said differently, one needs to only vaccinate a proportion \\(1-\\gamma/\\beta\\) of the population to prevent an epidemic from starting.\nBut even a vaccination program that does not prevent an epidemic from starting can have a large effect on the size of the epidemic. This is because the number of susceptibles is reduced and hence the number of infecteds at the peak of the epidemic is reduced. To understand this in detail we will repeat the analysis from sections Section 6.3.3 and Section 6.3.4 but with the modified equations Eq. 6.25.\nWe now have \\[\n\\frac{dI}{dS}=\\frac{\\beta IS-\\gamma IN}{-\\beta IS-\\nu S}\n=\\frac{\\beta-\\gamma N/S}{-\\beta-\\nu N/I}.\n\\tag{6.26}\\] This is easily solved by separation of variables: \\[\n\\begin{split}\n\\int_{I_0}^{I(S)}\\left(-\\beta-\\frac{\\nu N}{\\tilde{I}}\\right) d\\tilde{I}&=\\int_{S_0}^S\\left(\\beta-\\frac{\\gamma N}{\\tilde{S}}\\right)d\\tilde{S}.\n\\end{split}\n\\tag{6.27}\\] These integrals are easy to perform, and we get \\[\nI(S)+ \\frac{\\nu N}{\\beta}\\log \\frac{I(S)}{I_0} = N - S + \\frac{\\gamma N}{\\beta}\\log \\frac{S}{S_0} .\n\\tag{6.28}\\]\nAs before, the peak of the epidemic is where \\(dI/dS=0\\), which still happens at \\(S=\\gamma N/\\beta\\), as in the case without vaccination, because vaccination did not affect the equation for \\(dI/dt\\). Thus we again get the number of infecteds at the peak of the epidemic as \\(I(\\gamma N/\\beta)\\). Thus \\[\nI_{max}+ \\frac{\\nu N}{\\beta}\\log \\frac{I_{max}}{I_0} = N - \\frac{\\gamma N}{\\beta}\\left(1-\\log \\frac{\\gamma N}{\\beta S_0}\\right)=I_{max}(\\nu=0),\n\\tag{6.29}\\] where we have recognised the right-hand side as the expression for the peak of the epidemic in the absence of vaccinations. We can see that the number of infecteds at the peak of the epidemic is reduced by the vaccination rate \\(\\nu\\).",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "epidemics.html#sec-loi",
    "href": "epidemics.html#sec-loi",
    "title": "6  Epidemics",
    "section": "6.6 Effect of loss of immunity",
    "text": "6.6 Effect of loss of immunity\nUnfortunately, immunity to many infectious diseases is not permanent, and individuals who have recovered from the disease can lose their immunity over time. This means that individuals who have recovered from the disease can become susceptible to the disease again and can be re-infected. This is illustrated in Figure 6.7 where we have added a flow from the R compartment back to the S compartment with a per-capita rate of \\(\\mu\\).\n\n\n\n\n\n\nFigure 6.7: Graphical representation of the SIR model with loss of immunity.\n\n\n\nThe equations for the SIR model with loss of immunity are \\[\\begin{split}\n\\frac{dS}{dt} &= -\\beta IS/N + \\mu R,\\\\\n\\frac{dI}{dt} &= \\beta IS/N -\\gamma I,\\\\\n\\frac{dR}{dt} &= \\gamma I - \\mu R.\n\\end{split}\n\\tag{6.30}\\]\nWe will now look at the steady states of the SIR model with loss of immunity. There is of course the disease-free state where the number of infecteds is \\(I^*=0\\) and everyone has lost their immunity, so \\(R^*=0\\) and \\(S^*=N\\). But now there is also a new steady state where the number of infecteds is non-zero and the number of recovereds is non-zero. We can find this steady state by setting the time derivatives in Eq. 6.30 to zero. From \\(dR/dt=0\\) we get \\[\nR^* = \\frac{\\gamma}{\\mu}I^*.\n\\tag{6.31}\\] From \\(dI/dt=0\\) we get \\[\nS^* = \\frac{\\gamma}{\\beta}N.\n\\tag{6.32}\\] From \\(N=S^*+I^*+R^*\\) we get \\[\nI^* = N\\frac{1-\\frac{\\gamma}{\\beta}}{1+\\frac{\\gamma}{\\mu}}.\n\\tag{6.33}\\] Substituting this back into Eq. 6.31 gives \\[\nR^* = \\frac{\\gamma}{\\mu}I^* = \\frac{\\gamma N}{\\mu}\\frac{1-\\frac{\\gamma}{\\beta}}{1+\\frac{\\gamma}{\\mu}}=\nN\\frac{1-\\frac{\\gamma}{\\beta}}{1+\\frac{\\mu}{\\gamma}}.\n\\tag{6.34}\\] $(S,I^,R*) is the endemic steady state of the SIR model with loss of immunity.\nWe now want to determine whether this endemic state is stable or not. We will do this by linearising the equations Eq. 6.30 around the endemic steady state. We will then determine the eigenvalues of the Jacobian matrix at the endemic steady state. If all eigenvalues have negative real parts, the endemic steady state is stable. If at least one eigenvalue has a positive real part, the endemic steady state is unstable.\nWe choose to view the SIR model with loss of immunity as a two-dimensional model for the variables \\(I\\) and \\(R\\). We can then write the equations Eq. 6.30 as \\[\\begin{split}\n\\frac{dI}{dt}&=\\beta \\frac{I(N-I-R)}{N}-\\gamma I,\\\\\n\\frac{dR}{dt}&=\\gamma I-\\mu R.\n\\end{split}\n\\tag{6.35}\\] We now write \\(I(t)=I^*+i(t)\\) and \\(R(t)=R^*+r(t)\\) where \\(i(t)\\) and \\(r(t)\\) are small perturbations around the endemic steady state. We then linearise the equations Eq. 6.35 around the endemic steady state by keeping only terms linear in \\(i(t)\\) and \\(r(t)\\). We get \\[\\begin{split}\n\\frac{di(t)}{dt}&=\\frac{\\beta}{N} \\left(N-2I^*-R^*\\right)i(t)-\\gamma\\, i(t)\n-\\frac{\\beta I^*}{N}r(t),\\\\\n\\frac{dr(t)}{dt}&=\\gamma\\, i(t)-\\mu\\, r(t).\n\\end{split}\n\\tag{6.36}\\] We solve this by making the Ansatz \\(i(t)=v_1e^{\\lambda t}\\) and \\(r(t)=v_2e^{\\lambda t}\\). Substituting this into Eq. 6.36 and dividing by \\(e^{\\lambda t}\\) gives \\[\n\\begin{split}\n\\lambda v_1&=\\frac{\\beta}{N} \\left(N-2I^*-R^*\\right)v_1-\\gamma v_1\n-\\frac{\\beta I^*}{N}v_2,\\\\\n\\lambda v_2&=\\gamma v_1-\\mu v_2.\n\\end{split}\n\\tag{6.37}\\] We can write this as a matrix equation \\[\n\\lambda\\begin{pmatrix}v_1\\\\v_2\\end{pmatrix} = A\\begin{pmatrix}v_1\\\\v_2\\end{pmatrix},\n\\tag{6.38}\\] where \\[\nA=\\begin{pmatrix}\n\\frac{\\beta}{N} \\left(N-2I^*-R^*\\right)-\\gamma & -\\frac{\\beta I^*}{N}\\\\\n\\gamma & -\\mu\n\\end{pmatrix}.\n\\tag{6.39}\\]\nWhen we evaluate this Jacobian matrix \\(A\\) at the disease-free state we get \\[\nA(0,0)=\\begin{pmatrix}\n\\beta-\\gamma & 0\\\\\n\\gamma & -\\mu\n\\end{pmatrix}.\n\\tag{6.40}\\] The eigenvalues of this matrix are \\(\\lambda_1=\\beta-\\gamma\\) and \\(\\lambda_2=-\\mu\\). If \\(\\beta&gt;\\gamma\\) then one of the eigenvalues is positive and one negative, meaning that the disease-free steady state is unstable. If \\(\\beta&lt;\\gamma\\) then both eigenvalues are negative, meaning that the disease-free steady state is stable.\nWhen we evaluate the Jacobian matrix \\(A\\) at the endemic steady state we can use the relation \\(\\beta(N-I^*-R^*)/N-\\gamma=0\\) to get \\[\nA(I^*,R^*)=\\begin{pmatrix}\n-\\frac{\\beta I^*}{N} & -\\frac{\\beta I^*}{N}\\\\\n\\gamma & -\\mu\n\\end{pmatrix}.\n\\tag{6.41}\\] This time we can not easily read off the eigenvalues, so we calculate the trace and the determinant: \\[\n\\begin{split}\n\\text{Tr}(A)&=-\\frac{\\beta I^*}{N}-\\mu,\\\\\n\\text{Det}(A)&=\\frac{\\beta I^*}{N}(\\mu+\\gamma).\n\\end{split}\n\\tag{6.42}\\] We see that the trace is negative and the determinant is positive, meaning that both eigenvalues have negative real parts and the endemic steady state is stable.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "epidemics.html#exercises",
    "href": "epidemics.html#exercises",
    "title": "6  Epidemics",
    "section": "6.7 Exercises",
    "text": "6.7 Exercises\n\n* SIR with vaccination and loss of immunity\n\nExercise 6.1 In the lectures we studied the SIR model with vaccination rate \\(\\nu\\) and the SIR model with loss of immunity at a rate \\(\\mu\\). Now consider the SIR model with both vaccination and loss of immunity.\n\nWrite down the differential equations for the numbers of susceptibles \\(S\\), infecteds \\(I\\) and recovereds \\(R\\).\nFind the disease-free steady state.\nFind the endemic steady state and give the condition on the parameters needed for its existence.\nNow view this model as a two-dimensional model for the variables \\(I\\) and \\(R\\). Determine the Jacobian matrix \\(A\\) for this model.\nEvaluate \\(A\\) at the disease-free steady state and use this to classify this fixed point.\nEvaluate \\(A\\) at the endemic steady state and use this to classify this fixed point.\n\nYou will want to compare your results to the results from the lecture and make sure that they make sense.\n\n\n\n\no SIR with initial immunity\n\nExercise 6.2 In Section 6.3 we studied the dynamic of an epidemic under the assumption that initially there are no individuals that are already removed from the epidemic because we assumed that \\(R(0)=0\\). That means that there were no individuals that are immune to the disease. This assumption was not necessary. In this exercise you should generalise all derivations in Section 6.3 to the case where \\(R(0)&gt;0\\).\n\n\n\n\nSIR with recrudescence\n\nExercise 6.3 Imagine a disease that, even after an individual has recovered from it, stays in the body in a dormant state and can be reactivated. Model this as a modification of the SIR model where recovereds can become infected again at a per-capita rate \\(\\delta\\).\n\nDetermine the number of infecteds in the endemic state.\nIs the endemic state stable for all positive values of the parameters?\n\n\n\n\n\nSIR model with reinfections\n\nExercise 6.4 In Section 6.6 we studied the SIR model where recovered individuals lose their immunity at a per-capita rate \\(\\mu\\) so that they can then become infected again at a per-capita rate \\(\\beta I/N\\). The question was raised whether the same effect could be achieved by direct reinfections, i.e., a flow from the \\(R\\) compartment directly into the \\(I\\) compartment at a per-capita rate \\(\\mu\\beta I/N\\). Settle this question by determining the number of infecteds in the steady state for the SIR model with direct reinfections and compare it to the corresponding result from Eq. 6.33.\n\n\n\n\nSex-structured SIR model\n\nExercise 6.5 In a mathematical model for a certain venereal disease the male population is divided into susceptibles \\(S\\), infectives \\(I\\) and removeds \\(R\\). The female population is similarly divided; the three groups being denoted \\(S'\\), \\(I'\\) and \\(R'\\) (note that we use the prime to distinguish between male and female, not to indicate differentiation). The equations are \\[\\begin{split}\n\\frac{dS}{dt}&=-rSI',\\hspace{.2in}\\frac{dI}{dt}=rSI'-aI,\\hspace{.2in}\n\\frac{dR}{dt}=aI,\\\\\n\\frac{dS'}{dt}&=-r'S'I,\\hspace{.2in}\\frac{dI'}{dt}=r'S'I-a'I',\\hspace{.2in}\n\\frac{dR'}{dt}=a'I'\n\\end{split} \\tag{6.43}\\] where \\(r\\), \\(r'\\) and \\(a\\), \\(a'\\) are positive constants. The equations are with initial conditions \\(S(0)=S_0\\), \\(I(0)=I_0\\), \\(S'(0)=S'_0\\), \\(I'(0)=I'_0\\), \\(R(0)=R'(0)=0\\). The total male population is \\(N=S+I+R\\) and the total female population \\(N'=S'+I'+R'\\).\n\nShow that \\(N\\) and \\(N'\\) are both constant.\nShow that \\(S(t)=S_0\\exp\\left(-\\frac{r}{a'}R'(t)\\right)\\) and obtain another similar equation for \\(S'\\).\nAssuming that \\(I(\\infty)=I'(\\infty)=0\\) show that \\(S(\\infty)\\) and \\(S'(\\infty)\\) are found by solving simultaneously the equations \\[\n\\begin{split}\nS(\\infty)&=S_0\\exp\\left(-\\frac{r}{a'}(N'-S'(\\infty))\\right),\\\\\nS'(\\infty)&=S'_0\\exp\\left(-\\frac{r'}{a}(N-S(\\infty))\\right).\n\\end{split}\n\\tag{6.44}\\]",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Epidemics</span>"
    ]
  },
  {
    "objectID": "spatial.html",
    "href": "spatial.html",
    "title": "7  Spatially-structured populations",
    "section": "",
    "text": "7.1 Derivation of PDE\nWe now want to keep track of how individuals are distributed over space. So instead of describing a population by its total number of individuals \\(N(t)\\) we describe it by a population density \\(u(x,t)\\), where \\(u(x,t)dx\\) is the number of individuals in the interval \\([x,x+dx]\\) at time \\(t\\). We can recover the total number of individuals by integrating the density over the entire spatial domain.\nIn the non-spatial case we described the time evolution of the population by the equation \\[\n\\frac{dN}{dt} = f(N),\n\\tag{7.1}\\] where \\(f(N)\\) is the net growth rate that encodes the difference between birth and death rates for the population as a whole. In the spatial case we have to consider the net growth rate of the population in a small interval \\([x,x+dx]\\). This is again given by a function \\(f\\) that encodes the births and deaths, but now we also have movement of individuals into or out of the interval. We write the rate of change of the number of individuals in the interval as \\[\n\\begin{split}\n\\frac{\\partial}{\\partial t}\\int_{x_0}^{x_0+\\Delta x}u(x,t)dx =\n&\\int_{x_0}^{x_0+\\Delta x}f(u(x,t),x)dx \\\\\n&+J(x_0)-J(x_0+\\Delta x).\n\\end{split}\n\\tag{7.2}\\] The flux \\(J(x)\\) is defined as the net rate at which individuals move through point \\(x\\) from left to right. If more individuals move from right to left than from left to right, the flux is negative. We have indicated explicitly that \\(f\\) can depend on both the population density \\(u\\) at \\(x\\) as well as the position \\(x\\) itself. This is because the birth and death rates can depend on the local environment, for example the availability of resources or the presence of predators. The flux \\(J\\) can also depend on the local population density and the position. We did not indicate this explicitly to simplify the notation.\nWe now use the integral mean value theorem that states that for a continuous function \\(g(x)\\) the integral over \\(g(x)\\) over an interval \\([a,b]\\) is equal to \\(g(\\xi)(b-a)\\) for some \\(\\xi\\in[a,b]\\). We apply this to the integrals in Eq. 7.2 to get \\[\n\\partial_t u(\\xi_1,t)\\Delta x = f(u(\\xi_2,t),\\xi_2)\\Delta x +J(x_0)-J(x_0+\\Delta x)\n\\tag{7.3}\\] for some \\(\\xi_1,\\xi_2\\in[x_0,x_0+\\Delta x]\\). We now divide both sides by \\(\\Delta x\\), \\[\n\\partial_t u(\\xi_1,t) = f(u(\\xi_2,t),\\xi_2) +\\frac{J(x_0)-J(x_0+\\Delta x)}{\\Delta x}\n\\tag{7.4}\\] and take the limit \\(\\Delta x\\to 0\\), where \\(\\xi_1\\to x\\) and \\(\\xi_2\\to x\\) and the difference quotient becomes the derivative, to get \\[\n\\partial_t u(x,t) = f(u(x,t),x)-\\partial_x J(x).\n\\tag{7.5}\\]\nAs discussed above, the flux \\(J\\) can depend on \\(x\\) both directly and through the population density \\(u(x,t)\\). An important example is the case where the flux is proportional to the gradient of the population density, \\[\nJ(x) = -D\\partial_x u(x),\n\\tag{7.6}\\] where \\(D\\) is the diffusion coefficient. This models random motion of the individuals. Each individual is equally likely to move right or left, but if there are more individuals on the left and less on the right, then the result is a net movement to the right. That is why the flux has the opposite sign of the gradient of the density.\nThis random motion gives us the reaction-diffusion equation \\[\n\\partial_t u=f(u)+D\\,\\partial_x^2 u.\n\\tag{7.7}\\] If there is no local population dynamics, the equation simplifies to the diffusion equation, also known as the heat equation. The diffusion term has the effect of smoothing out spatial inhomogeneities in the population density. Therefore the heat equation by itself is rather boring. However, as we will see later, the reaction term in combination with the diffusion term can lead to the formation of spatial patterns, such as travelling waves or stationary patterns.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Spatially-structured populations</span>"
    ]
  },
  {
    "objectID": "spatial.html#fishing-model-with-diffusion",
    "href": "spatial.html#fishing-model-with-diffusion",
    "title": "7  Spatially-structured populations",
    "section": "7.2 Fishing model with diffusion",
    "text": "7.2 Fishing model with diffusion\nWe now consider a model for a population of fish that is subject to fishing and that moves around randomly. We want to model a marine protected area where fishing is limited to avoid a collapse of the fish population. Figure 7.1 shows the spatial setup. The \\(x\\)-axis runs perpendicular to the shore, which is at \\(x=0\\). A marine protected area runs out up to a distance \\(L\\) from the shore. We assume that the marine protected area has infinite extension in the \\(y\\)-direction, so that we can ignore the \\(y\\)-coordinate and model the fish population as a function of \\(x\\) only.\nBeyond \\(x=L\\) there is no management of the fishing activity. We assume that the fishers are so efficient that they catch all fish that venture outside the protected area. So we set \\(u(x,t)=0\\) for \\(x\\geq L\\). This is of course an idealisation, but it allows us to focus on the dynamics within the protected area.\n\n\n\n\n\n\nFigure 7.1: Sketch of the marine protected area\n\n\n\nWe assume that in the absence of fishing the population has a logistic growth rate. The population density \\(u(x,t)\\) satisfies the equation \\[\n\\partial_t u = r u \\left(1-\\frac{u}{K}\\right) - E u + D \\partial_x^2 u,\n\\tag{7.8}\\] where \\(r\\) is the intrinsic growth rate, \\(K\\) is the carrying capacity, \\(E\\) is the fishing rate and \\(D\\) is the diffusion coefficient. The first term on the right-hand side describes the logistic growth, the second term the fishing and the third term the random motion of the fish.\nIn the protected area, the fishing rate \\(E\\) must certainly be below the intrinsic growth rate \\(r\\), otherwise the population is guaranteed to die out. However we must also take into account that some fish will be lost when they randomly move out of the protected area and are then fished immediately. We expect this extra loss to be proportionally larger when the protected area is smaller. So when the marine protected area is planned, there will be a trade-off between the width \\(L\\) of the protected area and the allowed rate of fishing \\(E\\). Our aim is to describe this trade-off precisely by finding the condition on \\(E\\) and \\(L\\) such that the population does not collapse.\nTo achieve our aim, we will need to solve the PDE. But before solving a PDE we always need to be clear about the boundary conditions on the solution. We have already discussed that we assume that \\(u(x,t)=0\\) for \\(x\\geq L\\), i.e., we have a Dirichlet boundary condition at \\(x=L\\). At \\(x=0\\) we impose a no-flux boundary condition, which means that there are no fish moving from the sea onto the shore or the other way around. The no-flux boundary condition is the Neumann boundary condition \\(\\partial_x u(0,t) = 0\\).\nThe PDE in Eq. 7.62 is a non-linear PDE, so we cannot solve it analytically in general. However, we can still make progress by realising that before the population goes extinct, it will get small. We can then linearise the PDE around the extinction state \\(u=0\\) and solve the linearised equation. If the extinction steady state is linearly unstable, then the population will not go extinct.\nLinearising the PDE Eq. 7.62 around the extinction state \\(u=0\\) means that we neglect the term \\(u^2\\) in the logistic growth term. We then have the linearised equation \\[\n\\partial_t u = (r - E)u + D \\partial_x^2 u.\n\\tag{7.9}\\] We can now solve this linear PDE with the method of separation of variables. We make the Ansatz \\(u(x,t) = X(x)T(t)\\) and plug this into Eq. 7.9. We get \\[\nXT'=(r-E)XT+DX''T\n\\tag{7.10}\\] and after dividing by \\(XT\\) we get \\[\n\\frac{T'}{T} = r-E + D \\frac{X''}{X}.\n\\tag{7.11}\\] The left-hand side depends only on \\(t\\) and the right-hand side only on \\(x\\). Therefore both sides must be equal to a constant, which we call \\(\\gamma\\). We then have the two ODEs \\[\nT' = \\gamma T, ~~~ X'' = \\frac{\\gamma-r+E}{D}X =-\\rho^2 X,\n\\tag{7.12}\\] where, in order to save writing, we have introduced \\[\n\\rho^2 = (r-E-\\gamma)/D.\n\\tag{7.13}\\] The solution of the time ODE is \\[\nT(t) = T(0)e^{\\gamma t}\n\\tag{7.14}\\] and the solution of the spatial ODE is \\[\nX(x) = A \\cos(\\rho x) + B \\sin(\\rho x),\n\\tag{7.15}\\] where \\(A\\) and \\(B\\) are constants to be determined by the boundary conditions.\nImposing the no-flux boundary condition \\(\\partial_xu(0,t)\\) gives \\[\nX'(0) =-A\\rho\\sin(\\rho 0)+B\\rho\\cos(\\rho 0)=B\\rho= 0.\n\\tag{7.16}\\] So either \\(\\rho=0\\) or \\(B=0\\). The case \\(\\rho=0\\) gives the trivial solution \\(X(x)=A\\), which is not interesting. So we take \\(B=0\\) and get \\(X(x) = A\\cos(\\rho x)\\).\nThe Dirichlet boundary condition at \\(x=L\\) gives \\(X(L) = A\\cos(\\rho L) = 0\\). So either \\(A=0\\) or \\(\\cos(\\rho L) = 0\\). The former gives rise to the zero solution, so we want the latter, which requires \\(\\rho L\\) to be an odd multiple of \\(\\pi/2\\), i.e., \\[\n\\rho=\\rho_n = \\frac{(2n+1)\\pi}{2L}\n\\tag{7.17}\\] for \\(n=0,1,2,...\\). To each of these \\(\\rho_n\\) there corresponds, according to Eq. 7.13, a \\[\n\\gamma_n = r-E-D\\rho_n^2\n\\tag{7.18}\\] and a solution \\[\nu_n(x,t) = X_n(x)T_n(t) = A_ne^{\\gamma_n t}\\cos(\\rho_n x)\n\\tag{7.19}\\] The general solution is then a linear combination of these solutions, \\[\nu(x,t) = \\sum_{n=0}^\\infty A_ne^{\\gamma_n t}\\cos(\\rho_n x).\n\\tag{7.20}\\]\nThe condition for the population not to go extinct is that the extinction steady state is linearly unstable. This means that there is at least one \\(\\gamma_n\\) with positive real part. We see from Eq. 7.18 that \\(\\gamma_n\\) decreases with \\(n\\). So \\(\\gamma_0\\) is the largest. So the condition for the population not to go extinct is that \\(\\gamma_0\\) is positive. This gives the condition \\[\n\\gamma_0=r-E-D\\rho_0^2=r-E-\\frac{D\\pi^2}{4L^2}&gt;0.\n\\tag{7.21}\\] We can now solve this inequality for \\(L\\) to get the condition on the width of the marine protected area that ensures the population does not collapse. \\[\nL&gt;\\frac{\\pi}{2}\\sqrt{\\frac{D}{r-E}}.\n\\tag{7.22}\\] Alternatively we can solve the inequality for \\(E\\) to get the condition on the fishing rate that ensures the population does not collapse. \\[\nE&lt;r-\\frac{D\\pi^2}{4L^2}.\n\\tag{7.23}\\] This can now be used to inform policy decisions on the width of the marine protected area and the allowed fishing rate.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Spatially-structured populations</span>"
    ]
  },
  {
    "objectID": "spatial.html#invasion-waves-in-sir-model",
    "href": "spatial.html#invasion-waves-in-sir-model",
    "title": "7  Spatially-structured populations",
    "section": "7.3 Invasion waves in SIR model",
    "text": "7.3 Invasion waves in SIR model\nWe now want to use our spatial modelling skills to study the spread of an infectious disease through space. For concreteness, think of a situation where rabies has infected foxes in Dover and we want to get an idea of how soon we will have rabid foxes in York. We model the fox population by the SIR model, where \\(S(x,t)\\) is the density of susceptible foxes, \\(I(x,t)\\) is the density of infected foxes and \\(R(x,t)\\) is the density of removed foxes (which for rabies unfortunately means dead foxes). So where in Section 6.1 we had ordinary differential equations for the total number of susceptible, infected and removed foxes, we now have partial differential equations for the densities of susceptible, infected and removed foxes in space.\nWhile foxes are usually very territorial and stay in their own territory, infected foxes become a bit insane and move around randomly. This is modelled by a diffusion term in the equation for the infected foxes. The equations are \\[\\begin{split}\n\\partial_t S&=-\\beta \\frac{SI}{N},\\\\\n\\partial_t I&=\\beta \\frac{SI}{N}-\\gamma I+D\\partial_x^2I,\\\\\n\\partial_t R&=\\gamma I,\n\\end{split} \\tag{7.24}\\] where \\(N=S+I+R\\) is the total fox population density, \\(\\beta\\) is the infection rate, \\(\\gamma\\) is the recovery rate and \\(D\\) is the diffusion coefficient. For simplicity we study the movement in the \\(x\\) direction only. The above equations are valid for all \\(x\\). We will later concentrate on the equations for \\(I\\) and \\(S\\) only, as \\(R\\) can then be calculated from \\(N=S+I+R\\).\nBefore analysing these equations further, let us think about what we expect to happen. The infected foxes in Dover will infect more and more susceptible foxes. The infected foxes will then move around and infect susceptible foxes in neighbouring territories. This will lead to a wave of infection spreading out from Dover. The wave will move at a speed that depends on the infection rate, the recovery rate and the diffusion coefficient. The wave will have a front where the infected foxes are and a tail where the epidemic has died out.\nTo make the further analysis easier, we will non-dimensionalise the equations. We introduce the non-dimensional variables \\[\nu = S/N, ~~~ v = I/N,~~~ \\tilde{t} = \\beta t,\n\\tag{7.25}\\] Then the equations become \\[\\begin{split}\n\\partial_{\\tilde{t}} u&=-uv\\\\\n\\partial_{\\tilde{t}} v&=uv-\\frac{\\gamma}{\\beta}v+\\frac{D}{\\beta}\\partial_x^2v.\n\\end{split} \\tag{7.26}\\] We now also introduce the non-dimensional spatial variable \\(\\tilde{x} = \\sqrt{\\frac{\\beta}{D}}x\\) and the non-dimensional parameter \\(r = \\frac{\\gamma}{\\beta}\\). We now drop the tildes to avoid clutter and write the equations as \\[\\begin{split}\n\\partial_t u&=-uv\\\\\n\\partial_t v&=uv-rv+\\partial_x^2v.\n\\end{split} \\tag{7.27}\\]\n\n7.3.1 Travelling wave Ansatz and boundary conditions\nWe are looking for a solution describing the spread of the infection from Dover to York. We make the Ansatz that the solution is a travelling wave, i.e., that it is of the form \\[\nu(x,t)=U(z),~~~v(x,t)=V(z)\n\\tag{7.28}\\] with \\(z=x-ct\\) for some \\(c&gt;0\\). This means that the wave is a right-moving wave. We plug this into Eq. 7.27 and get the system of ODEs \\[\\begin{split}\n-cU'&=-UV,\\\\\n-cV'&=UV-rV+V''.\n\\end{split} \\tag{7.29}\\] Next let us think about the boundary conditions. We expect that ahead of the wave all the individuals are still susceptible and there are no infecteds yet. So to the far right at \\(z=infty\\) we have \\(u(\\infty)=1\\) (corresponding to S=N) and \\(v(\\infty)=0\\). Behind the wave the epidemic will have run its course and so \\(u(-\\infty)=S_\\infty/N=:a\\) and \\(v(-\\infty)=0\\). In other words, the travelling wave interpolates between the state before an epidemic (at \\(z=\\infty\\)) and the state after an epidemic (at \\(z=-\\infty\\)). We also have that the solution becomes flat as \\(z\\to\\pm\\infty\\), so in particular \\(V'(\\pm\\infty)=0\\).\nWe now massage the equations a bit to get them into a form that we can integrate more easily. From the first equation we see that \\(UV=cU'\\) and also that \\(V=cU'/U=c(\\log U)'\\). We plug this into the second equation and get \\[\n-cV'=cU'-rc(\\log U)' + V''.\n\\tag{7.30}\\] Now that each term in the equation is a total derivative, we can integrate it by just removing the differentiations: \\[\n-cV=cU-rc\\log U + V'+A,\n\\tag{7.31}\\] where \\(A\\) is a constant of integration. We use the boundary condition at \\(z\\to\\infty\\) to determine \\(A\\): \\[\n0=c-rc\\log 1 + 0 + A \\Rightarrow A=-c.\n\\tag{7.32}\\] At \\(z\\to-\\infty\\) we get \\[\n0=ca-rc\\log a + 0 - c \\Rightarrow a-1=r\\log a.\n\\tag{7.33}\\] This equation is equivalent to Eq. 6.7 for \\(S_\\infty\\) in the case where \\(S_0=N\\). Again this transcendental equation can only be solved numerically.\n\n\n7.3.2 Wave speed\nNext we want to learn about the wave speed \\(c\\). We do this by linearising the equation around the leading edge of the wave, where \\(V\\) is very small and \\(U\\) is close to 1, i.e, \\(U=1-\\epsilon\\) for small \\(\\epsilon\\). Substituting this into the second equation in 7.29 we get \\[\n-cV' = (1-\\epsilon)V - r V + V''.\n\\tag{7.34}\\] Because both \\(\\epsilon\\) and \\(V\\) are small, we can neglect the product \\(\\epsilon V\\) and get \\[\n-cV' = (1 - r) V + V''.\n\\tag{7.35}\\] This is a linear ODE with constant coefficients and can thus be solved with the Ansatz \\(V(z) = e^{-\\lambda z}\\). Substituting this into the ODE and dividing by \\(e^{-\\lambda z}\\) gives \\[\n\\lambda^2 -c\\lambda+ 1-r=0.\n\\tag{7.36}\\] The solution of this quadratic equation is \\[\n\\lambda = \\frac{c\\pm\\sqrt{c^2-4(1-r)}}{2}.\n\\tag{7.37}\\] We need \\(\\lambda\\) to be real so that our solution correctly describes the exponential growth at the start of an epidemic, so we need the discriminant to be non-negative, i.e., \\[\nc^2-4(1-r)\\geq 0\n\\tag{7.38}\\] and thus we get a lower bound on the wave speed: \\[\nc\\geq 2\\sqrt{1-r}.\n\\tag{7.39}\\]",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Spatially-structured populations</span>"
    ]
  },
  {
    "objectID": "spatial.html#exercises",
    "href": "spatial.html#exercises",
    "title": "7  Spatially-structured populations",
    "section": "7.5 Exercises",
    "text": "7.5 Exercises\n\n* Fishing model with diffusion\n\nExercise 7.1  \n\nA population of fish \\(F(x,t)\\) in a river of width \\(L\\) with banks at \\(x=0\\) and \\(x=L\\) can be modelled by the partial differential equation \\[\n\\frac{\\partial F}{\\partial t} = rF\\left( 1-\\frac{F}{K} \\right) + D\\frac{\\partial^2 F}{\\partial x^2},\n\\tag{7.62}\\] where \\(r\\), \\(K\\) and \\(D\\) are positive constants. No-flux boundary conditions are applied at \\(x=L\\). On the left bank at \\(x=0\\) the shore-based fishermen catch all of the fish, so that \\(u(0,t)=0\\) for all times. We wish to find the minimum width of the river to ensure the fish population does not collapse.\n\nFirst determine the spatially uniform steady states and indicate their stability.\nLinearise the system for small \\(F\\).\nBy considering a solution of the form \\(F(x,t) = e^{\\lambda t} \\left( A \\cos kx + B \\sin kx \\right)\\) show that \\[\n\\lambda = \\lambda_n = r-k_n^2D,\n\\tag{7.63}\\] where \\[\nk = k_n = \\frac{(2n+1)\\pi }{2L}, ~~~ n = 0,~1,~2,...\n\\]\nHence, determine the condition on \\(L\\) for the fish population not to collapse.\n\n\n\n\n\nTravelling wave in 1-species reaction-diffusion model\n\nExercise 7.2  \n\nA reaction-diffusion population model has the form \\[\n\\frac{\\partial u}{\\partial t}=f(u)+D\\frac{\\partial^2u}{\\partial x^2}\n\\tag{7.64}\\] where \\(D&gt;0\\) and where \\(f\\) satisfies \\(f(0)=f(1)=0\\) and \\(f(u)&gt;0\\) for \\(u\\in(0,1)\\).\n\nConvert this equation into travelling wave form by making the Ansatz that \\(u(x,t)=U(z)\\) and \\(v(x,t)=V(z)\\) with \\(z=x-ct\\).\nAssuming that a solution exists such that \\(U(-\\infty)=1\\), \\(U(\\infty)=0\\) show, by linearising the equation at the leading edge, that for a biologically realistic solution the wave speed \\(c\\) satisfies \\(c\\geq 2\\sqrt{Df'(0)}\\).\nSuppose that, instead, \\(f(u)=0\\). Show that the equation in travelling wave form becomes \\(DU''+c\\,U'=0\\). Give the general solution of this. Does the solution look realistic for a function that represents a population?\n\n\n\n\n\n* Travelling wave in 2-species reaction-diffusion model\n\nExercise 7.3  \n\nConsider the system \\[\n\\begin{split}\n\\frac{\\partial u}{\\partial t}&=-u^2v \\\\\n\\frac{\\partial v}{\\partial t}&=u^2v-\\rho\nv+\\frac{\\partial^2v}{\\partial x^2}\n\\end{split}\n\\tag{7.65}\\] where \\(\\rho\\) is a positive constant. Convert this system into travelling wave form by making the Ansatz that \\(u(x,t)=U(z)\\) and \\(v(x,t)=V(z)\\) with \\(z=x-ct\\), and show in particular that \\[\n-c\\frac{dV}{dz}=c\\frac{dU}{dz}-\\frac{\\rho\n  c}{U^2}\\frac{dU}{dz}+\\frac{d^2V}{dz^2}.\n\\tag{7.66}\\] Consider a solution of the travelling wave equations such that \\(U(\\infty)=1\\), \\(U(-\\infty)=a\\), \\(V(\\pm\\infty)=0\\) for some \\(a&lt;1\\). By integrating the above equation from \\(-\\infty\\) to \\(\\infty\\) and imposing the boundary conditions, determine the value of \\(a\\). Also determine a lower bound on the wave velocity \\(c\\) by linearising around the leading edge of the wave.\n\n\n\n\nSIR model with logistic growth\n\nExercise 7.4  \n\nAssume that in the absence of rabies, the fox population is described by a logistic model with intrinsic growth rate \\(r\\) and carrying capacity \\(K\\). Adding this population dynamics to the SIR model gives the equations \\[\\begin{split}\n\\partial_t S&=rS\\left(1-\\frac{S}{K}\\right)-\\beta SI\\\\\n\\partial_t I&=\\beta SI-\\gamma I.\n\\end{split} \\tag{7.67}\\] We ignore the removed component \\(R\\), which in this case would correspond to dead foxes.\n\nShow that this model can be written in non-dimensionalised form as \\[\\begin{split}\n\\partial_{\\tilde{t}} u&=bu(1-u)-uv\\\\\n\\partial_{\\tilde{t}} v&=uv-mv.\n\\end{split} \\tag{7.68}\\]\nDetermine the steady state solutions (fixed points). Under what condition on the parameters is there an endemic state?\n\nNow assume that both susceptible and infected foxes move around randomly, but at different rates. This adds diffusion terms to the SIR model, where now \\(S=S(x,t)\\) and \\(I=I(x,t)\\) denote densities in space. \\[\\begin{split}\n\\partial_t S&=rS\\left(1-\\frac{S}{K}\\right)-\\beta SI+D_1\\partial_x^2S\\\\\\\n\\partial_t I&=\\beta SI-\\gamma I+D_2\\partial_x^2I.\n\\end{split} \\tag{7.69}\\]\n\nGive expressions for \\(\\tilde{x}\\) and \\(d\\) such that this model can be written in non-dimensionalised form as \\[\\begin{split}\n\\partial_{\\tilde{t}} u&=bu(1-u)-uv+\\partial_{\\tilde{x}}^2u\\\\\n\\partial_{\\tilde{t}} v&=uv-m v+d\\,\\partial_{\\tilde{x}}^2v\n\\end{split} \\tag{7.70}\\]\n\nWe will now work with these non-dimensional equations but drop the tildes to avoid clutter.\n\nMake the travelling wave Ansatz \\[\nu(x,t)=A(z),~~~v(x,t)=B(z)\n\\tag{7.71}\\] with \\(z=x-ct\\) for some \\(c&gt;0\\) and derive the system of ODEs describing the functions \\(A\\) and \\(B\\).\nIf \\(A(\\infty)=1\\), what are \\(A(-\\infty), B(\\infty)\\) and \\(B(-\\infty)\\)? Make a sketch of \\(A(z)\\) and \\(B(z)\\) and indicate the direction of travel with an arrow.\nBy linearising about the leading edge of the wave where \\(B\\) is very small, determine a lower limit on the wave speed \\(c\\).\n\n\n\n\n\nDerive Turing instability\n\nExercise 7.5 Consider the reaction-diffusion model \\[\\begin{split}\n\\frac{\\partial u}{\\partial t}&=a-u+u^2v+D_1\\frac{\\partial^2u}{\\partial\n  x^2} \\\\\n\\frac{\\partial v}{\\partial t}&=b-u^2v+D_2\\frac{\\partial^2v}{\\partial\n  x^2}\n\\end{split} \\tag{7.72}\\] where \\(b&gt;0\\) and \\(a+b&gt;0\\).\nShow that a spatially uniform steady state solution \\((u^*,v^*)\\) exists for this model and is given by \\((u^*,v^*)=(a+b\\,,\\;b/(a+b)^2)\\). Show that the conditions for this steady state to be driven unstable by diffusion are that the three inequalities \\[\nb-a&lt;(a+b)^3\\] \\[\n\\left[D_2\\left(\\frac{b-a}{a+b}\\right)-D_1(a+b)^2\\right]^2&gt;4D_1D_2(a+b)^2\n\\tag{7.73}\\] \\[\nD_2\\left(\\frac{b-a}{a+b}\\right)-D_1(a+b)^2&gt;0\n\\tag{7.74}\\] should all hold simultaneously.\n\n\n\n\n* Conditions for Turing instability\n\nExercise 7.6 Consider the reaction-diffusion model \\[\\begin{split}\n\\frac{\\partial c_1}{\\partial t}&=\\delta -kc_1 - c_1c_2^2 + D_1\\frac{\\partial^2c_1}{\\partial\n  x^2} \\\\\n\\frac{\\partial c_2}{\\partial t}&=kc_1+c_1c_2^2 - c_2 + D_2\\frac{\\partial^2c_2}{\\partial\n  x^2}\n\\end{split} \\tag{7.75}\\] where \\(k&gt;0\\) and \\(\\delta&gt;0\\).\nShow that a spatially uniform steady state solution \\((c_1^*,c_2^*)\\) exists for this model and give the conditions for this steady state to be driven unstable by diffusion. You may use any results derived in the lectures.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Spatially-structured populations</span>"
    ]
  },
  {
    "objectID": "spatial.html#turing-instabilities",
    "href": "spatial.html#turing-instabilities",
    "title": "7  Spatially-structured populations",
    "section": "7.4 Turing instabilities",
    "text": "7.4 Turing instabilities\nWe now come to a very intriguing question: how can the complicated spatial patterns arise that one can observe in nature. One might have thought that to explain complicated patterns one would need complicated models that encode all that complexity. However, it turns out that patterns can arise from very simple, translation-invariant models. The key idea is that the spatially uniform steady state in a translation-invariant model can be unstable to small perturbations, which then grow and form spatial patterns. This is called a Turing instability.\nWe consider a system of two species, described by densities \\(u(x,t)\\) and \\(v(x,t)\\), that interact with each other locally but also move around randomly. The system is described by the reaction-diffusion equations \\[\\begin{split}\n\\frac{\\partial u}{\\partial t}&=f(u,v)+D_1\\frac{\\partial^2u}{\\partial x^2},\\\\\n\\frac{\\partial v}{\\partial t}&=g(u,v)+D_2\\frac{\\partial^2v}{\\partial x^2},\n\\end{split} \\tag{7.40}\\] where \\(f\\) and \\(g\\) are functions that describe the local dynamics of the two species. The diffusion terms model random motion of the individuals.\nFor values \\((u^*,v^*)\\) of the densities that satisfy \\(f(u^*,v^*)=g(u^*,v^*)=0\\), the spatially homogeneous steady state \\(u(x,t)=u^*\\), \\(v(x,t)=v^*\\) is a solution of the system. Assume that in the absence of diffusion, this steady state is stable. Thus without diffusion, any perturbations to the spatially homogeneous steady state will decay. One would then expect that the spatially homogeneous steady state is stable also in the presence of diffusion, given that diffusion has the tendency to spread individuals out away from regions of higher concentration. The result would be the absence of any spatial structure in the solution. However, we will now see that this is not always the case. Rather counter-intuitively, the random motion of the individuals can destabilise the spatially homogeneous steady state and give rise to spatial patterns.\n\n7.4.1 Deriving conditions for Turing instabilities\nMathematics is a great tool for dealing with counter-intuitive phenomena. We just have to do the maths and see what it tells us. So we now derive the equations that describe the time-evolution of small perturbations and solve them and see whether the perturbations grow or not. So we set \\[\nu(x,t)=u^*+\\xi(x,t),~~~v(x,t)=v^*+\\eta(x,t)\n\\tag{7.41}\\] where \\(\\xi(x,t)\\) and \\(\\eta(x,t)\\) are small perturbations. If we plug this into Eq. 7.40 we get equations for the time evolution of the small perturbations: \\[\\begin{split}\n\\frac{\\partial \\xi}{\\partial t}&=f(u^*+\\xi(x,t),v^*+\\eta(x,t))\\xi+D_1\\frac{\\partial^2\\xi}{\\partial x^2},\\\\\n\\frac{\\partial \\eta}{\\partial t}&=g(u^*+\\xi(x,t),v^*+\\eta(x,t))\\xi+D_2\\frac{\\partial^2\\eta}{\\partial x^2}.\n\\end{split} \\tag{7.42}\\] We now use Taylor expansions to linearise the equations. We expand \\(f\\) and \\(g\\) around \\((u^*,v^*)\\) to first order and drop all terms that are higher order in \\(\\xi\\) and/or \\(\\eta\\). This gives the linear PDEs \\[\\begin{split}\n\\frac{\\partial \\xi}{\\partial t}&=\\frac{\\partial f}{\\partial u}(u^*,v^*)\\xi+\\frac{\\partial f}{\\partial v}(u^*,v^*)\\eta+D_1\\frac{\\partial^2\\xi}{\\partial x^2}\\\\\n&=a_{11}\\xi+a_{12}\\eta+D_1\\frac{\\partial^2\\xi}{\\partial x^2},\\\\\n\\frac{\\partial \\eta}{\\partial t}&=\\frac{\\partial g}{\\partial u}(u^*,v^*)\\xi+\\frac{\\partial g}{\\partial v}(u^*,v^*)\\eta+D_2\\frac{\\partial^2\\eta}{\\partial x^2}\\\\\n&=a_{21}\\xi+a_{22}\\eta+D_2\\frac{\\partial^2\\eta}{\\partial x^2}.\n\\end{split} \\tag{7.43}\\] Those partial derivatives of \\(f\\) and \\(g\\) with respect to \\(u\\) and \\(v\\) are familiar to us from the stability analysis in non-spatial models as the entries of the Jacobian matrix and we are using the same shorthand notation for them here.\nWe now make the harmonic wave Ansatz \\[\\begin{split}\n\\xi(x,t)&=B_1e^{\\sigma_k t}\\sin(kx+\\alpha),\\\\\n\\eta(x,t)&=B_2e^{\\sigma_k t}\\sin(kx+\\alpha).\n\\end{split}\n\\tag{7.44}\\] During your studies you will have seen this easy way to solve linear PDEs with constant coefficients already several times. Plugging this Ansatz into Eq. 7.43 and dividing by \\(e^{\\sigma_k t}\\sin(kx+\\alpha)\\) we get \\[\\begin{split}\n\\sigma_k B_1&=a_{11}B_1+a_{12}B_2-k^2D_1B_1\\\\\n\\sigma_k B_2&=a_{21}B_1+a_{22}B_2k^2D_2B_2.\n\\end{split} \\tag{7.45}\\] We can write this in matrix form as \\[\n\\sigma_k\\begin{pmatrix}B_1\\\\B_2\\end{pmatrix}=A(k)\\begin{pmatrix}B_1\\\\B_2\\end{pmatrix}.\n\\tag{7.46}\\] where \\[\nA(k)=\\begin{pmatrix}a_{11}-D_1k^2&a_{12}\\\\a_{21}&a_{22}-D_2k^2\\end{pmatrix}.\n\\tag{7.47}\\] This looks very similar to what we get when we do the stability analysis of a non-spatial model, except that now we have a whole family of matrices \\(A(k)\\), one for each \\(k\\). The condition for the spatially homogeneous steady state to be stable is that all the eigenvalues \\(\\sigma_k\\) of all the matrices \\(A(k)\\) are negative. The spatially homogeneous steady state to be unstable is that there is at least one \\(k\\) for which the real part of \\(\\sigma_k\\) is positive.\nAs we know from studying the stability of non-spatial models of two interacting species, an easy way to determine the stability is to look at the signs of the trace and the determinant of the matrix \\(A(k)\\). For the trace we find \\[\n\\begin{split}\n\\text{tr}(A(k))&=a_{11}-k^2D_1+a_{22}-k^2D_2\\\\\n&=\\text{tr}(A(0))-k^2(D_1+D_2).\n\\end{split}\n\\tag{7.48}\\] We are interested in the case where the steady state is stable in the absence of diffusion and is destabilised by the diffusion. Stability in the absence of diffusion requires \\(\\text{tr}(A(0))&lt;0\\). We see that in that case also \\(\\text{tr}(A(k))&lt;0\\) for all \\(k\\) because the \\(k\\)-dependent term \\(-k^2(D_1+D_2)\\) is negative. So the trace is not yet giving us a hint that there might be an instability. So next we look at the determinant.\nFor the determinant we find \\[\\begin{split}\n\\det(A(k))&=(a_{11}-D_1k^2)(a_{22}-D_2k^2)-a_{12}a_{21}\\\\\n&=D_1D_2k^4-(D_1a_{22}+D_2a_{11})k^2+\\det(A(0))\n\\end{split} \\tag{7.49}\\] Stability in the absence of diffusion tells us that \\(\\det(A(0))&gt;0\\). We see that \\(\\det(A(k))\\) is a quadratic polynomial in \\(k^2\\) with positive leading coefficient. Its graph is a parabola. This means that the determinant is positive for small \\(k\\) and for large \\(k\\) but there may be an intermediate region where the parabola dips below the axis and the determinant is negative in that region. Perturbations with wave numbers in that region would grow over time, making the homogeneous steady state unstable and leading to spatial structure. If that region exists, it is bounded by the values \\(k_\\pm\\) for which the determinant is zero. Using the quadratic formula we find that \\[\nk_\\pm^2=\\frac{D_1a_{22}+D_2a_{11}\\pm\\sqrt{(D_1a_{22}+D_2a_{11})^2-4D_1D_2\\det(A(0))}}{2D_1D_2}.\n\\tag{7.50}\\] The unstable interval exists if \\(k_\\pm^2\\) are real and positive. They are real if the discriminant under the square root is non-negative. This gives the condition \\[\n(D_1a_{22}+D_2a_{11})^2&gt;4D_1D_2\\det(A(0)).\n\\tag{7.51}\\] They are positive if the numerator is positive. This gives the condition \\[\nD_1a_{22}+D_2a_{11}&gt;0.\n\\tag{7.52}\\] The condition for the spatially homogeneous steady state to be unstable is that both Eq. 7.51 and Eq. 7.52 are satisfied.\n\n\n7.4.2 Understanding the conditions for Turing instabilities\nWe have now derived the conditions for Turing instabilities in terms of the entries of the Jacobian matrix \\(A=A(0)\\) of the local dynamics of the two species and the diffusion coefficients: \\[\\begin{split}\na)\\qquad&a_{11}+a_{22}&lt;0,\\\\\nb)\\qquad&a_{11}a_{22}-a_{12}a_{21}&gt;0,\\\\\nc)\\qquad&D_1a_{22}+D_2a_{11}&gt;0,\\\\\nd)\\qquad&(a_{11}+a_{22})^2&gt;4(a_{11}a_{22}-a_{12}a_{21}).\n\\end{split} \\tag{7.53}\\] Conditions a) and b) are the conditions for the spatially homogeneous steady state to be stable in the absence of diffusion. Condition c) and d) are the condition for the spatially homogeneous steady state to be unstable in the presence of diffusion.\nWe will first look at what these conditions tell us about the sign structure of the Jacobian, which will introduce the concept of activator and inhibitor species. We make three observations:\n\nWe observe that condition a) implies that at least one of \\(a_{11}\\) and \\(a_{22}\\) is negative. We are free to choose the numbering of our species, so, without loss of generality, let’s say that \\(a_{22}&lt;0\\). This means that species 2 inhibits its own growth above the steady state. We call species 2 an inhibitor species.\nFrom condition c) we see that if \\(a_{22}&lt;0\\) then \\(a_{11}&gt;0\\). This means that species 1 activates its own growth above the steady state. We call species 1 an activator species.\nFrom condition b) we now observe that, because \\(a_{11}a_{22}&lt;0\\), we must have that \\(a_{12}a_{21}&lt;0\\).\n\nTaking these three observations together tells us that there are only two possibilities for the sign structure of the Jacobian matrix: \\[\n\\text{sign}(A)=\\begin{pmatrix}+&-\\\\+&-\\end{pmatrix}~~~\\text{or}~~~\\text{sign}(A)=\\begin{pmatrix}+&+\\\\-&-\\end{pmatrix}.\n\\tag{7.54}\\] If the signs in the Jacobian are different from both of these possibilities you can immediately rule out a Turing instability.\nNext we look at what our conditions a) to d) tell us about the magnitude of the diffusion coefficients. From condition a) we know that \\(a_{11}&lt;-a_{22}\\) and hence \\(-a_{11}/a_{22}&lt;1\\). From condition c) we see that \\(D_1/D_2&lt;-a_{11}/a_{22}\\). Putting these together gives \\(D_1/D_2&lt;1\\) and hence \\(D_1&lt;D_2\\): The inhibitor must diffuse faster than the activator. This is a necessary condition for a Turing instability.\nExactly how much faster the inhibitor must diffuse than the activator depends on the details of the local interactions and we will next study this in a concrete example.\n\n\n7.4.3 Example\nLet’s consider the following concrete reaction-diffusion system: \\[\\begin{split}\n\\partial_tu&=-u+u^2v+D_1\\partial_x^2u=f(u,v)+D_1\\partial_x^2u,\\\\\n\\partial_tv&=b-u^2v+D_2\\partial_x^2v=g(u,v)+D_2\\partial_x^2v.\n\\end{split} \\tag{7.55}\\]\nThe Jacobian matrix of the local dynamics is \\[\nA=\\begin{pmatrix}\\frac{\\partial f}{\\partial u}&\\frac{\\partial f}{\\partial v}\\\\\n\\frac{\\partial g}{\\partial u}&\\frac{\\partial g}{\\partial v}\\end{pmatrix}=\n\\begin{pmatrix}-1+2uv&u^2\\\\-2uv&-u^2\\end{pmatrix}.\n\\tag{7.56}\\] We are interested in the coexistence steady state \\((u^*,v^*)\\) where both species coexist. Imposing that \\(f(u^*,v^*)=0\\) gives us that \\(u^*v^*=1\\) and then imposing that \\(g(u^*,v^*)=0\\) gives us that \\(u^*=b\\) and hence \\(v^*=1/b\\). So the coexistence steady state is \\[\n(u^*,v^*)=\\left(b,\\frac{1}{b}\\right).\n\\tag{7.57}\\] The Jacobian matrix evaluated at the coexistence steady state is \\[\nA=\\begin{pmatrix}1&b^2\\\\-2&-b^2\\end{pmatrix}.\n\\tag{7.58}\\] We see that the sign structure of this matrix is one of those in Eq. 7.54 that can give rise to a Turing instability. Species \\(u\\) is the activator and species \\(v\\) is the inhibitor.\nNow let us check each of the conditions a) to d) from Eq. 7.53. Condition a) becomes \\(1-b^2&lt;0\\) and hence \\(b^2&gt;1\\). Condition b) becomes \\(-b^2+2b^2&gt;0\\) which is automatically satisfied. Condition c) becomes \\(D_2-b^2D_1&gt;0\\) which implies \\(D_1b^2&lt;D_2\\), which means that the ratio \\(d=D_2/D_1&gt;b^2\\). Condition d) becomes \\((D_2-b^2D_1)^2&gt;4D_1D_2b^2\\). Multiplying out the square and bringing everything to one side gives \\(b^4D_1^2-6D_1D_2+D_2^2&gt;0\\). We can rewrite this in terms of the ratio \\(d=D_2/D_1\\) as \\[\nb^4-6db^2+d^2&gt;0.\n\\tag{7.59}\\] The graph of the left-hand side against \\(d\\) is a parabola that opens upwards and has roots at \\[\nd_\\pm=3b^2\\pm\\sqrt{9b^4-b^4}=b^2(3\\pm\\sqrt{8}).\n\\tag{7.60}\\] The condition in Eq. 7.59 tells us that \\(d\\) is outside the interval \\((d_-,d_+)\\). We have also already derived that \\(d&gt;b^2&gt;d_-\\). So the final condition on the ratio of the diffusion rates is \\[\nd=\\frac{D_2}{D_1}&gt;b^2(3+\\sqrt{8}).\n\\tag{7.61}\\] This means that the inhibitor must diffuse at least \\(b^2(3+\\sqrt{8})\\) times faster than the activator in order for a Turing instability to occur.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Spatially-structured populations</span>"
    ]
  },
  {
    "objectID": "solutions.html",
    "href": "solutions.html",
    "title": "8  Solutions",
    "section": "",
    "text": "8.1 Continuous-time population models\nThis appendix holds the solutions to selected exercises in the book. Please look at these solutions only after having made a serious attempt at solving the exercises and knowing exactly where you got stuck.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#continuous-time-population-models",
    "href": "solutions.html#continuous-time-population-models",
    "title": "8  Solutions",
    "section": "",
    "text": "Von Bertalanffy growth\nExercise 1.4:\n\nSeeking a steady state we find \\(\\alpha w^{2/3}-\\beta w = 0\\) \\(\\implies\\) \\(w^{2/3}(\\alpha-\\beta w^{1/3})=0\\) \\(\\implies\\) \\(w=0\\) or \\(w^{1/3} = \\alpha/\\beta\\). With the graphical approach in Figure 8.1 we see that the non-zero steady state is stable. Hence, \\[\n\\lim_{t \\rightarrow \\infty} w(t) = \\left( \\frac{\\alpha}{\\beta} \\right)^{3}.\n\\tag{8.1}\\]\n\n\n\n\n\n\n\nFigure 8.1: \\(dw/dt\\) versus \\(w\\) for the von Bertalanffy growth model.\n\n\n\n\nFor the time derivative of \\(u=w^{1/3}\\) we find by the chain rule that \\[\n\\frac{du}{dt} = \\frac13 w^{-2/3} \\frac{dw}{dt} = \\frac{1}{3u^2}\\left( \\alpha w^{2/3}-\\beta w \\right).\n\\tag{8.2}\\] Hence \\[\n3\\frac{du}{dt} = \\frac{1}{u^2}\\left( \\alpha u^2-\\beta u^3 \\right) = \\alpha-\\beta u.\n\\tag{8.3}\\] So this change of variables has yielded a linear first-order ODE with constant coefficients, which is easy for us to solve: \\[\nu(t) = \\frac{1}{\\beta} \\left( \\alpha  - Ae^{-\\beta t/3}\\right)\n\\tag{8.4}\\] for some integration constant \\(A\\). If \\(u(0)=u_0\\) then \\(A=\\alpha -\\beta u_0\\).\nTranslating back to \\(w\\) with \\(w_0=u_0^3\\) we finally have \\[\nw(t) = u(t)^3 = \\frac{1}{\\beta^3}\\left( \\alpha - \\left( \\alpha - \\beta w_0^{1/3} \\right) e^{-\\beta t/3}  \\right)^3.\n\\tag{8.5}\\]\n\n\n\n\nSolving logistic equation\nExercise 1.2: We separate the variables by dividing both sides of the ODE by \\(N(1-N/K)\\) and multiplying by \\(dt\\), and then integrate to get \\[\n\\int_{N_0}^{N(t)}\\frac{dN}{N\\left(1-\\frac{N}{K}\\right)}=\\int_0^t r\\,dt.\n\\tag{8.6}\\] The right hand side is trivial to integrate, but for the integral on the left-hand side we need to employ the method of partial fractions, using that \\[\n\\frac{dN}{N\\left(1-\\frac{N}{K}\\right)}=\\frac{1}{N}+\\frac{1}{K-N}.\n\\tag{8.7}\\] The left-hand side then gives \\[\n\\begin{split}\n\\int_{N_0}^{N(t)}&\\left(\\frac{1}{N}+\\frac{1}{K-N(t)}\\right)dN\\\\\n&=\\log N(t)-\\log N_0-\\log(K-N(t))+\\log(K-N_0).\n\\end{split}\n\\tag{8.8}\\] We exponentiate both sides to get \\[\n\\frac{N(t)}{N_0}\\frac{K-N_0}{K-N(t)}=e^{rt}.\n\\tag{8.9}\\] Now we just need to solve for \\(N(t)\\): \\[\nN(t)=\\frac{N_0Ke^{rt}}{K+N_0(e^{rt}-1)}.\n\\tag{8.10}\\]\n\n\n\n\nHarvesting with fixed quota\n**Exercise 1.6: If we harvest with a fixed quota \\(Q\\), the population is described by the equation \\[\n\\frac{dN}{dt} = \\alpha N \\log\\frac{K}{N} - Q.\n\\tag{8.11}\\] The subtraction of \\(Q\\) shifts the graph of the right-hand side down by a distance \\(Q\\). This brings the non-zero fixed points closer together until \\(Q\\) is equal to the maximum of the growth rate of the unfished population. If \\(Q\\) is increased beyond this value the non-zero fixed points disappear and the population will go extinct. is because we are removing \\(Q\\) individuals from the population at a constant rate. Thus the maximum sustainable yield occurs when \\(Q\\) equals the maximum replenishment rate of the unfished population. To find that maximum we first solve \\[\n0=\\frac{d}{dN}\\left(\\alpha N \\log\\frac{K}{N}\\right)=\\alpha\\left(\\log\\frac{K}{N}-1\\right).\n\\tag{8.12}\\] This tells us that the maximum is at \\[\nN_{max} = K\\,e^{-1}.\n\\tag{8.13}\\] Hence the value at the maximum is \\[\nMSY=Q_{max}=\\alpha N_{max} \\log\\frac{K}{N_{max}}=\\alpha\\,K\\,e^{-1}.\n\\tag{8.14}\\] Fishing at this quota is not wise, as this reduces the population to the threshold level below which the population will go extinct.\n\n\n\nWasp model\nExercise 1.7: For \\(0\\leq t\\leq t_c\\) the number of workers satisfies \\[\n\\frac{dn}{dt}=r\\,n.\n\\tag{8.15}\\] Therefore \\[\nn(t)=n_0e^{r\\,t}.\n\\tag{8.16}\\]\nFor \\(t_c\\leq t\\leq T\\) the number of reproducers satisfies \\[\n\\frac{dN}{dt}=Rn(t_c)=R\\,n_0\\,e^{r\\,t_c},\n\\tag{8.17}\\] so that \\[\nN(T)=(T-t_c)R\\,e^{r\\,t_c}.\n\\tag{8.18}\\]\nTo find the value of \\(t_c\\) that maximises \\(N(T)\\) we set the derivative of \\(N(T)\\) with respect to \\(t_c\\) to zero: \\[\n\\begin{split}\n0&=\\frac{d}{dt_c}N(T)=\\frac{d}{dt_c}(T-t_c)R\\,e^{r\\,t_c}\\\\\n&=-R\\,e^{r\\,t_c}+(T-t_c)R\\,r\\,e^{r\\,t_c}\\\\\n&=R\\,e^{r\\,t_c}(r\\,T-r\\,t_c-1).\n\\end{split}\n\\tag{8.19}\\] This implies that \\[\nt_c=T-\\frac{1}{r}.\n\\tag{8.20}\\]\n\n\n\nWasp model with death\nExercise 1.8: For \\(0\\leq t\\leq t_c\\) the number of workers satisfies \\[\n\\frac{dn}{dt}=(r-d)n.\n\\tag{8.21}\\] Therefore \\[\nn(t)=e^{(r-d)t}.\n\\tag{8.22}\\] For \\(t_c\\leq t\\leq T\\) we have \\[\n\\frac{dn}{dt}=-dn\n\\tag{8.23}\\] so that \\[\nn(t)=n(t_c)e^{-d(t-t_c)}=e^{(r-d)t}e^{-d(t-t_c)}=e^{r\\,t_c}e^{-d\\,t}.\n\\tag{8.24}\\] Also for \\(t_c\\leq t\\leq T\\) the number of reproducers satisfies \\[\n\\frac{dN}{dt}=Rn(t)=Re^{r\\,t_c}e^{-d\\,t},\n\\tag{8.25}\\] so that \\[\nN(T)=\\int_{t_c}^TRe^{r\\,t_c}e^{-d\\,t}dt = \\frac{R}{d}e^{r\\,t_c}\\left(e^{-d\\,t_c}-e^{-d\\,T}\\right).\n\\tag{8.26}\\] To find the value of \\(t_c\\) that maximises \\(N(T)\\) we set the derivative of \\(N(T)\\) with respect to \\(t_c\\) to zero: \\[\n\\begin{split}\n0&=\\frac{d}{dt_c}N(T)=\\frac{d}{dt_c}\\left( \\frac{R}{d}e^{r\\,t_c}\\left(e^{-d\\,t_c}-e^{-d\\,T}\\right)\\right)\\\\\n&=Re^{r\\,t_c}\\left(\\left(\\frac{r}{d}-1\\right)e^{-d\\,t_c}-\\frac{r}{d}e^{-d\\,T}\\right).\n\\end{split}\n\\tag{8.27}\\] This is equivalent to \\[\ne^{-d\\,t_c}=\\frac{1}{1-d/r}e^{-d\\,T}\n\\tag{8.28}\\] and thus \\[\nt_c=T+\\frac{1}{d}\\ln\\left(1-\\frac{d}{r}\\right).\n\\tag{8.29}\\]",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#discrete-time-population-models",
    "href": "solutions.html#discrete-time-population-models",
    "title": "8  Solutions",
    "section": "8.2 Discrete-time population models",
    "text": "8.2 Discrete-time population models\n\nVerhulst model\nExercise 2.3: Let’s write the equation as \\(N_{t+1}=f(N_t)\\) with \\[\nf(N)=rN\\left(1-\\frac{N}{K}\\right).\n\\tag{8.30}\\]\nBecause \\(f(N)\\) is positive for all \\(N&lt;K\\), the only way for \\(N_{t+1}\\) to be negative is for \\(N_t\\) to be greater than \\(K\\). This in turn is only possible if \\(f(N_{t-1})&gt;K\\). So the function \\(f\\) at its maximum needs to be larger than \\(K\\). Because the function describes an upside-down parabola with zeros at \\(0\\) and \\(K\\), its maximum is in the middle at \\(N=K/2\\), where \\(f(K/2)=rK/4\\). Thus the population can get negative iff \\(rK/4&gt;K\\), which is equivalent to \\(r&gt;4\\).",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#sex-structured-population-models",
    "href": "solutions.html#sex-structured-population-models",
    "title": "8  Solutions",
    "section": "8.3 Sex-structured population models",
    "text": "8.3 Sex-structured population models\n\nDominance structure\nExercise 4.2:\n\nThe ratio \\(F/Q\\) in the negative term in the equation for the alpha females represents the fact that if the ratio between the subordinate individuals who gather the food and the alpha females who rely on that food is too small, then the alpha females don’t get enough food and hence are less fit, leading to either a decreased birth rate or an increased mortality rate.\n\n\nWe derive the ODE: \\[\\begin{split}\n\\frac{d}{dt}\\frac{F}{Q }&=\\frac{F'Q -FQ'}{Q ^2}\\\\\n&=\n\\frac{(b_F-\\mu_F F/Q )F Q-F(b_Q F-\\mu_Q  Q )}{Q ^2}\\\\\n&=(b_F+\\mu_Q )\\frac{F}{Q }\\left(1-\\frac{b_Q +\\mu_F}{b_F+\\mu_Q }\\frac{F}{Q }\\right).\n\\end{split} \\tag{8.31}\\] Ideally you identify this as the logistic equation with initial growth rate \\(r\\) and carrying capacity \\(K\\) given by \\[\nr=b_F+\\mu_Q ,~~~K=\\frac{b_F+\\mu_Q }{b_Q +\\mu_F}.\n\\tag{8.32}\\] You can then look up the solution in the lecture notes: \\[\n\\frac{F}{Q }(t)=\\frac{\\frac{F_0}{Q_0}Ke^{rt}}{K+\\frac{F_0}{Q_0}\\left(e^{rt}-1\\right)}.\n\\tag{8.33}\\] Otherwise you have to work a bit harder.\nBecause we have identified \\(F/Q (t)\\) as the solution of a logistic equation it is easy to see that as \\(t\\to\\infty\\), \\(F/Q \\to K\\) with \\(K\\) as in Eq. 8.32.\nWe derive the ODE: \\[\\begin{split}\n\\frac{d}{dt}\\frac{F}{M}&=\\frac{F'M-FM'}{M^2}\\\\\n&=\n\\frac{(b_F-\\mu_F F/Q )FM-F(b_MF-\\mu_M M)}{M^2}\\\\\n&=\\frac{F}{M}\\left(b_F+\\mu_M-\\mu_F\\frac{F}{Q }-b_M\\frac{F}{M}\\right).\n\\end{split} \\tag{8.34}\\] We are only interested in the limit of \\(F/M\\) as \\(t\\to\\infty\\). Let us denote this limit by \\(R\\). We already know that the limit of \\(F/Q\\) as \\(t\\to\\infty\\) is \\(K\\). The limit of the previous equation gives \\[\n0=\\frac{d}{dt}R=R\\left(b_F+\\mu_M-\\mu_FK-b_MR\\right)\n\\tag{8.35}\\] and hence \\[\nR=\\frac{b_F+\\mu_M-\\mu_FK}{b_M}.\n\\tag{8.36}\\] Substituting the expression for \\(K\\) and bringing everything on a common denominator gives \\[\nR=\\frac{(b_F+\\mu_M)(b_Q +\\mu_F)-\\mu_F(b_F+\\mu_Q )}{b_M(b_Q +\\mu_F)}\n\\tag{8.37}\\] To see that this is always positive we multiply out the numerator: \\[\nR=\\frac{b_Fb_Q +\\mu_Mb_Q +\\mu_M\\mu_F-\\mu_F\\mu_Q }{b_M(b_Q +\\mu_F)}\n\\tag{8.38}\\] This is positive because \\(b_Fb_Q &gt;\\mu_F\\mu_Q\\)\nThe birth rates are linear in the number of alpha females and independent of \\(M\\) and \\(Q\\). Independence of \\(M\\) is realistic only if \\(M\\) is large. Using a weighted mean might be better, i.e., birth rates given by \\(b_i FM/(F/n+M)\\), where \\(n\\) is the number of females a male can mate with per mating season. Or we could take into account that the alpha females will reproduce less if there are fewer subordinate individuals gathering food for them, for example by choosing birth rates to be given by \\(b_i F Q/(F/n+Q )\\), where \\(n\\) is the number of pregnant females that a subordinate monkey can keep well fed. There are many other possible improvements.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#age-structured-population-models",
    "href": "solutions.html#age-structured-population-models",
    "title": "8  Solutions",
    "section": "8.4 Age-structured population models",
    "text": "8.4 Age-structured population models\n\nSpotted owl\nExercise 5.1:\n\nThe given values of the survival probabilities from year to year lead to the following values of the survival probabilities from birth to age \\(a\\): \\[\nl_a = \\begin{cases}\n1 & \\text{if } a = 1, \\\\\nl\\, p^{a-2} & \\text{if } a \\geq 2.\n\\end{cases}\n\\tag{8.39}\\]\nSubstituting these values into the expression for \\(\\psi(\\lambda)\\) in Eq. 5.31 gives \\[\n\\begin{split}\n\\psi(\\lambda) &= b l \\sum_{a=2}^\\infty p^{a-2} \\lambda^{-a} = lb\\lambda^{-2}\\sum_{n=0}^\\infty \\frac{p}{\\lambda}\\\\\n&= lb\\lambda^{-2}\\frac{1}{1-\\frac{p}{\\lambda}}\n=\\frac{lb}{\\lambda(\\lambda-p)},\n\\end{split}\n\\tag{8.40}\\] where we made use of the formula for a geometric series, valid if \\(|p/\\lambda|&lt;1\\) 1. In particular, the expected number of offspring produced by an individual in their lifetime is \\[\n\\psi(1)=lb/(1-p).\n\\]\n\nIf this is greater than \\(1\\), then the population grows exponentially. If it is less than \\(1\\), then the population goes extinct.\nIn this case the Euler-Lotka equation \\(\\psi(\\lambda)=1\\) becomes the quadratic equation for \\(\\lambda\\): \\[\n\\psi(\\lambda)=\\frac{lb}{\\lambda(\\lambda-p)}=1 \\quad \\Leftrightarrow \\quad \\lambda^2 - \\lambda p - lb = 0.\n\\tag{8.41}\\] The solutions are \\[\n\\lambda_\\pm = \\frac{p \\pm \\sqrt{p^2 + 4lb}}{2}.\n\\tag{8.42}\\] We are interested in the positive solution \\(\\lambda_+\\). Substituting this value for \\(\\lambda\\) back into Eq. 5.17 and Eq. 5.13 we see that we have found the solution \\[\nN_{a,t} = \\left(\\frac{p + \\sqrt{p^2 + 4lb}}{2}\\right)^{t-a}l_a N_{0,0}\n\\tag{8.43}\\] for any choice of \\(N_{0,0}\\).\n\n\n\nSeasonal mortality\nExercise 5.6:\n\nSubstituting \\(n(t,a)=p(t)r(a)\\) into Eq. 5.36 and dividing by \\(n(t,a)\\) gives \\[\n\\frac{p'(t)}{p(t)}+\\frac{r'(a)}{r(a)}=-\\mu(a)-f(t).\n\\tag{8.44}\\] Separating variables gives \\[\n\\frac{p'(t)}{p(t)}+f(t)=-\\frac{r'(a)}{r(a)}-\\mu(a).\n\\tag{8.45}\\] As the left-hand side is independent of \\(a\\) and the right-hand side is independent of \\(t\\), both sides must be equal to some constant \\(\\gamma\\). This gives us the two ODEs \\[\n\\frac{d}{dt}\\log(p(t))=\\gamma-f(t),~~~\\frac{d}{da}\\log(r(a))=-\\gamma-\\mu(t).\n\\tag{8.46}\\] These have the solutions \\[\n\\begin{split}\np(t)&=p(0)\\exp\\left(\\int_0^t\\gamma-f(s)\\,ds\\right),\\\\\nr(a)&=r(0)\\exp\\left(-\\int_0^a\\gamma+\\mu(s)\\,ds\\right)\n\\end{split}\n\\tag{8.47}\\] Thus the solution for \\(n\\) is \\[\nn(t,a)=n(0,0)\\exp\\left(\\int_0^t\\gamma-f(s)\\,ds\\right)\n\\exp\\left(-\\int_0^a\\gamma+\\mu(s)\\,ds\\right).\n\\tag{8.48}\\]\nSubstituting the solution into Eq. 5.37 gives \\[\np(t)r(0)=\\int_0^\\infty b(a)p(t)r(a)\\,da.\n\\tag{8.49}\\] After dividing by \\(p(t)r(0)\\) and using our expression for \\(r(a)\\) from the previous part, \\[\n1=\\int_0^\\infty b(a) \\exp\\left(-\\int_0^a\\gamma+\\mu(s)ds\\right)da\n=\\phi(\\gamma).\n\\tag{8.50}\\] The factor \\(\\exp(-\\gamma a)\\) in the integrand decreases monotonically with increasing \\(\\gamma\\) and therefore so does the integral. Hence the function \\(\\phi(\\gamma)\\) is a monotonically decreasing function.\nThe end of a season occurs at any \\(t\\in\\mathbb{Z}\\). At those integer times we can write the integral in the expression for \\(p(t)\\) as \\[\n\\begin{split}\n\\int_0^t\\gamma-f(s)\\,ds&=\\sum_{i=1}^t\\int_{i-1}^{i}\\gamma-f(s)\\,ds\\\\\n&=\\sum_{i=1}^t(\\gamma - F)=t(\\gamma - F).\n\\end{split}\n\\tag{8.51}\\] Hence for the population at the end of the season \\(t\\) we have \\[\nn(t,a)=n(0,0)\\exp(t(\\gamma - F))r(a).\n\\tag{8.52}\\] This will go to zero in the limit \\(t\\to\\infty\\) if \\(\\gamma - F&lt;0\\). Thus the criterion for extinction is \\(\\gamma &lt; F\\).\nBecause \\(\\phi(\\gamma)\\) decreases with \\(\\gamma\\), \\[\n\\gamma &lt; F \\Leftrightarrow \\phi(\\gamma) &gt; \\phi(F).\n\\tag{8.53}\\] Because \\(\\phi(\\gamma)=1\\), this is equivalent to the condition \\(1&gt;\\phi(F)\\). Thus the condition for extinction is \\[\n\\int_0^\\infty b(a) \\exp\\left(-\\int_0^a F+\\mu(s)\\,ds\\right)da\n&lt;1.\n\\tag{8.54}\\]",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#interacting-populations",
    "href": "solutions.html#interacting-populations",
    "title": "8  Solutions",
    "section": "8.5 Interacting populations",
    "text": "8.5 Interacting populations",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#epidemics",
    "href": "solutions.html#epidemics",
    "title": "8  Solutions",
    "section": "8.6 Epidemics",
    "text": "8.6 Epidemics\n\nSIR with recrudescence\nExercise 6.3: The modified equations are \\[\n\\begin{split}\n\\frac{dS}{dt} &= -\\beta S I/N,\\\\\n\\frac{dI}{dt} &= \\beta S I/N - \\gamma I + \\delta R,\\\\\n\\frac{dR}{dt} &= \\gamma I - \\delta R.\n\\end{split}\n\\tag{8.55}\\]\n\nAt the steady state all these derivatives have to vanish. From the first equation we find \\(S^*=0\\) or \\(I^*=0\\). We are not interested in \\(I^*=0\\) because we are interested in the endemic state which by definition has \\(I^*&gt;0\\), so we have \\(S^*=0\\). The third equation gives \\(R^*=\\gamma/\\delta I^*\\). Then \\(I^*\\) is found from the fact that \\(N=S^*+I^*+R^*\\) which gives \\(I^*=N-\\gamma/\\delta I^*\\). Solving for \\(I^*\\) gives \\[\nI^*=\\frac{N\\delta}{\\delta+\\gamma}.\n\\tag{8.56}\\]\nFor the stability analysis we reduce the problem to a two-dimensional system by eliminating \\(S\\) from the last two equations. This gives \\[\n\\begin{split}\n\\frac{dI}{dt} &= \\frac{\\beta I}{N} \\left(N-I-R\\right) - \\gamma I + \\delta R,\\\\\n\\frac{dR}{dt} &= \\gamma I - \\delta R.\n\\end{split}\n\\tag{8.57}\\] The Jacobian matrix is \\[\nA = \\begin{pmatrix}\n\\frac{\\beta}{N} \\left(N-2I-R\\right) -\\gamma & \\delta-\\frac{\\beta I}{N}\\\\\n\\gamma & -\\delta\n\\end{pmatrix}.\n\\tag{8.58}\\] Evaluated at the endemic state this gives \\[\nA = \\begin{pmatrix}\n-\\frac{\\beta}{N}I^* -\\gamma & \\delta-\\frac{\\beta}{N}I^*\\\\\n\\gamma & -\\delta\n\\end{pmatrix}.\n\\tag{8.59}\\] This has determinant and trace given by \\[\n\\begin{split}\n\\det(A) &= (\\delta+\\gamma)\\frac{\\beta}{N}I^*&gt;0,\\\\\n\\text{tr}(A) &= -\\frac{\\beta}{N}I^* -\\gamma -\\delta &lt;0.\n\\end{split}\n\\tag{8.60}\\] so the endemic state is stable for all positive values of the parameters.\n\n\n\n\nSIR model with reinfections\nExercise 6.4: The modified equations are \\[\n\\begin{split}\n\\frac{dS}{dt} &= -\\beta S I/N,\\\\\n\\frac{dI}{dt} &= \\beta S I/N - \\gamma I +\\beta\\mu R I/N,\\\\\n\\frac{dR}{dt} &= \\gamma I-\\beta\\mu R I/N.\n\\end{split}\n\\tag{8.61}\\] At the steady state all these derivatives have to vanish. From the first equation we find \\(S^*=0\\) or \\(I^*=0\\). We are not interested in \\(I^*=0\\) because we are interested in the endemic state which by definition has \\(I^*&gt;0\\), so we have \\(S^*=0\\). The third equation gives \\(R^*=\\gamma N/(\\beta\\mu)\\). Then \\(I^*\\) is found from the fact that \\(N=S^*+I^*+R^*\\) which gives \\[\nI^*=N-R^*=N\\left(1-\\frac{\\gamma}{\\beta\\mu}\\right).\n\\tag{8.62}\\] This is not the same as the number of infecteds in the endemic state of the model with loss of immunity given in Eq. 6.33.\n\n\n\nSex-structured SIR model\nExercise 6.5:\n\nAs \\(N=S+I+R\\) we have \\[\n\\frac{dN}{dt} = \\frac{dS}{dt}+\\frac{dI}{dt}+\\frac{dR}{dt} = -rSI'+rSI'-aI+aI=0.\n\\tag{8.63}\\] Hence, \\(N\\) is a constant. Similarly, \\(N'\\) is a constant.\nWe start by deriving an ODE for \\(S\\) as a function of \\(R'\\): \\[\n\\frac{dS}{dR'}=\\frac{dS}{dt}/ \\frac{dR'}{dt} = \\frac{-rSI'}{a'I'}=-\\frac{r}{a'}S.\n\\tag{8.64}\\] This is easy to solve: \\[\nS(t)=S_0e^{-\\frac{r}{a'}R'(t)}.\n\\tag{8.65}\\] Similarly, \\[\nS'(t)=S'_0e^{-\\frac{r'}{a}R(t)}.\n\\tag{8.66}\\]\nAt \\(t=\\infty\\) we have \\[\nS(\\infty)=S_0 e^{-\\frac{r}{a'}R'(\\infty)}.\n\\tag{8.67}\\] But at \\(t=\\infty\\), \\(I'=0\\) and \\(N'=S'+I'+R'\\) and so \\[\nS(\\infty)=S_0 e^{-\\frac{r}{a'}(N'-S'(\\infty))}.\n\\tag{8.68}\\] Similarly, \\[\nS'(\\infty)=S'_0 e^{-\\frac{r'}{a}(N-S(\\infty))}.\n\\tag{8.69}\\]",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#spatially-structured-population-models",
    "href": "solutions.html#spatially-structured-population-models",
    "title": "8  Solutions",
    "section": "8.7 Spatially-structured population models",
    "text": "8.7 Spatially-structured population models\n\nTravelling wave in 1-species reaction-diffusion model\nExercise 7.2:\n\nWith \\(z=x-ct\\) we have \\[\n\\frac{\\partial }{\\partial t}= \\frac{\\partial z}{\\partial t}\\frac{\\partial }{\\partial z} = -c \\frac{\\partial }{\\partial z} \\text{ and }\n\\frac{\\partial }{\\partial x}= \\frac{\\partial z}{\\partial x}\\frac{\\partial }{\\partial z} = \\frac{\\partial }{\\partial z}.\n\\tag{8.70}\\] Substituting this into the PDE gives the ODE \\[\n-cU' = f(U) + DU''.\n\\tag{8.71}\\]\nFor a travelling wave from left to right (\\(c&gt;0\\)) we expect solution at \\(\\pm \\infty\\) to be at steady state: \\(U(-\\infty) = 1\\) and \\(U(\\infty)=0\\), with \\(U'(\\pm \\infty)=0\\).\nWe will now use a slightly different way to approach the linearisation around the leading edge of the travelling wave than the one we used in the lecture. The methods are equivalent, and it is always instructional to look at different ways of doing the same thing.\nAt the leading edge of the wave we have that \\(U\\) is very small, so we can Taylor-expand \\(f(U)=f(0)+Uf'(0)+\\dots\\). We keep only the first two terms and also use that \\(f(0)=0\\) to get the linear ODE \\[\n-cU' = Uf'(0)+DU''.\n\\tag{8.72}\\] Rather than making an Ansatz for \\(U\\) as in the lecture, we convert this second order ODE into a set of first-order ODEs by introducing a second variable \\(V\\) so that \\(U'=V\\) and \\(V' = -\\frac{U}{D}f'(0) - \\frac{c}{D}V\\). In vector notation this reads \\[\n\\begin{pmatrix}\nU'\\\\\nV'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & 1\\\\\n-\\frac{f'(0)}{D}U & -\\frac{c}{D}\n\\end{pmatrix}\n\\begin{pmatrix}\nU\\\\\nV\n\\end{pmatrix}.\n\\tag{8.73}\\] The eigenvalues \\(\\lambda\\) of this linear matrix ODE are solutions of \\[\n\\det \\begin{pmatrix}\n-\\lambda & 1 \\\\ -\\frac{f'(0)}{D} & -\\lambda -\\frac{c}{D}\n\\end{pmatrix} = 0\n~~~~\\implies ~~~~\\lambda^2 + \\frac{c}{D} \\lambda + \\frac{f'(0)}{D}=0.\n\\tag{8.74}\\] Real eigenvalues and thus realistic biological solutions exist iff \\[\n\\frac{c^2}{D^2}-4\\frac{f'(0)}{D}\\geq 0, ~~~~\\implies ~~~~ c\\geq 2\\sqrt{Df'(0)}.\n\\tag{8.75}\\]\nIf \\(f(u)= 0\\) for all \\(u\\) we get \\(DU''+cU'=0\\). Setting \\(U(z)=e^{\\mu z}\\) \\(\\implies\\) \\(D\\mu^2+c\\mu\\) \\(\\implies\\) \\(\\mu = 0\\) or \\(-c/D\\). The general solution is \\(U=Ae^{-\\frac{c}{D} z}+B\\). Clearly \\(|U|\\rightarrow \\infty\\) as \\(z \\rightarrow -\\infty\\). This is not a biologically realistic solution.\n\n\n\nSIR model with logistic growth\nExercise 7.4:\n\nOne can either approach this systematically or one can just try to guess the necessary change of variables. We will use a blended approach: we guess the expressions for \\(u\\) and \\(v\\) by inspecting the equations, and we make a general Ansatz for \\(\\tilde{t}\\).\nBy comparing the \\((1-S/K)\\) factor in the equation for \\(S\\) to the factor \\((1-u)\\) in the equation for \\(u\\) we see that \\(u=S/K\\). It is natural to also choose \\(v=I/K\\). We write \\(\\tilde{t}=t/\\tau\\), where \\(\\tau\\) is still to be determined. With these we have \\[\\begin{split}\n\\partial_{\\tilde{t}}u&=\\tau/K\\partial_tS=\n\\tau/K\\left(rKu(1-u)-\\beta K^2uv\\right)\\\\\n&=\n\\tau r u(1-u)-\\tau \\beta K uv\n\\end{split} \\tag{8.76}\\] By comparing this with equation for \\(u\\) in the problem statement, we can read off that \\[\n\\tau = \\frac{1}{\\beta K}, ~~~b=\\frac{r}{\\beta K}.\n\\tag{8.77}\\] Then \\[\\begin{split}\n\\partial_{\\tilde{t}}v&=\\tau/K\\partial_tI=\n\\tau/K\\left(\\beta K^2uv-\\gamma Kv\\right)\\\\\n&=uv-\\frac{\\gamma}{\\beta K}v.\n\\end{split} \\tag{8.78}\\] By comparing this with the equation for \\(v\\) in the problem statement we read off that \\[\nm=\\frac{\\gamma}{\\beta K}.\n\\tag{8.79}\\]\nBy inspection we see that one steady state is \\((u(x,t),v(x,t))=(0,0)\\) and that another is \\[\n(u(x,t),v(x,t))=(1,0).\n\\tag{8.80}\\] The first describes a situation where the foxes are extinct, the second the situation where in the absence of the disease the fox population sits at its carrying capacity. We look for another steady state \\((u(x,t),v(x,t))=(u^*,v^*)\\) with \\(v^*\\neq 0\\). From the equation for \\(v\\) we read off that \\(u^*=m\\) and then from the equation for \\(u\\) we get \\(v^*=b(1-m)\\). This is the endemic state because the number of infecteds is non-zero. It exists as long as \\(m&lt;1\\). This tells us that the existence of the endemic state is independent of the intrinsic growth rate \\(r\\) of the fox population but does depend on its carrying capacity.\nWe know from part a. that \\(\\partial_{\\tilde t}u=\\partial_t S/(\\beta K^2)\\). Thus we now want \\(D_1\\partial_x^2 S/(\\beta K^2)=\\partial_{\\tilde{x}}^2 u\\), where \\(u=S/K\\). Hence \\[\n\\tilde{x}=\\sqrt{\\frac{K\\beta}{D_1}}x.\n\\tag{8.81}\\] Then \\(d\\,\\partial_{\\tilde{x}}^2v =d\\,D_1\\partial_x^2I\\) but we want \\(D_2\\partial_x^2I\\) so we need \\[\nd=\\frac{D_2}{D_1}.\n\\tag{8.82}\\]\nSubstituting the wave Ansatz into the PDEs for \\(u\\) and \\(v\\) gives \\[\\begin{split}\n-cA'&=bA(1-A)-AB+A''\\\\\n-cB'&=AB-mB+dB''.\n\\end{split} \\tag{8.83}\\]\nIf \\(A(\\infty)=1\\) (which corresponds to \\(S=K\\)) then that means that at \\(x=\\infty\\) the system is in the disease-free state and thus \\(B(\\infty)=0\\). At \\(x=-\\infty\\) the system must thus be in the endemic state, so \\(A(-\\infty)=u^*=m\\) and \\(B(-\\infty)=v^*=b(1-m)\\). So the key to this question was the observation that the travelling wave will always have to interpolate between two steady states.\nAt the leading edge where \\(B\\) is very small, \\(A\\) is very close to \\(1\\), so \\(A=1-\\epsilon\\) for a small \\(\\epsilon&gt;0\\). The equations Eq. 8.83 can thus be approximated by the linear equations \\[\nc\\epsilon'=b\\epsilon-B-\\epsilon'',~~~-cB'=B-mB+dB''.\n\\tag{8.84}\\] We obtained this by dropping all terms involving \\(\\epsilon^2\\) or \\(\\epsilon B\\) because they are negligible when \\(\\epsilon\\) and \\(B\\) are both small.\nWe concentrate on the second equation, which we solve with the Ansatz \\(B(x)=\\exp(\\lambda x)\\). Substituting this Ansatz into the equation gives the characteristic equation for \\(\\lambda\\): \\[\nd\\lambda^2+c\\lambda+1-m=0,\n\\tag{8.85}\\] and thus \\[\n\\lambda=\\frac{-c\\pm\\sqrt{c^2-4d(1-m)}}{2d}.\n\\tag{8.86}\\] We do not want the solution to oscillate, so we want \\(\\lambda\\) to be real, hence \\[\nc\\geq 2\\sqrt{d(1-m)}.\n\\tag{8.87}\\]\n\n\n\nDerive Turing instability\nExercise 7.5:\nHere, \\[\nf(u,v)=a-u + u^2v, ~~~~ g(u,v)=b-u^2v.\n\\tag{8.88}\\]\nStep 1. Uniform steady state\n\\[\na-u^* + {u^*}^2 v^*=0~\\text{ and }~b-{u^*}^2 v^*=0\n\\tag{8.89}\\] implies \\[\n(u^*,~v^*)=(a+b,~b/(a+b)^2).\n\\tag{8.90}\\]\nStep 2. Linearise\nSet \\(u=u^*+\\xi\\) and \\(v=v^*+\\eta\\) with \\(\\xi\\) and \\(\\eta\\) small. Substitute and Taylor expand to get \\[\n\\begin{pmatrix}\n\\frac{\\partial \\xi}{\\partial t} \\\\ \\frac{\\partial \\eta}{\\partial t}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\na_{11} & a_{12} \\\\a_{21} & a_{22}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\xi \\\\ \\eta\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nD_1 \\frac{\\partial^2 \\xi}{\\partial x^2} \\\\ D_2\\frac{\\partial^2 \\eta}{\\partial x^2}\n\\end{pmatrix},\n\\tag{8.91}\\] where \\[\n\\begin{split}\na_{11} = \\frac{\\partial f}{\\partial u}(u^*,v^*) &= -1+2u^*v^* \\\\\n&= -1+2(a+b)b/(a+b)^2 \\\\\n&=(b-a)/(a+b)\\\\\na_{12} = \\frac{\\partial f}{\\partial v}(u^*,v^*) &= {u^*}^2 =(a+b)^2\\\\\na_{21} = \\frac{\\partial g}{\\partial u}(u^*,v^*) &= -2 u^* v^* =-2b/(a+b)\\\\\na_{22} = \\frac{\\partial g}{\\partial v}(u^*,v^*) &= -{u^*}^2 =-(a+b)^2\n\\end{split}\n\\tag{8.92}\\]\nStep 3. Solutions\nMake the Ansatz \\(\\xi = A_1 e^{\\sigma t} \\sin( kx+\\alpha)\\) and \\(\\eta = A_2 e^{\\sigma t} \\sin( kx+\\alpha)\\). Substitute to get \\[\n\\begin{pmatrix}\n\\sigma - \\frac{b-a}{a+b} +D_1k^2 & -(a+b)^2 \\\\  \n\\frac{2b}{a+b} & \\sigma + (a+b)^2 +D_2k^2\n\\end{pmatrix}\n\\begin{pmatrix}\nA_1 \\\\ A_2\n\\end{pmatrix}=\n{\\mathbf 0}\n\\tag{8.93}\\] For a non-trivial solution we require the determinant of this matrix to be zero (otherwise we would be able to find an inverse, etc.). Hence, \\[\n\\sigma^2 + \\left[ (a+b)^2 - \\frac{b-a}{a+b} + (D_1+D_2)k^2  \\right] \\sigma + h(k^2) = 0,\n\\tag{8.94}\\] where \\[\nh(k^2)= D_1D_2k^4 - \\left[ D_2\\frac{b-a}{a+b} - D_1(a+b)^2  \\right] k^2 +(a+b)^2.\n\\tag{8.95}\\]\nStep 4. In the absence of diffusion (Put \\(D_1=0=D_2\\).) \\[\n\\sigma^2 + \\left[ (a+b)^2 - \\frac{b-a}{a+b} \\right] \\sigma + (a+b)^2 = 0.\n\\tag{8.96}\\] For \\(\\sigma\\) to have roots in the left half of the complex plane (giving us a stable steady state) we need \\((a+b)^2-\\frac{b-a}{a+b}&gt;0 ~\\implies ~ b-a&lt;(a+b)^3\\) and \\((a+b)^2&gt;0\\) (which it is).\nStep 5. With diffusion (\\(D_1\\neq 0\\neq D_2\\).)\nWe want steady state to be unstable in this case. The coefficient of \\(\\sigma\\) is \\[\n(a+b)^2 - \\frac{b-a}{a+b} + (D_1+D_2)k^2 &gt; (D_1+D_2)k^2&gt;0 ~~~~\\mbox{from Step 4}\n\\tag{8.97}\\] Therefore, we require \\(h(k^2)&lt;0\\) for some \\(k^2\\) for there to be an instability.\nAs \\(h(0)&gt;0\\) we must have two positive real roots of \\(h(k^2)=0\\) for there to be an instability.\nReal distinct roots (\\(\\implies ~~B^2-4AC&gt;0\\)) \\[\n\\implies \\left[ D_2\\frac{b-a}{a+b} - D_1(a+b)^2  \\right]^2&gt; 4D_1D_2 (a+b)^2.\n\\tag{8.98}\\] Both positive (\\(\\implies B&lt;0\\)) \\[\n\\implies D_2\\frac{b-a}{a+b} - D_1(a+b)^2 &gt; 0.\n\\tag{8.99}\\]",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  },
  {
    "objectID": "solutions.html#footnotes",
    "href": "solutions.html#footnotes",
    "title": "8  Solutions",
    "section": "",
    "text": "If \\(\\lambda\\geq p\\), then \\(\\psi(\\lambda)\\) diverges and does not satisfy the Euler-Lotka equation \\(\\psi(\\lambda)=1\\).↩︎",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Solutions</span>"
    ]
  }
]