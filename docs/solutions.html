<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Work in progress">

<title>8&nbsp; Solutions – Mathematical Ecology and Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./spatial.html" rel="prev">
<link href="./virus.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2b37b0a2d7675c40fc14763bc2dd14a3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="8&nbsp; Solutions – Mathematical Ecology and Epidemiology">
<meta property="og:description" content="Work in progress">
<meta property="og:image" content="figures/Solutions/vonBertalanffy_growth.png">
<meta property="og:site_name" content="Mathematical Ecology and Epidemiology">
<meta name="twitter:title" content="8&nbsp; Solutions – Mathematical Ecology and Epidemiology">
<meta name="twitter:description" content="Work in progress">
<meta name="twitter:image" content="figures/Solutions/vonBertalanffy_growth.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./solutions.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solutions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Ecology and Epidemiology</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://vle.york.ac.uk/ultra/courses/_111662_1/outline" title="VLE" class="quarto-navigation-tool px-1" aria-label="VLE"><i class="bi bi-house-door-fill"></i></a>
    <a href="https://maths.york.ac.uk/moodle/course/view.php?id=2726" title="Moodle quizzes" class="quarto-navigation-tool px-1" aria-label="Moodle quizzes"><i class="bi bi-mortarboard-fill"></i></a>
    <a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./continuous_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Continuous-time population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Discrete-time population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interacting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interacting populations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sex_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sex-structured population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./age_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Age-structured population model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./epidemics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Epidemics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatially-structured populations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solutions</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#continuous-time-population-models" id="toc-continuous-time-population-models" class="nav-link active" data-scroll-target="#continuous-time-population-models"><span class="header-section-number">8.1</span> Continuous-time population models</a>
  <ul>
  <li><a href="#von-bertalanffy-growth" id="toc-von-bertalanffy-growth" class="nav-link" data-scroll-target="#von-bertalanffy-growth">Von Bertalanffy growth</a></li>
  <li><a href="#solving-logistic-equation" id="toc-solving-logistic-equation" class="nav-link" data-scroll-target="#solving-logistic-equation">Solving logistic equation</a></li>
  <li><a href="#harvesting-with-fixed-quota" id="toc-harvesting-with-fixed-quota" class="nav-link" data-scroll-target="#harvesting-with-fixed-quota">Harvesting with fixed quota</a></li>
  <li><a href="#wasp-model" id="toc-wasp-model" class="nav-link" data-scroll-target="#wasp-model">Wasp model</a></li>
  <li><a href="#wasp-model-with-death" id="toc-wasp-model-with-death" class="nav-link" data-scroll-target="#wasp-model-with-death">Wasp model with death</a></li>
  </ul></li>
  <li><a href="#discrete-time-population-models" id="toc-discrete-time-population-models" class="nav-link" data-scroll-target="#discrete-time-population-models"><span class="header-section-number">8.2</span> Discrete-time population models</a>
  <ul>
  <li><a href="#verhulst-model" id="toc-verhulst-model" class="nav-link" data-scroll-target="#verhulst-model">Verhulst model</a></li>
  </ul></li>
  <li><a href="#sex-structured-population-models" id="toc-sex-structured-population-models" class="nav-link" data-scroll-target="#sex-structured-population-models"><span class="header-section-number">8.3</span> Sex-structured population models</a>
  <ul>
  <li><a href="#dominance-structure" id="toc-dominance-structure" class="nav-link" data-scroll-target="#dominance-structure">Dominance structure</a></li>
  </ul></li>
  <li><a href="#age-structured-population-models" id="toc-age-structured-population-models" class="nav-link" data-scroll-target="#age-structured-population-models"><span class="header-section-number">8.4</span> Age-structured population models</a>
  <ul>
  <li><a href="#spotted-owl" id="toc-spotted-owl" class="nav-link" data-scroll-target="#spotted-owl">Spotted owl</a></li>
  <li><a href="#seasonal-mortality" id="toc-seasonal-mortality" class="nav-link" data-scroll-target="#seasonal-mortality">Seasonal mortality</a></li>
  </ul></li>
  <li><a href="#interacting-populations" id="toc-interacting-populations" class="nav-link" data-scroll-target="#interacting-populations"><span class="header-section-number">8.5</span> Interacting populations</a></li>
  <li><a href="#epidemics" id="toc-epidemics" class="nav-link" data-scroll-target="#epidemics"><span class="header-section-number">8.6</span> Epidemics</a>
  <ul>
  <li><a href="#sir-with-recrudescence" id="toc-sir-with-recrudescence" class="nav-link" data-scroll-target="#sir-with-recrudescence">SIR with recrudescence</a></li>
  <li><a href="#sir-model-with-reinfections" id="toc-sir-model-with-reinfections" class="nav-link" data-scroll-target="#sir-model-with-reinfections">SIR model with reinfections</a></li>
  <li><a href="#sex-structured-sir-model" id="toc-sex-structured-sir-model" class="nav-link" data-scroll-target="#sex-structured-sir-model">Sex-structured SIR model</a></li>
  </ul></li>
  <li><a href="#spatially-structured-population-models" id="toc-spatially-structured-population-models" class="nav-link" data-scroll-target="#spatially-structured-population-models"><span class="header-section-number">8.7</span> Spatially-structured population models</a>
  <ul>
  <li><a href="#travelling-wave-in-1-species-reaction-diffusion-model" id="toc-travelling-wave-in-1-species-reaction-diffusion-model" class="nav-link" data-scroll-target="#travelling-wave-in-1-species-reaction-diffusion-model">Travelling wave in 1-species reaction-diffusion model</a></li>
  <li><a href="#sir-model-with-logistic-growth" id="toc-sir-model-with-logistic-growth" class="nav-link" data-scroll-target="#sir-model-with-logistic-growth">SIR model with logistic growth</a></li>
  <li><a href="#derive-turing-instability" id="toc-derive-turing-instability" class="nav-link" data-scroll-target="#derive-turing-instability">Derive Turing instability</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/edit/main/solutions.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solutions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This appendix holds the solutions to selected exercises in the book. Please look at these solutions only after having made a serious attempt at solving the exercises and knowing exactly where you got stuck.</p>
<section id="continuous-time-population-models" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="continuous-time-population-models"><span class="header-section-number">8.1</span> Continuous-time population models</h2>
<!----
### @exr-sketch_solutions {.unnumbered}
*Sketching solutions*

See solution sheet published on Moodle.
--->
<section id="von-bertalanffy-growth" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="von-bertalanffy-growth">Von Bertalanffy growth</h3>
<p><a href="continuous_time.html#exr-vonBertalanffy-growth" class="quarto-xref">Exercise&nbsp;<span>1.4</span></a>:</p>
<ol type="i">
<li>Seeking a steady state we find <span class="math inline">\(\alpha w^{2/3}-\beta w = 0\)</span> <span class="math inline">\(\implies\)</span> <span class="math inline">\(w^{2/3}(\alpha-\beta w^{1/3})=0\)</span> <span class="math inline">\(\implies\)</span> <span class="math inline">\(w=0\)</span> or <span class="math inline">\(w^{1/3} = \alpha/\beta\)</span>. With the graphical approach in <a href="#fig-vonBertalanffy-growth" class="quarto-xref">Figure&nbsp;<span>8.1</span></a> we see that the non-zero steady state is stable. Hence, <span id="eq-ex_vonBertalanffy_growth"><span class="math display">\[
\lim_{t \rightarrow \infty} w(t) = \left( \frac{\alpha}{\beta} \right)^{3}.
\tag{8.1}\]</span></span></li>
</ol>
<div id="fig-vonBertalanffy-growth" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vonBertalanffy-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Solutions/vonBertalanffy_growth.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vonBertalanffy-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: <span class="math inline">\(dw/dt\)</span> versus <span class="math inline">\(w\)</span> for the von Bertalanffy growth model.
</figcaption>
</figure>
</div>
<ol start="2" type="i">
<li><p>For the time derivative of <span class="math inline">\(u=w^{1/3}\)</span> we find by the chain rule that <span id="eq-ex_vonBertalanffy_growth2"><span class="math display">\[
\frac{du}{dt} = \frac13 w^{-2/3} \frac{dw}{dt} = \frac{1}{3u^2}\left( \alpha w^{2/3}-\beta w \right).
\tag{8.2}\]</span></span> Hence <span id="eq-ex_vonBertalanffy_growth3"><span class="math display">\[
3\frac{du}{dt} = \frac{1}{u^2}\left( \alpha u^2-\beta u^3 \right) = \alpha-\beta u.
\tag{8.3}\]</span></span> So this change of variables has yielded a linear first-order ODE with constant coefficients, which is easy for us to solve: <span id="eq-ex_vonBertalanffy_growth4"><span class="math display">\[
u(t) = \frac{1}{\beta} \left( \alpha  - Ae^{-\beta t/3}\right)
\tag{8.4}\]</span></span> for some integration constant <span class="math inline">\(A\)</span>. If <span class="math inline">\(u(0)=u_0\)</span> then <span class="math inline">\(A=\alpha -\beta u_0\)</span>.</p></li>
<li><p>Translating back to <span class="math inline">\(w\)</span> with <span class="math inline">\(w_0=u_0^3\)</span> we finally have <span id="eq-ex_vonBertalanffy_growth5"><span class="math display">\[
w(t) = u(t)^3 = \frac{1}{\beta^3}\left( \alpha - \left( \alpha - \beta w_0^{1/3} \right) e^{-\beta t/3}  \right)^3.
\tag{8.5}\]</span></span></p></li>
</ol>
<hr>
</section>
<section id="solving-logistic-equation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="solving-logistic-equation">Solving logistic equation</h3>
<p><a href="continuous_time.html#exr-logistic_solution" class="quarto-xref">Exercise&nbsp;<span>1.2</span></a>: We separate the variables by dividing both sides of the ODE by <span class="math inline">\(N(1-N/K)\)</span> and multiplying by <span class="math inline">\(dt\)</span>, and then integrate to get <span id="eq-ex_logistic_solution"><span class="math display">\[
\int_{N_0}^{N(t)}\frac{dN}{N\left(1-\frac{N}{K}\right)}=\int_0^t r\,dt.
\tag{8.6}\]</span></span> The right hand side is trivial to integrate, but for the integral on the left-hand side we need to employ the method of partial fractions, using that <span id="eq-ex_logistic_solution2"><span class="math display">\[
\frac{dN}{N\left(1-\frac{N}{K}\right)}=\frac{1}{N}+\frac{1}{K-N}.
\tag{8.7}\]</span></span> The left-hand side then gives <span id="eq-ex_logistic_solution3"><span class="math display">\[
\begin{split}
\int_{N_0}^{N(t)}&amp;\left(\frac{1}{N}+\frac{1}{K-N(t)}\right)dN\\
&amp;=\log N(t)-\log N_0-\log(K-N(t))+\log(K-N_0).
\end{split}
\tag{8.8}\]</span></span> We exponentiate both sides to get <span id="eq-ex_logistic_solution4"><span class="math display">\[
\frac{N(t)}{N_0}\frac{K-N_0}{K-N(t)}=e^{rt}.
\tag{8.9}\]</span></span> Now we just need to solve for <span class="math inline">\(N(t)\)</span>: <span id="eq-ex_logistic_solution5"><span class="math display">\[
N(t)=\frac{N_0Ke^{rt}}{K+N_0(e^{rt}-1)}.
\tag{8.10}\]</span></span></p>
<!---
### @exr-harvest_effort {.unnumbered}
*Harvesting with fixed effort*

See solution sheet on Moodle.
--->
<hr>
</section>
<section id="harvesting-with-fixed-quota" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="harvesting-with-fixed-quota">Harvesting with fixed quota</h3>
<p>**<a href="continuous_time.html#exr-harvest_quota" class="quarto-xref">Exercise&nbsp;<span>1.6</span></a>: If we harvest with a fixed quota <span class="math inline">\(Q\)</span>, the population is described by the equation <span id="eq-ex_harvest_quota"><span class="math display">\[
\frac{dN}{dt} = \alpha N \log\frac{K}{N} - Q.
\tag{8.11}\]</span></span> The subtraction of <span class="math inline">\(Q\)</span> shifts the graph of the right-hand side down by a distance <span class="math inline">\(Q\)</span>. This brings the non-zero fixed points closer together until <span class="math inline">\(Q\)</span> is equal to the maximum of the growth rate of the unfished population. If <span class="math inline">\(Q\)</span> is increased beyond this value the non-zero fixed points disappear and the population will go extinct. is because we are removing <span class="math inline">\(Q\)</span> individuals from the population at a constant rate. Thus the maximum sustainable yield occurs when <span class="math inline">\(Q\)</span> equals the maximum replenishment rate of the unfished population. To find that maximum we first solve <span id="eq-ex_harvest_quota2"><span class="math display">\[
0=\frac{d}{dN}\left(\alpha N \log\frac{K}{N}\right)=\alpha\left(\log\frac{K}{N}-1\right).
\tag{8.12}\]</span></span> This tells us that the maximum is at <span id="eq-ex_harvest_quota3"><span class="math display">\[
N_{max} = K\,e^{-1}.
\tag{8.13}\]</span></span> Hence the value at the maximum is <span id="eq-ex_harvest_quota4"><span class="math display">\[
MSY=Q_{max}=\alpha N_{max} \log\frac{K}{N_{max}}=\alpha\,K\,e^{-1}.
\tag{8.14}\]</span></span> Fishing at this quota is not wise, as this reduces the population to the threshold level below which the population will go extinct.</p>
<hr>
</section>
<section id="wasp-model" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="wasp-model">Wasp model</h3>
<p><a href="continuous_time.html#exr-Hornet" class="quarto-xref">Exercise&nbsp;<span>1.7</span></a>: For <span class="math inline">\(0\leq t\leq t_c\)</span> the number of workers satisfies <span id="eq-ex-wasp"><span class="math display">\[
\frac{dn}{dt}=r\,n.
\tag{8.15}\]</span></span> Therefore <span id="eq-ex-wasp2"><span class="math display">\[
n(t)=n_0e^{r\,t}.
\tag{8.16}\]</span></span></p>
<p>For <span class="math inline">\(t_c\leq t\leq T\)</span> the number of reproducers satisfies <span id="eq-ex-wasp3"><span class="math display">\[
\frac{dN}{dt}=Rn(t_c)=R\,n_0\,e^{r\,t_c},
\tag{8.17}\]</span></span> so that <span id="eq-ex-wasp4"><span class="math display">\[
N(T)=(T-t_c)R\,e^{r\,t_c}.
\tag{8.18}\]</span></span></p>
<p>To find the value of <span class="math inline">\(t_c\)</span> that maximises <span class="math inline">\(N(T)\)</span> we set the derivative of <span class="math inline">\(N(T)\)</span> with respect to <span class="math inline">\(t_c\)</span> to zero: <span id="eq-ex-wasp5"><span class="math display">\[
\begin{split}
0&amp;=\frac{d}{dt_c}N(T)=\frac{d}{dt_c}(T-t_c)R\,e^{r\,t_c}\\
&amp;=-R\,e^{r\,t_c}+(T-t_c)R\,r\,e^{r\,t_c}\\
&amp;=R\,e^{r\,t_c}(r\,T-r\,t_c-1).
\end{split}
\tag{8.19}\]</span></span> This implies that <span id="eq-ex-wasp6"><span class="math display">\[
t_c=T-\frac{1}{r}.
\tag{8.20}\]</span></span></p>
<hr>
</section>
<section id="wasp-model-with-death" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="wasp-model-with-death">Wasp model with death</h3>
<p><a href="continuous_time.html#exr-wasp_death" class="quarto-xref">Exercise&nbsp;<span>1.8</span></a>: For <span class="math inline">\(0\leq t\leq t_c\)</span> the number of workers satisfies <span id="eq-wasp_death"><span class="math display">\[
\frac{dn}{dt}=(r-d)n.
\tag{8.21}\]</span></span> Therefore <span id="eq-wasp_death2"><span class="math display">\[
n(t)=e^{(r-d)t}.
\tag{8.22}\]</span></span> For <span class="math inline">\(t_c\leq t\leq T\)</span> we have <span id="eq-wasp_death3"><span class="math display">\[
\frac{dn}{dt}=-dn
\tag{8.23}\]</span></span> so that <span id="eq-wasp_death4"><span class="math display">\[
n(t)=n(t_c)e^{-d(t-t_c)}=e^{(r-d)t}e^{-d(t-t_c)}=e^{r\,t_c}e^{-d\,t}.
\tag{8.24}\]</span></span> Also for <span class="math inline">\(t_c\leq t\leq T\)</span> the number of reproducers satisfies <span id="eq-wasp_death5"><span class="math display">\[
\frac{dN}{dt}=Rn(t)=Re^{r\,t_c}e^{-d\,t},
\tag{8.25}\]</span></span> so that <span id="eq-wasp_death6"><span class="math display">\[
N(T)=\int_{t_c}^TRe^{r\,t_c}e^{-d\,t}dt = \frac{R}{d}e^{r\,t_c}\left(e^{-d\,t_c}-e^{-d\,T}\right).
\tag{8.26}\]</span></span> To find the value of <span class="math inline">\(t_c\)</span> that maximises <span class="math inline">\(N(T)\)</span> we set the derivative of <span class="math inline">\(N(T)\)</span> with respect to <span class="math inline">\(t_c\)</span> to zero: <span id="eq-wasp_death7"><span class="math display">\[
\begin{split}
0&amp;=\frac{d}{dt_c}N(T)=\frac{d}{dt_c}\left( \frac{R}{d}e^{r\,t_c}\left(e^{-d\,t_c}-e^{-d\,T}\right)\right)\\
&amp;=Re^{r\,t_c}\left(\left(\frac{r}{d}-1\right)e^{-d\,t_c}-\frac{r}{d}e^{-d\,T}\right).
\end{split}
\tag{8.27}\]</span></span> This is equivalent to <span id="eq-wasp_death8"><span class="math display">\[
e^{-d\,t_c}=\frac{1}{1-d/r}e^{-d\,T}
\tag{8.28}\]</span></span> and thus <span id="eq-wasp_death9"><span class="math display">\[
t_c=T+\frac{1}{d}\ln\left(1-\frac{d}{r}\right).
\tag{8.29}\]</span></span></p>
<hr>
</section>
</section>
<section id="discrete-time-population-models" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="discrete-time-population-models"><span class="header-section-number">8.2</span> Discrete-time population models</h2>
<section id="verhulst-model" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="verhulst-model">Verhulst model</h3>
<p><a href="discrete_time.html#exr-discrete_logistic" class="quarto-xref">Exercise&nbsp;<span>2.3</span></a>: Let’s write the equation as <span class="math inline">\(N_{t+1}=f(N_t)\)</span> with <span id="eq-ex-discrete_logistic"><span class="math display">\[
f(N)=rN\left(1-\frac{N}{K}\right).
\tag{8.30}\]</span></span></p>
<p>Because <span class="math inline">\(f(N)\)</span> is positive for all <span class="math inline">\(N&lt;K\)</span>, the only way for <span class="math inline">\(N_{t+1}\)</span> to be negative is for <span class="math inline">\(N_t\)</span> to be greater than <span class="math inline">\(K\)</span>. This in turn is only possible if <span class="math inline">\(f(N_{t-1})&gt;K\)</span>. So the function <span class="math inline">\(f\)</span> at its maximum needs to be larger than <span class="math inline">\(K\)</span>. Because the function describes an upside-down parabola with zeros at <span class="math inline">\(0\)</span> and <span class="math inline">\(K\)</span>, its maximum is in the middle at <span class="math inline">\(N=K/2\)</span>, where <span class="math inline">\(f(K/2)=rK/4\)</span>. Thus the population can get negative iff <span class="math inline">\(rK/4&gt;K\)</span>, which is equivalent to <span class="math inline">\(r&gt;4\)</span>.</p>
<hr>
</section>
</section>
<section id="sex-structured-population-models" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="sex-structured-population-models"><span class="header-section-number">8.3</span> Sex-structured population models</h2>
<section id="dominance-structure" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="dominance-structure">Dominance structure</h3>
<p><a href="sex_structured.html#exr-ss2" class="quarto-xref">Exercise&nbsp;<span>4.2</span></a>:</p>
<ol type="a">
<li>The ratio <span class="math inline">\(F/Q\)</span> in the negative term in the equation for the alpha females represents the fact that if the ratio between the subordinate individuals who gather the food and the alpha females who rely on that food is too small, then the alpha females don’t get enough food and hence are less fit, leading to either a decreased birth rate or an increased mortality rate.</li>
</ol>
<ol start="2" type="a">
<li><p>We derive the ODE: <span id="eq-ex_ss2"><span class="math display">\[\begin{split}
\frac{d}{dt}\frac{F}{Q }&amp;=\frac{F'Q -FQ'}{Q ^2}\\
&amp;=
\frac{(b_F-\mu_F F/Q )F Q-F(b_Q F-\mu_Q  Q )}{Q ^2}\\
&amp;=(b_F+\mu_Q )\frac{F}{Q }\left(1-\frac{b_Q +\mu_F}{b_F+\mu_Q }\frac{F}{Q }\right).
\end{split} \tag{8.31}\]</span></span> Ideally you identify this as the logistic equation with initial growth rate <span class="math inline">\(r\)</span> and carrying capacity <span class="math inline">\(K\)</span> given by <span id="eq-rK"><span class="math display">\[
r=b_F+\mu_Q ,~~~K=\frac{b_F+\mu_Q }{b_Q +\mu_F}.
\tag{8.32}\]</span></span> You can then look up the solution in the lecture notes: <span id="eq-ex_ss2sol"><span class="math display">\[
\frac{F}{Q }(t)=\frac{\frac{F_0}{Q_0}Ke^{rt}}{K+\frac{F_0}{Q_0}\left(e^{rt}-1\right)}.
\tag{8.33}\]</span></span> Otherwise you have to work a bit harder.</p></li>
<li><p>Because we have identified <span class="math inline">\(F/Q (t)\)</span> as the solution of a logistic equation it is easy to see that as <span class="math inline">\(t\to\infty\)</span>, <span class="math inline">\(F/Q \to K\)</span> with <span class="math inline">\(K\)</span> as in <a href="#eq-rK" class="quarto-xref">Eq.&nbsp;<span>8.32</span></a>.</p></li>
<li><p>We derive the ODE: <span id="eq-ex_ss2b"><span class="math display">\[\begin{split}
\frac{d}{dt}\frac{F}{M}&amp;=\frac{F'M-FM'}{M^2}\\
&amp;=
\frac{(b_F-\mu_F F/Q )FM-F(b_MF-\mu_M M)}{M^2}\\
&amp;=\frac{F}{M}\left(b_F+\mu_M-\mu_F\frac{F}{Q }-b_M\frac{F}{M}\right).
\end{split} \tag{8.34}\]</span></span> We are only interested in the limit of <span class="math inline">\(F/M\)</span> as <span class="math inline">\(t\to\infty\)</span>. Let us denote this limit by <span class="math inline">\(R\)</span>. We already know that the limit of <span class="math inline">\(F/Q\)</span> as <span class="math inline">\(t\to\infty\)</span> is <span class="math inline">\(K\)</span>. The limit of the previous equation gives <span id="eq-ex_ss2c"><span class="math display">\[
0=\frac{d}{dt}R=R\left(b_F+\mu_M-\mu_FK-b_MR\right)
\tag{8.35}\]</span></span> and hence <span id="eq-ex_ss2d"><span class="math display">\[
R=\frac{b_F+\mu_M-\mu_FK}{b_M}.
\tag{8.36}\]</span></span> Substituting the expression for <span class="math inline">\(K\)</span> and bringing everything on a common denominator gives <span id="eq-ex_ss2e"><span class="math display">\[
R=\frac{(b_F+\mu_M)(b_Q +\mu_F)-\mu_F(b_F+\mu_Q )}{b_M(b_Q +\mu_F)}
\tag{8.37}\]</span></span> To see that this is always positive we multiply out the numerator: <span id="eq-ex_ss2f"><span class="math display">\[
R=\frac{b_Fb_Q +\mu_Mb_Q +\mu_M\mu_F-\mu_F\mu_Q }{b_M(b_Q +\mu_F)}
\tag{8.38}\]</span></span> This is positive because <span class="math inline">\(b_Fb_Q &gt;\mu_F\mu_Q\)</span></p></li>
<li><p>The birth rates are linear in the number of alpha females and independent of <span class="math inline">\(M\)</span> and <span class="math inline">\(Q\)</span>. Independence of <span class="math inline">\(M\)</span> is realistic only if <span class="math inline">\(M\)</span> is large. Using a weighted mean might be better, i.e., birth rates given by <span class="math inline">\(b_i FM/(F/n+M)\)</span>, where <span class="math inline">\(n\)</span> is the number of females a male can mate with per mating season. Or we could take into account that the alpha females will reproduce less if there are fewer subordinate individuals gathering food for them, for example by choosing birth rates to be given by <span class="math inline">\(b_i F Q/(F/n+Q )\)</span>, where <span class="math inline">\(n\)</span> is the number of pregnant females that a subordinate monkey can keep well fed. There are many other possible improvements.</p></li>
</ol>
<hr>
</section>
</section>
<section id="age-structured-population-models" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="age-structured-population-models"><span class="header-section-number">8.4</span> Age-structured population models</h2>
<section id="spotted-owl" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="spotted-owl">Spotted owl</h3>
<p><a href="age_structured.html#exr-spotted_owl" class="quarto-xref">Exercise&nbsp;<span>5.1</span></a>:</p>
<ol type="1">
<li><p>The given values of the survival probabilities from year to year lead to the following values of the survival probabilities from birth to age <span class="math inline">\(a\)</span>: <span id="eq-a32"><span class="math display">\[
l_a = \begin{cases}
1 &amp; \text{if } a = 1, \\
l\, p^{a-2} &amp; \text{if } a \geq 2.
\end{cases}
\tag{8.39}\]</span></span></p></li>
<li><p>Substituting these values into the expression for <span class="math inline">\(\psi(\lambda)\)</span> in <a href="age_structured.html#eq-a29" class="quarto-xref">Eq.&nbsp;<span>5.31</span></a> gives <span id="eq-a33"><span class="math display">\[
\begin{split}
\psi(\lambda) &amp;= b l \sum_{a=2}^\infty p^{a-2} \lambda^{-a} = lb\lambda^{-2}\sum_{n=0}^\infty \frac{p}{\lambda}\\
&amp;= lb\lambda^{-2}\frac{1}{1-\frac{p}{\lambda}}
=\frac{lb}{\lambda(\lambda-p)},
\end{split}
\tag{8.40}\]</span></span> where we made use of the formula for a geometric series, valid if <span class="math inline">\(|p/\lambda|&lt;1\)</span> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. In particular, the expected number of offspring produced by an individual in their lifetime is <span class="math display">\[
\psi(1)=lb/(1-p).
\]</span></p></li>
</ol>
<p>If this is greater than <span class="math inline">\(1\)</span>, then the population grows exponentially. If it is less than <span class="math inline">\(1\)</span>, then the population goes extinct.</p>
<p>In this case the Euler-Lotka equation <span class="math inline">\(\psi(\lambda)=1\)</span> becomes the quadratic equation for <span class="math inline">\(\lambda\)</span>: <span id="eq-a34"><span class="math display">\[
\psi(\lambda)=\frac{lb}{\lambda(\lambda-p)}=1 \quad \Leftrightarrow \quad \lambda^2 - \lambda p - lb = 0.
\tag{8.41}\]</span></span> The solutions are <span id="eq-a35"><span class="math display">\[
\lambda_\pm = \frac{p \pm \sqrt{p^2 + 4lb}}{2}.
\tag{8.42}\]</span></span> We are interested in the positive solution <span class="math inline">\(\lambda_+\)</span>. Substituting this value for <span class="math inline">\(\lambda\)</span> back into <a href="age_structured.html#eq-a26" class="quarto-xref">Eq.&nbsp;<span>5.17</span></a> and <a href="age_structured.html#eq-ab19" class="quarto-xref">Eq.&nbsp;<span>5.13</span></a> we see that we have found the solution <span id="eq-a36"><span class="math display">\[
N_{a,t} = \left(\frac{p + \sqrt{p^2 + 4lb}}{2}\right)^{t-a}l_a N_{0,0}
\tag{8.43}\]</span></span> for any choice of <span class="math inline">\(N_{0,0}\)</span>.</p>
<hr>
</section>
<section id="seasonal-mortality" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="seasonal-mortality">Seasonal mortality</h3>
<p><a href="age_structured.html#exr-seasonal_mortality" class="quarto-xref">Exercise&nbsp;<span>5.6</span></a>:</p>
<ol type="a">
<li><p>Substituting <span class="math inline">\(n(t,a)=p(t)r(a)\)</span> into <a href="age_structured.html#eq-a3" class="quarto-xref">Eq.&nbsp;<span>5.36</span></a> and dividing by <span class="math inline">\(n(t,a)\)</span> gives <span id="eq-ex_seasonal_mortality"><span class="math display">\[
\frac{p'(t)}{p(t)}+\frac{r'(a)}{r(a)}=-\mu(a)-f(t).
\tag{8.44}\]</span></span> Separating variables gives <span id="eq-ex_seasonal_mortality2"><span class="math display">\[
\frac{p'(t)}{p(t)}+f(t)=-\frac{r'(a)}{r(a)}-\mu(a).
\tag{8.45}\]</span></span> As the left-hand side is independent of <span class="math inline">\(a\)</span> and the right-hand side is independent of <span class="math inline">\(t\)</span>, both sides must be equal to some constant <span class="math inline">\(\gamma\)</span>. This gives us the two ODEs <span id="eq-ex_seasonal_mortality3"><span class="math display">\[
\frac{d}{dt}\log(p(t))=\gamma-f(t),~~~\frac{d}{da}\log(r(a))=-\gamma-\mu(t).
\tag{8.46}\]</span></span> These have the solutions <span id="eq-ex_seasonal_mortality4"><span class="math display">\[
\begin{split}
p(t)&amp;=p(0)\exp\left(\int_0^t\gamma-f(s)\,ds\right),\\
r(a)&amp;=r(0)\exp\left(-\int_0^a\gamma+\mu(s)\,ds\right)
\end{split}
\tag{8.47}\]</span></span> Thus the solution for <span class="math inline">\(n\)</span> is <span id="eq-ex_seasonal_mortality5"><span class="math display">\[
n(t,a)=n(0,0)\exp\left(\int_0^t\gamma-f(s)\,ds\right)
\exp\left(-\int_0^a\gamma+\mu(s)\,ds\right).
\tag{8.48}\]</span></span></p></li>
<li><p>Substituting the solution into <a href="age_structured.html#eq-a4" class="quarto-xref">Eq.&nbsp;<span>5.37</span></a> gives <span id="eq-ex_seasonal_mortality6"><span class="math display">\[
p(t)r(0)=\int_0^\infty b(a)p(t)r(a)\,da.
\tag{8.49}\]</span></span> After dividing by <span class="math inline">\(p(t)r(0)\)</span> and using our expression for <span class="math inline">\(r(a)\)</span> from the previous part, <span id="eq-ex_seasonal_mortality7"><span class="math display">\[
1=\int_0^\infty b(a) \exp\left(-\int_0^a\gamma+\mu(s)ds\right)da
=\phi(\gamma).
\tag{8.50}\]</span></span> The factor <span class="math inline">\(\exp(-\gamma a)\)</span> in the integrand decreases monotonically with increasing <span class="math inline">\(\gamma\)</span> and therefore so does the integral. Hence the function <span class="math inline">\(\phi(\gamma)\)</span> is a monotonically decreasing function.</p></li>
<li><p>The end of a season occurs at any <span class="math inline">\(t\in\mathbb{Z}\)</span>. At those integer times we can write the integral in the expression for <span class="math inline">\(p(t)\)</span> as <span id="eq-ex_seasonal_mortality8"><span class="math display">\[
\begin{split}
\int_0^t\gamma-f(s)\,ds&amp;=\sum_{i=1}^t\int_{i-1}^{i}\gamma-f(s)\,ds\\
&amp;=\sum_{i=1}^t(\gamma - F)=t(\gamma - F).
\end{split}
\tag{8.51}\]</span></span> Hence for the population at the end of the season <span class="math inline">\(t\)</span> we have <span id="eq-ex_seasonal_mortality9"><span class="math display">\[
n(t,a)=n(0,0)\exp(t(\gamma - F))r(a).
\tag{8.52}\]</span></span> This will go to zero in the limit <span class="math inline">\(t\to\infty\)</span> if <span class="math inline">\(\gamma - F&lt;0\)</span>. Thus the criterion for extinction is <span class="math inline">\(\gamma &lt; F\)</span>.</p></li>
<li><p>Because <span class="math inline">\(\phi(\gamma)\)</span> decreases with <span class="math inline">\(\gamma\)</span>, <span id="eq-ex_seasonal_mortality10"><span class="math display">\[
\gamma &lt; F \Leftrightarrow \phi(\gamma) &gt; \phi(F).
\tag{8.53}\]</span></span> Because <span class="math inline">\(\phi(\gamma)=1\)</span>, this is equivalent to the condition <span class="math inline">\(1&gt;\phi(F)\)</span>. Thus the condition for extinction is <span id="eq-ex_seasonal_mortality11"><span class="math display">\[
\int_0^\infty b(a) \exp\left(-\int_0^a F+\mu(s)\,ds\right)da
&lt;1.
\tag{8.54}\]</span></span></p></li>
</ol>
<hr>
</section>
</section>
<section id="interacting-populations" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="interacting-populations"><span class="header-section-number">8.5</span> Interacting populations</h2>
</section>
<section id="epidemics" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="epidemics"><span class="header-section-number">8.6</span> Epidemics</h2>
<section id="sir-with-recrudescence" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="sir-with-recrudescence">SIR with recrudescence</h4>
<p><a href="epidemics.html#exr-sir2" class="quarto-xref">Exercise&nbsp;<span>6.3</span></a>: The modified equations are <span id="eq-ex_sir2"><span class="math display">\[
\begin{split}
\frac{dS}{dt} &amp;= -\beta S I/N,\\
\frac{dI}{dt} &amp;= \beta S I/N - \gamma I + \delta R,\\
\frac{dR}{dt} &amp;= \gamma I - \delta R.
\end{split}
\tag{8.55}\]</span></span></p>
<ol type="1">
<li><p>At the steady state all these derivatives have to vanish. From the first equation we find <span class="math inline">\(S^*=0\)</span> or <span class="math inline">\(I^*=0\)</span>. We are not interested in <span class="math inline">\(I^*=0\)</span> because we are interested in the endemic state which by definition has <span class="math inline">\(I^*&gt;0\)</span>, so we have <span class="math inline">\(S^*=0\)</span>. The third equation gives <span class="math inline">\(R^*=\gamma/\delta I^*\)</span>. Then <span class="math inline">\(I^*\)</span> is found from the fact that <span class="math inline">\(N=S^*+I^*+R^*\)</span> which gives <span class="math inline">\(I^*=N-\gamma/\delta I^*\)</span>. Solving for <span class="math inline">\(I^*\)</span> gives <span id="eq-ex_Istar"><span class="math display">\[
I^*=\frac{N\delta}{\delta+\gamma}.
\tag{8.56}\]</span></span></p></li>
<li><p>For the stability analysis we reduce the problem to a two-dimensional system by eliminating <span class="math inline">\(S\)</span> from the last two equations. This gives <span id="eq-ex_sir2b"><span class="math display">\[
\begin{split}
\frac{dI}{dt} &amp;= \frac{\beta I}{N} \left(N-I-R\right) - \gamma I + \delta R,\\
\frac{dR}{dt} &amp;= \gamma I - \delta R.
\end{split}
\tag{8.57}\]</span></span> The Jacobian matrix is <span id="eq-ex_sir2c"><span class="math display">\[
A = \begin{pmatrix}
\frac{\beta}{N} \left(N-2I-R\right) -\gamma &amp; \delta-\frac{\beta I}{N}\\
\gamma &amp; -\delta
\end{pmatrix}.
\tag{8.58}\]</span></span> Evaluated at the endemic state this gives <span id="eq-ex_sir2d"><span class="math display">\[
A = \begin{pmatrix}
-\frac{\beta}{N}I^* -\gamma &amp; \delta-\frac{\beta}{N}I^*\\
\gamma &amp; -\delta
\end{pmatrix}.
\tag{8.59}\]</span></span> This has determinant and trace given by <span id="eq-ex_sir2e"><span class="math display">\[
\begin{split}
\det(A) &amp;= (\delta+\gamma)\frac{\beta}{N}I^*&gt;0,\\
\text{tr}(A) &amp;= -\frac{\beta}{N}I^* -\gamma -\delta &lt;0.
\end{split}
\tag{8.60}\]</span></span> so the endemic state is stable for all positive values of the parameters.</p></li>
</ol>
<hr>
</section>
<section id="sir-model-with-reinfections" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="sir-model-with-reinfections">SIR model with reinfections</h4>
<p><a href="epidemics.html#exr-sir3" class="quarto-xref">Exercise&nbsp;<span>6.4</span></a>: The modified equations are <span id="eq-ex_sir3"><span class="math display">\[
\begin{split}
\frac{dS}{dt} &amp;= -\beta S I/N,\\
\frac{dI}{dt} &amp;= \beta S I/N - \gamma I +\beta\mu R I/N,\\
\frac{dR}{dt} &amp;= \gamma I-\beta\mu R I/N.
\end{split}
\tag{8.61}\]</span></span> At the steady state all these derivatives have to vanish. From the first equation we find <span class="math inline">\(S^*=0\)</span> or <span class="math inline">\(I^*=0\)</span>. We are not interested in <span class="math inline">\(I^*=0\)</span> because we are interested in the endemic state which by definition has <span class="math inline">\(I^*&gt;0\)</span>, so we have <span class="math inline">\(S^*=0\)</span>. The third equation gives <span class="math inline">\(R^*=\gamma N/(\beta\mu)\)</span>. Then <span class="math inline">\(I^*\)</span> is found from the fact that <span class="math inline">\(N=S^*+I^*+R^*\)</span> which gives <span id="eq-ex_sir3_Istar"><span class="math display">\[
I^*=N-R^*=N\left(1-\frac{\gamma}{\beta\mu}\right).
\tag{8.62}\]</span></span> This is not the same as the number of infecteds in the endemic state of the model with loss of immunity given in <a href="epidemics.html#eq-Istar" class="quarto-xref">Eq.&nbsp;<span>6.33</span></a>.</p>
<hr>
</section>
<section id="sex-structured-sir-model" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sex-structured-sir-model">Sex-structured SIR model</h3>
<p><a href="epidemics.html#exr-sir4" class="quarto-xref">Exercise&nbsp;<span>6.5</span></a>:</p>
<ol type="a">
<li><p>As <span class="math inline">\(N=S+I+R\)</span> we have <span id="eq-sir4N"><span class="math display">\[
\frac{dN}{dt} = \frac{dS}{dt}+\frac{dI}{dt}+\frac{dR}{dt} = -rSI'+rSI'-aI+aI=0.
\tag{8.63}\]</span></span> Hence, <span class="math inline">\(N\)</span> is a constant. Similarly, <span class="math inline">\(N'\)</span> is a constant.</p></li>
<li><p>We start by deriving an ODE for <span class="math inline">\(S\)</span> as a function of <span class="math inline">\(R'\)</span>: <span id="eq-sir4S"><span class="math display">\[
\frac{dS}{dR'}=\frac{dS}{dt}/ \frac{dR'}{dt} = \frac{-rSI'}{a'I'}=-\frac{r}{a'}S.
\tag{8.64}\]</span></span> This is easy to solve: <span id="eq-sir4Ssol"><span class="math display">\[
S(t)=S_0e^{-\frac{r}{a'}R'(t)}.
\tag{8.65}\]</span></span> Similarly, <span id="eq-sir4Ssolprime"><span class="math display">\[
S'(t)=S'_0e^{-\frac{r'}{a}R(t)}.
\tag{8.66}\]</span></span></p></li>
<li><p>At <span class="math inline">\(t=\infty\)</span> we have <span id="eq-sir4Ssolinf"><span class="math display">\[
S(\infty)=S_0 e^{-\frac{r}{a'}R'(\infty)}.
\tag{8.67}\]</span></span> But at <span class="math inline">\(t=\infty\)</span>, <span class="math inline">\(I'=0\)</span> and <span class="math inline">\(N'=S'+I'+R'\)</span> and so <span id="eq-sir4Ssolinf2"><span class="math display">\[
S(\infty)=S_0 e^{-\frac{r}{a'}(N'-S'(\infty))}.
\tag{8.68}\]</span></span> Similarly, <span id="eq-sir4Ssolprimeinf"><span class="math display">\[
S'(\infty)=S'_0 e^{-\frac{r'}{a}(N-S(\infty))}.
\tag{8.69}\]</span></span></p></li>
</ol>
</section>
</section>
<section id="spatially-structured-population-models" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="spatially-structured-population-models"><span class="header-section-number">8.7</span> Spatially-structured population models</h2>
<section id="travelling-wave-in-1-species-reaction-diffusion-model" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="travelling-wave-in-1-species-reaction-diffusion-model">Travelling wave in 1-species reaction-diffusion model</h3>
<p><a href="spatial.html#exr-spatial1" class="quarto-xref">Exercise&nbsp;<span>7.2</span></a>:</p>
<ol type="a">
<li><p>With <span class="math inline">\(z=x-ct\)</span> we have <span id="eq-spatial1"><span class="math display">\[
\frac{\partial }{\partial t}= \frac{\partial z}{\partial t}\frac{\partial }{\partial z} = -c \frac{\partial }{\partial z} \text{ and }
\frac{\partial }{\partial x}= \frac{\partial z}{\partial x}\frac{\partial }{\partial z} = \frac{\partial }{\partial z}.
\tag{8.70}\]</span></span> Substituting this into the PDE gives the ODE <span id="eq-spatial1b"><span class="math display">\[
-cU' = f(U) + DU''.
\tag{8.71}\]</span></span></p></li>
<li><p>For a travelling wave from left to right (<span class="math inline">\(c&gt;0\)</span>) we expect solution at <span class="math inline">\(\pm \infty\)</span> to be at steady state: <span class="math inline">\(U(-\infty) = 1\)</span> and <span class="math inline">\(U(\infty)=0\)</span>, with <span class="math inline">\(U'(\pm \infty)=0\)</span>.</p>
<p>We will now use a slightly different way to approach the linearisation around the leading edge of the travelling wave than the one we used in the lecture. The methods are equivalent, and it is always instructional to look at different ways of doing the same thing.</p>
<p>At the leading edge of the wave we have that <span class="math inline">\(U\)</span> is very small, so we can Taylor-expand <span class="math inline">\(f(U)=f(0)+Uf'(0)+\dots\)</span>. We keep only the first two terms and also use that <span class="math inline">\(f(0)=0\)</span> to get the linear ODE <span id="eq-spatial1c"><span class="math display">\[
-cU' = Uf'(0)+DU''.
\tag{8.72}\]</span></span> Rather than making an Ansatz for <span class="math inline">\(U\)</span> as in the lecture, we convert this second order ODE into a set of first-order ODEs by introducing a second variable <span class="math inline">\(V\)</span> so that <span class="math inline">\(U'=V\)</span> and <span class="math inline">\(V' = -\frac{U}{D}f'(0) - \frac{c}{D}V\)</span>. In vector notation this reads <span id="eq-spatial1da"><span class="math display">\[
\begin{pmatrix}
U'\\
V'
\end{pmatrix}
=
\begin{pmatrix}
0 &amp; 1\\
-\frac{f'(0)}{D}U &amp; -\frac{c}{D}
\end{pmatrix}
\begin{pmatrix}
U\\
V
\end{pmatrix}.
\tag{8.73}\]</span></span> The eigenvalues <span class="math inline">\(\lambda\)</span> of this linear matrix ODE are solutions of <span id="eq-spatial1d"><span class="math display">\[
\det \begin{pmatrix}
-\lambda &amp; 1 \\ -\frac{f'(0)}{D} &amp; -\lambda -\frac{c}{D}
\end{pmatrix} = 0
~~~~\implies ~~~~\lambda^2 + \frac{c}{D} \lambda + \frac{f'(0)}{D}=0.
\tag{8.74}\]</span></span> Real eigenvalues and thus realistic biological solutions exist iff <span id="eq-spatial1e"><span class="math display">\[
\frac{c^2}{D^2}-4\frac{f'(0)}{D}\geq 0, ~~~~\implies ~~~~ c\geq 2\sqrt{Df'(0)}.
\tag{8.75}\]</span></span></p></li>
<li><p>If <span class="math inline">\(f(u)= 0\)</span> for all <span class="math inline">\(u\)</span> we get <span class="math inline">\(DU''+cU'=0\)</span>. Setting <span class="math inline">\(U(z)=e^{\mu z}\)</span> <span class="math inline">\(\implies\)</span> <span class="math inline">\(D\mu^2+c\mu\)</span> <span class="math inline">\(\implies\)</span> <span class="math inline">\(\mu = 0\)</span> or <span class="math inline">\(-c/D\)</span>. The general solution is <span class="math inline">\(U=Ae^{-\frac{c}{D} z}+B\)</span>. Clearly <span class="math inline">\(|U|\rightarrow \infty\)</span> as <span class="math inline">\(z \rightarrow -\infty\)</span>. This is not a biologically realistic solution.</p></li>
</ol>
</section>
<section id="sir-model-with-logistic-growth" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sir-model-with-logistic-growth">SIR model with logistic growth</h3>
<p><a href="spatial.html#exr-spatial3" class="quarto-xref">Exercise&nbsp;<span>7.4</span></a>:</p>
<ol type="a">
<li><p>One can either approach this systematically or one can just try to guess the necessary change of variables. We will use a blended approach: we guess the expressions for <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> by inspecting the equations, and we make a general Ansatz for <span class="math inline">\(\tilde{t}\)</span>.</p>
<p>By comparing the <span class="math inline">\((1-S/K)\)</span> factor in the equation for <span class="math inline">\(S\)</span> to the factor <span class="math inline">\((1-u)\)</span> in the equation for <span class="math inline">\(u\)</span> we see that <span class="math inline">\(u=S/K\)</span>. It is natural to also choose <span class="math inline">\(v=I/K\)</span>. We write <span class="math inline">\(\tilde{t}=t/\tau\)</span>, where <span class="math inline">\(\tau\)</span> is still to be determined. With these we have <span id="eq-spatial3ut"><span class="math display">\[\begin{split}
\partial_{\tilde{t}}u&amp;=\tau/K\partial_tS=
\tau/K\left(rKu(1-u)-\beta K^2uv\right)\\
&amp;=
\tau r u(1-u)-\tau \beta K uv
\end{split} \tag{8.76}\]</span></span> By comparing this with equation for <span class="math inline">\(u\)</span> in the problem statement, we can read off that <span id="eq-spatial3tau"><span class="math display">\[
\tau = \frac{1}{\beta K}, ~~~b=\frac{r}{\beta K}.
\tag{8.77}\]</span></span> Then <span id="eq-spatial3vt"><span class="math display">\[\begin{split}
\partial_{\tilde{t}}v&amp;=\tau/K\partial_tI=
\tau/K\left(\beta K^2uv-\gamma Kv\right)\\
&amp;=uv-\frac{\gamma}{\beta K}v.
\end{split} \tag{8.78}\]</span></span> By comparing this with the equation for <span class="math inline">\(v\)</span> in the problem statement we read off that <span id="eq-spatial3m"><span class="math display">\[
m=\frac{\gamma}{\beta K}.
\tag{8.79}\]</span></span></p></li>
<li><p>By inspection we see that one steady state is <span class="math inline">\((u(x,t),v(x,t))=(0,0)\)</span> and that another is <span id="eq-spatial3ss"><span class="math display">\[
(u(x,t),v(x,t))=(1,0).
\tag{8.80}\]</span></span> The first describes a situation where the foxes are extinct, the second the situation where in the absence of the disease the fox population sits at its carrying capacity. We look for another steady state <span class="math inline">\((u(x,t),v(x,t))=(u^*,v^*)\)</span> with <span class="math inline">\(v^*\neq 0\)</span>. From the equation for <span class="math inline">\(v\)</span> we read off that <span class="math inline">\(u^*=m\)</span> and then from the equation for <span class="math inline">\(u\)</span> we get <span class="math inline">\(v^*=b(1-m)\)</span>. This is the endemic state because the number of infecteds is non-zero. It exists as long as <span class="math inline">\(m&lt;1\)</span>. This tells us that the existence of the endemic state is independent of the intrinsic growth rate <span class="math inline">\(r\)</span> of the fox population but does depend on its carrying capacity.</p></li>
<li><p>We know from part a. that <span class="math inline">\(\partial_{\tilde t}u=\partial_t S/(\beta K^2)\)</span>. Thus we now want <span class="math inline">\(D_1\partial_x^2 S/(\beta K^2)=\partial_{\tilde{x}}^2 u\)</span>, where <span class="math inline">\(u=S/K\)</span>. Hence <span id="eq-spatial3x"><span class="math display">\[
\tilde{x}=\sqrt{\frac{K\beta}{D_1}}x.
\tag{8.81}\]</span></span> Then <span class="math inline">\(d\,\partial_{\tilde{x}}^2v =d\,D_1\partial_x^2I\)</span> but we want <span class="math inline">\(D_2\partial_x^2I\)</span> so we need <span id="eq-spatial3d"><span class="math display">\[
d=\frac{D_2}{D_1}.
\tag{8.82}\]</span></span></p></li>
<li><p>Substituting the wave Ansatz into the PDEs for <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> gives <span id="eq-AB"><span class="math display">\[\begin{split}
-cA'&amp;=bA(1-A)-AB+A''\\
-cB'&amp;=AB-mB+dB''.
\end{split} \tag{8.83}\]</span></span></p></li>
<li><p>If <span class="math inline">\(A(\infty)=1\)</span> (which corresponds to <span class="math inline">\(S=K\)</span>) then that means that at <span class="math inline">\(x=\infty\)</span> the system is in the disease-free state and thus <span class="math inline">\(B(\infty)=0\)</span>. At <span class="math inline">\(x=-\infty\)</span> the system must thus be in the endemic state, so <span class="math inline">\(A(-\infty)=u^*=m\)</span> and <span class="math inline">\(B(-\infty)=v^*=b(1-m)\)</span>. So the key to this question was the observation that the travelling wave will always have to interpolate between two steady states.</p></li>
<li><p>At the leading edge where <span class="math inline">\(B\)</span> is very small, <span class="math inline">\(A\)</span> is very close to <span class="math inline">\(1\)</span>, so <span class="math inline">\(A=1-\epsilon\)</span> for a small <span class="math inline">\(\epsilon&gt;0\)</span>. The equations <a href="#eq-AB" class="quarto-xref">Eq.&nbsp;<span>8.83</span></a> can thus be approximated by the linear equations <span id="eq-ABl"><span class="math display">\[
c\epsilon'=b\epsilon-B-\epsilon'',~~~-cB'=B-mB+dB''.
\tag{8.84}\]</span></span> We obtained this by dropping all terms involving <span class="math inline">\(\epsilon^2\)</span> or <span class="math inline">\(\epsilon B\)</span> because they are negligible when <span class="math inline">\(\epsilon\)</span> and <span class="math inline">\(B\)</span> are both small.</p>
<p>We concentrate on the second equation, which we solve with the Ansatz <span class="math inline">\(B(x)=\exp(\lambda x)\)</span>. Substituting this Ansatz into the equation gives the characteristic equation for <span class="math inline">\(\lambda\)</span>: <span id="eq-spatial3lambda"><span class="math display">\[
d\lambda^2+c\lambda+1-m=0,
\tag{8.85}\]</span></span> and thus <span id="eq-spatial3lambda2"><span class="math display">\[
\lambda=\frac{-c\pm\sqrt{c^2-4d(1-m)}}{2d}.
\tag{8.86}\]</span></span> We do not want the solution to oscillate, so we want <span class="math inline">\(\lambda\)</span> to be real, hence <span id="eq-spatial3c"><span class="math display">\[
c\geq 2\sqrt{d(1-m)}.
\tag{8.87}\]</span></span></p></li>
</ol>
</section>
<section id="derive-turing-instability" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="derive-turing-instability">Derive Turing instability</h3>
<p><a href="spatial.html#exr-spatial4" class="quarto-xref">Exercise&nbsp;<span>7.5</span></a>:</p>
<p>Here, <span id="eq-spatial4fg"><span class="math display">\[
f(u,v)=a-u + u^2v, ~~~~ g(u,v)=b-u^2v.
\tag{8.88}\]</span></span></p>
<p><strong>Step 1. Uniform steady state</strong></p>
<p><span id="eq-spatial4ss"><span class="math display">\[
a-u^* + {u^*}^2 v^*=0~\text{ and }~b-{u^*}^2 v^*=0
\tag{8.89}\]</span></span> implies <span id="eq-spatial4ss2"><span class="math display">\[
(u^*,~v^*)=(a+b,~b/(a+b)^2).
\tag{8.90}\]</span></span></p>
<p><strong>Step 2. Linearise</strong></p>
<p>Set <span class="math inline">\(u=u^*+\xi\)</span> and <span class="math inline">\(v=v^*+\eta\)</span> with <span class="math inline">\(\xi\)</span> and <span class="math inline">\(\eta\)</span> small. Substitute and Taylor expand to get <span id="eq-spatial4lin"><span class="math display">\[
\begin{pmatrix}
\frac{\partial \xi}{\partial t} \\ \frac{\partial \eta}{\partial t}
\end{pmatrix}
=
\begin{pmatrix}
a_{11} &amp; a_{12} \\a_{21} &amp; a_{22}
\end{pmatrix}
\begin{pmatrix}
\xi \\ \eta
\end{pmatrix}
+
\begin{pmatrix}
D_1 \frac{\partial^2 \xi}{\partial x^2} \\ D_2\frac{\partial^2 \eta}{\partial x^2}
\end{pmatrix},
\tag{8.91}\]</span></span> where <span id="eq-spatial4lin2"><span class="math display">\[
\begin{split}
a_{11} = \frac{\partial f}{\partial u}(u^*,v^*) &amp;= -1+2u^*v^* \\
&amp;= -1+2(a+b)b/(a+b)^2 \\
&amp;=(b-a)/(a+b)\\
a_{12} = \frac{\partial f}{\partial v}(u^*,v^*) &amp;= {u^*}^2 =(a+b)^2\\
a_{21} = \frac{\partial g}{\partial u}(u^*,v^*) &amp;= -2 u^* v^* =-2b/(a+b)\\
a_{22} = \frac{\partial g}{\partial v}(u^*,v^*) &amp;= -{u^*}^2 =-(a+b)^2
\end{split}
\tag{8.92}\]</span></span></p>
<p><strong>Step 3. Solutions</strong></p>
<p>Make the Ansatz <span class="math inline">\(\xi = A_1 e^{\sigma t} \sin( kx+\alpha)\)</span> and <span class="math inline">\(\eta = A_2 e^{\sigma t} \sin( kx+\alpha)\)</span>. Substitute to get <span id="eq-spatial4sol"><span class="math display">\[
\begin{pmatrix}
\sigma - \frac{b-a}{a+b} +D_1k^2 &amp; -(a+b)^2 \\  
\frac{2b}{a+b} &amp; \sigma + (a+b)^2 +D_2k^2
\end{pmatrix}
\begin{pmatrix}
A_1 \\ A_2
\end{pmatrix}=
{\mathbf 0}
\tag{8.93}\]</span></span> For a non-trivial solution we require the determinant of this matrix to be zero (otherwise we would be able to find an inverse, etc.). Hence, <span id="eq-spatial4sol2"><span class="math display">\[
\sigma^2 + \left[ (a+b)^2 - \frac{b-a}{a+b} + (D_1+D_2)k^2  \right] \sigma + h(k^2) = 0,
\tag{8.94}\]</span></span> where <span id="eq-spatial4sol3"><span class="math display">\[
h(k^2)= D_1D_2k^4 - \left[ D_2\frac{b-a}{a+b} - D_1(a+b)^2  \right] k^2 +(a+b)^2.
\tag{8.95}\]</span></span></p>
<p><strong>Step 4. In the absence of diffusion</strong> (Put <span class="math inline">\(D_1=0=D_2\)</span>.) <span id="eq-spatial4sol4"><span class="math display">\[
\sigma^2 + \left[ (a+b)^2 - \frac{b-a}{a+b} \right] \sigma + (a+b)^2 = 0.
\tag{8.96}\]</span></span> For <span class="math inline">\(\sigma\)</span> to have roots in the left half of the complex plane (giving us a stable steady state) we need <span class="math inline">\((a+b)^2-\frac{b-a}{a+b}&gt;0 ~\implies ~ b-a&lt;(a+b)^3\)</span> and <span class="math inline">\((a+b)^2&gt;0\)</span> (which it is).</p>
<p><strong>Step 5. With diffusion</strong> (<span class="math inline">\(D_1\neq 0\neq D_2\)</span>.)</p>
<p>We want steady state to be unstable in this case. The coefficient of <span class="math inline">\(\sigma\)</span> is <span id="eq-spatial4sol5"><span class="math display">\[
(a+b)^2 - \frac{b-a}{a+b} + (D_1+D_2)k^2 &gt; (D_1+D_2)k^2&gt;0 ~~~~\mbox{from Step 4}
\tag{8.97}\]</span></span> Therefore, we require <span class="math inline">\(h(k^2)&lt;0\)</span> for some <span class="math inline">\(k^2\)</span> for there to be an instability.</p>
<p>As <span class="math inline">\(h(0)&gt;0\)</span> we must have two positive real roots of <span class="math inline">\(h(k^2)=0\)</span> for there to be an instability.</p>
<p>Real distinct roots (<span class="math inline">\(\implies ~~B^2-4AC&gt;0\)</span>) <span id="eq-spatial4sol6"><span class="math display">\[
\implies \left[ D_2\frac{b-a}{a+b} - D_1(a+b)^2  \right]^2&gt; 4D_1D_2 (a+b)^2.
\tag{8.98}\]</span></span> Both positive (<span class="math inline">\(\implies B&lt;0\)</span>) <span id="eq-spatial4sol7"><span class="math display">\[
\implies D_2\frac{b-a}{a+b} - D_1(a+b)^2 &gt; 0.
\tag{8.99}\]</span></span></p>
<!---
----------------------------------------------------

### Slime mould with boundary {.unnumbered}
@exr-spatial5
$$ 
\frac{\partial a}{\partial t} = \frac{\partial}{\partial x} \left( \mu \frac{\partial a}{\partial x} - \chi a \frac{\partial \rho}{\partial x}   \right), ~~~\mbox{and} ~~~ \frac{\partial \rho}{\partial t} = fa -k\rho + D\frac{\partial^2 \rho}{\partial x^2}.
$$ {#eq-spatial5}
Steady states are $fa^*=k\rho^*$. 

Consider a perturbation $a=a^*+\xi$ and $\rho = \rho^* +\eta$, where $\xi$ and $\eta$ are small.  Substitute and linearise to give
$$
\frac{\partial \xi}{\partial t} = \mu \frac{\partial^2 \xi}{\partial x^2} - \chi a^* \frac{\partial^2 \eta}{\partial x^2}, ~~~\mbox{and} ~~~ 
\frac{\partial \eta}{\partial t} = f\xi -k\eta + D\frac{\partial^2 \eta}{\partial x^2}.
$$ {#eq-spatial5lin}
Put $\xi = A_1 e^{\sigma t + iqx}$ and $\eta = A_2 e^{\sigma t + iqx}$.  Hence,
$$
\begin{pmatrix}
\sigma +\mu q^2 & -\chi a^*q^2 \\  
-f & \sigma + k+Dq^2
\end{pmatrix}
\begin{pmatrix}
A_1 \\ A_2
\end{pmatrix}= 
{\mathbf 0}
$$ {#eq-spatial5sol}

A non-trivial solution requires the determinant of the matrix to be zero
$$
\implies ~\sigma^2 +g(q^2)\sigma + h(q^2) = 0,
$$ {#eq-spatial5sol2}
where
$g(q^2) = k+(D+\mu)q^2>0$ and 
$h(q^2) = \mu Dq^4+(k\mu -\chi a^*f)q^2>0$.

We need $(k\mu -\chi a^*f)<0$ for there to be a positive root of $h(q^2)=0$ and so instability.

If $0\leq x \leq L$ we need boundary conditions.  Assume no flux at $x=0,~L$: $\frac{\partial a}{\partial x}=0=\frac{\partial \rho}{\partial x}$ at $x=0,~L$. 

Try $\xi = A_1 e^{\sigma t}\cos qx$ and $\eta = A_2 e^{\sigma t}\cos qx$ to satisfy BCs at $x=0$. 

At $x=L$ we have $\sin qL = 0$ for a non-trivial solution $~\implies q=q_n:= n\pi/L$, $n=0,1,2,...$

Aggregation will not occur if $h(q_1^2)>0$, which implies 
$$
L<\pi\sqrt{\frac{D\mu}{\chi a^*f-k\mu}}.
$$ {#eq-spatial5L}

Aggregation will occur if 
$$
k\mu<\chi a^*f  ~~~\mbox{and}~~~ 
L>\pi\sqrt{\frac{D\mu}{\chi a^*f-k\mu}}.
$$ {#eq-spatial5L2}

--->


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>If <span class="math inline">\(\lambda\geq p\)</span>, then <span class="math inline">\(\psi(\lambda)\)</span> diverges and does not satisfy the Euler-Lotka equation <span class="math inline">\(\psi(\lambda)=1\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./spatial.html" class="pagination-link" aria-label="Spatially-structured populations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatially-structured populations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/edit/main/solutions.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>