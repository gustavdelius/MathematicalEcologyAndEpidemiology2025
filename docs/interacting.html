<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Work in progress">

<title>3&nbsp; Interacting populations – Mathematical Ecology and Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sex_structured.html" rel="next">
<link href="./discrete_time.html" rel="prev">
<link href="./virus.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2b37b0a2d7675c40fc14763bc2dd14a3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="3&nbsp; Interacting populations – Mathematical Ecology and Epidemiology">
<meta property="og:description" content="Work in progress">
<meta property="og:image" content="interacting_files/figure-html/fig-lotka-volterra-output-1.png">
<meta property="og:site_name" content="Mathematical Ecology and Epidemiology">
<meta property="og:image:alt" content="Solutions to the Lotka-Volterra model.">
<meta name="twitter:title" content="3&nbsp; Interacting populations – Mathematical Ecology and Epidemiology">
<meta name="twitter:description" content="Work in progress">
<meta name="twitter:image" content="interacting_files/figure-html/fig-lotka-volterra-output-1.png">
<meta name="twitter:image:alt" content="Solutions to the Lotka-Volterra model.">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./interacting.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interacting populations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Ecology and Epidemiology</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://vle.york.ac.uk/ultra/courses/_111662_1/outline" title="VLE" class="quarto-navigation-tool px-1" aria-label="VLE"><i class="bi bi-house-door-fill"></i></a>
    <a href="https://maths.york.ac.uk/moodle/course/view.php?id=2726" title="Moodle quizzes" class="quarto-navigation-tool px-1" aria-label="Moodle quizzes"><i class="bi bi-mortarboard-fill"></i></a>
    <a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./continuous_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Continuous-time population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Discrete-time population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interacting.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interacting populations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sex_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sex-structured population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./age_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Age-structured population model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./epidemics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Epidemics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatially-structured populations</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lotka-volterra-model" id="toc-lotka-volterra-model" class="nav-link active" data-scroll-target="#lotka-volterra-model"><span class="header-section-number">3.1</span> Lotka-Volterra Model</a></li>
  <li><a href="#linear-stability-analysis" id="toc-linear-stability-analysis" class="nav-link" data-scroll-target="#linear-stability-analysis"><span class="header-section-number">3.2</span> Linear Stability Analysis</a></li>
  <li><a href="#more-realistic-predator-prey-models" id="toc-more-realistic-predator-prey-models" class="nav-link" data-scroll-target="#more-realistic-predator-prey-models"><span class="header-section-number">3.3</span> More Realistic Predator-Prey Models</a>
  <ul>
  <li><a href="#generalized-predator-prey-model" id="toc-generalized-predator-prey-model" class="nav-link" data-scroll-target="#generalized-predator-prey-model"><span class="header-section-number">3.3.1</span> Generalized Predator-Prey Model</a>
  <ul class="collapse">
  <li><a href="#holling-type-functional-responses" id="toc-holling-type-functional-responses" class="nav-link" data-scroll-target="#holling-type-functional-responses">Holling Type functional responses</a></li>
  </ul></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">3.3.2</span> Example</a></li>
  </ul></li>
  <li><a href="#competition-models" id="toc-competition-models" class="nav-link" data-scroll-target="#competition-models"><span class="header-section-number">3.4</span> Competition Models</a>
  <ul>
  <li><a href="#lotka-volterra-competition-dynamics" id="toc-lotka-volterra-competition-dynamics" class="nav-link" data-scroll-target="#lotka-volterra-competition-dynamics"><span class="header-section-number">3.4.1</span> Lotka-Volterra Competition Dynamics</a></li>
  <li><a href="#nondimensionalization-of-the-model" id="toc-nondimensionalization-of-the-model" class="nav-link" data-scroll-target="#nondimensionalization-of-the-model"><span class="header-section-number">3.4.2</span> Nondimensionalization of the Model</a></li>
  <li><a href="#analysis-of-steady-states" id="toc-analysis-of-steady-states" class="nav-link" data-scroll-target="#analysis-of-steady-states"><span class="header-section-number">3.4.3</span> Analysis of Steady States</a></li>
  <li><a href="#nullclines-and-phase-portraits" id="toc-nullclines-and-phase-portraits" class="nav-link" data-scroll-target="#nullclines-and-phase-portraits"><span class="header-section-number">3.4.4</span> Nullclines and Phase Portraits</a></li>
  <li><a href="#competitive-exclusion-principle" id="toc-competitive-exclusion-principle" class="nav-link" data-scroll-target="#competitive-exclusion-principle"><span class="header-section-number">3.4.5</span> Competitive Exclusion Principle</a></li>
  </ul></li>
  <li><a href="#mutualism-models" id="toc-mutualism-models" class="nav-link" data-scroll-target="#mutualism-models"><span class="header-section-number">3.5</span> Mutualism Models</a>
  <ul>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span class="header-section-number">3.5.1</span> Example</a></li>
  <li><a href="#nondimensionalization-of-the-model-1" id="toc-nondimensionalization-of-the-model-1" class="nav-link" data-scroll-target="#nondimensionalization-of-the-model-1"><span class="header-section-number">3.5.2</span> Nondimensionalization of the Model</a></li>
  <li><a href="#steady-states-and-stability" id="toc-steady-states-and-stability" class="nav-link" data-scroll-target="#steady-states-and-stability"><span class="header-section-number">3.5.3</span> Steady States and Stability</a></li>
  <li><a href="#nullclines-and-phase-portraits-1" id="toc-nullclines-and-phase-portraits-1" class="nav-link" data-scroll-target="#nullclines-and-phase-portraits-1"><span class="header-section-number">3.5.4</span> Nullclines and Phase Portraits</a></li>
  <li><a href="#limitations-and-unbounded-growth" id="toc-limitations-and-unbounded-growth" class="nav-link" data-scroll-target="#limitations-and-unbounded-growth"><span class="header-section-number">3.5.5</span> Limitations and Unbounded Growth</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">3.6</span> Exercises</a>
  <ul>
  <li><a href="#two-species-model-1" id="toc-two-species-model-1" class="nav-link" data-scroll-target="#two-species-model-1">* Two-species model 1</a></li>
  <li><a href="#two-species-model-2" id="toc-two-species-model-2" class="nav-link" data-scroll-target="#two-species-model-2">Two-species model 2</a></li>
  <li><a href="#predator-prey-model-with-allee-effect" id="toc-predator-prey-model-with-allee-effect" class="nav-link" data-scroll-target="#predator-prey-model-with-allee-effect">Predator-prey model with Allee effect</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/edit/main/interacting.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interacting populations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Ecological systems are complex networks of interactions involving multiple species, which can be categorized into different trophic levels based on their roles in the ecosystem. Understanding these interactions is crucial for studying ecosystem dynamics, population control, and biodiversity. While the study of multiple interacting species can become quite intricate, analysing the interactions between two species offers a more manageable framework while still providing significant insights into the dynamics of ecological relationships. This chapter focuses on two-species interactions, offering a foundational understanding that can be applied or extended to more complex scenarios.</p>
<p><strong>Mathematical Framework for Two-Species Interactions</strong></p>
<p>To model the interactions between two species, we employ a system of two autonomous coupled ordinary differential equations (ODEs). These equations describe the rate of change of the population sizes over time, capturing the essence of their interaction. The general form of these equations is given by: <span id="eq-i1"><span class="math display">\[
\frac{dX}{dt} = f(X,Y), ~~~~~ \frac{dY}{dt} = g(X,Y).
\tag{3.1}\]</span></span> where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> represent the population sizes of the two species, and <span class="math inline">\(f(X,Y)\)</span> and <span class="math inline">\(g(X,Y)\)</span> are functions that describe how the populations influence each other. These functions are crafted based on the nature of the interaction between the species, reflecting the underlying biological processes.</p>
<p><strong>Types of Two-Species Interactions</strong></p>
<p>The dynamics of two interacting species are generally categorized into three primary types, each with its unique characteristics and implications for the populations involved:</p>
<ul>
<li><p><strong>Predator-Prey Interactions:</strong> In this type of interaction, one species (the predator) feeds on the other (the prey). The population growth of the predator increases with increased availability of the prey, while the prey population is negatively affected by the presence of the predator. Mathematically, this interaction often leads to oscillatory dynamics, exemplified by the classic Lotka-Volterra model.</p></li>
<li><p><strong>Competition:</strong> When two species compete for the same resources, their growth rates are adversely affected by their interaction. This situation is characterized by negative impacts on both species’ growth rates, potentially leading to the exclusion of one species or to a stable coexistence, depending on the specific conditions and competition coefficients.</p></li>
<li><p><strong>Mutualism:</strong> This positive interaction benefits both species, leading to an increase in their growth rates. The mutualistic relationship is such that each species provides some benefit to the other, which could be in the form of nutrients, shelter, or any other factor that enhances growth or survival.</p></li>
</ul>
<p>While this chapter focuses on these primary interaction types, it’s important to recognize the spectrum of interactions in nature, including parasitism, amensalism, and others. Moreover, the real-world ecological systems often exhibit a mix of these interactions, adding layers of complexity. By starting with the analysis of two-species systems, we lay the groundwork for understanding more intricate interactions and the overall dynamics of ecosystems.</p>
<section id="lotka-volterra-model" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="lotka-volterra-model"><span class="header-section-number">3.1</span> Lotka-Volterra Model</h2>
<p>The Lotka-Volterra model, developed independently by Alfred Lotka in 1925 and Vito Volterra in 1926, serves as a foundational mathematical model for understanding the dynamic interplay between a prey population (denoted by <span class="math inline">\(N\)</span>) and a predator population (denoted by <span class="math inline">\(P\)</span>).</p>
<p><strong>Model Formulation</strong></p>
<p>The model assumes that the prey population, in the absence of predators, grows exponentially with a per capita growth rate <span class="math inline">\(a &gt; 0\)</span>. However, the prey die due to being eaten by predators, and we assume that the per-capita mortality rate grows in proportion to the abundance of predators, with some proportionality constant <span class="math inline">\(b \geq 0\)</span>. This leads to the equation <span id="eq-lv1"><span class="math display">\[
\frac{dN}{dt} = N(a - bP).
\tag{3.2}\]</span></span></p>
<p>Conversely, the predators benefit from the abundance of prey and we encode that by giving them a per-capita growth <span class="math inline">\(cN\)</span>, where <span class="math inline">\(c \geq 0\)</span>. We assume that the per capita mortality rate is a constant <span class="math inline">\(d\)</span>. This yields the following equation for the predator dynamics: <span id="eq-lv2"><span class="math display">\[
\frac{dP}{dt} = P(cN - d).
\tag{3.3}\]</span></span></p>
<p>The two plots in <a href="#fig-lotka-volterra" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> generated from the Lotka-Volterra model provide a visual representation of the dynamics between a predator and prey population over time. The phase plane plot illustrates the cyclic nature of the interaction between the prey (N) and predator (P) populations, depicting a closed trajectory that indicates the continuous oscillation of both populations in relation to each other: as the prey population increases, it provides more food for the predators, which then also increase in number. However, as the predator population grows, it puts more pressure on the prey, leading to a decline in the prey population, which eventually causes the predator population to decrease due to lack of food.</p>
<p>The plot at the bottom shows the prey and predator populations over time. It highlights the periodic rises and falls of each population, showing how the increase in the prey population precedes the increase in the predator population, followed by a subsequent decline in the prey and then the predator population. The time series plot complements the phase plane by showing how the dynamics unfold over time.</p>
<div id="cell-fig-lotka-volterra" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div id="fig-lotka-volterra" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Solutions to the Lotka-Volterra model.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lotka-volterra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="interacting_files/figure-html/fig-lotka-volterra-output-1.png" class="img-fluid figure-img" alt="Solutions to the Lotka-Volterra model.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lotka-volterra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Solutions to the Lotka-Volterra model with parameters <span class="math inline">\(a = 1.0\)</span>, <span class="math inline">\(b = 0.1\)</span>, <span class="math inline">\(c = 0.1\)</span>, and <span class="math inline">\(d = 1.0\)</span> and initial conditions <span class="math inline">\(N_0 = 10\)</span> and <span class="math inline">\(P_0 = 5\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Non-dimensionalization of the Model</strong></p>
<p>Non-dimensionalization is a crucial step to reduce the complexity of the model by decreasing the number of parameters, thereby simplifying the analysis. By introducing the non-dimensional variables <span class="math inline">\(u = \frac{cN}{d}\)</span>, <span class="math inline">\(v = \frac{bP}{a}\)</span>, and the non-dimensional time <span class="math inline">\(\tau = at\)</span>, along with the parameter <span class="math inline">\(\alpha = \frac{d}{a}\)</span>, we can transform the Lotka-Volterra equations into a more tractable form:</p>
<p><span id="eq-lv3"><span class="math display">\[
\frac{du}{d\tau} = u(1 - v), \quad \frac{dv}{d\tau} = \alpha v(u - 1).
\tag{3.4}\]</span></span></p>
<p><strong>Phase plane paths</strong></p>
<p>To determine the phase plane paths we consider <span class="math inline">\(v\)</span> as a function of <span class="math inline">\(u\)</span> which satisfies the equation <span id="eq-lv4"><span class="math display">\[
\frac{dv}{du} = \frac{\frac{dv}{d\tau}}{\frac{du}{d\tau}} = \frac{\alpha v(u - 1)}{u(1 - v)}.
\tag{3.5}\]</span></span> We rewrite this by separating the variable and integrate: <span id="eq-lv5"><span class="math display">\[
\int\frac{1-v}{v}dv = \alpha \int\frac{u-1}{u}du.
\tag{3.6}\]</span></span> This gives <span id="eq-lv6"><span class="math display">\[
\log v - v - \alpha (u - \log u) = \text{constant}.
\tag{3.7}\]</span></span> So even though <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are changing with time, this particular combination stays constant. This is a conserved quantity. Let us suggestively call the constant of the motion <span class="math inline">\(H\)</span> for Hamiltonian and write it in terms of new variables <span class="math inline">\(p = \log u\)</span> and <span class="math inline">\(q = \log v\)</span>: <span id="eq-lv7"><span class="math display">\[
H(q,p)= v- \log v + \alpha (u - \log u) = e^q - q + \alpha(e^p - p).
\tag{3.8}\]</span></span> Hamilton’s equations <span id="eq-lv8"><span class="math display">\[\dot{q} = \frac{dH}{dp},~~~~\dot{p} = -\frac{dH}{dq} \tag{3.9}\]</span></span> then reproduce our equations of motion.</p>
<p>This formulation underscores the conservative nature of the model, where the energy-like quantity <span class="math inline">\(H\)</span> is conserved, leading to neutrally stable periodic orbits. This Hamiltonian nature is a rather special feature of the Lotka-Volterra model. Any slight modification of the model will destroy the conserved quantity and the periodic orbits. Thus we should not expect to see such perfect periodic predator-prey cycles in nature. We will discuss more realistic predator-prey models later.</p>
</section>
<section id="linear-stability-analysis" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="linear-stability-analysis"><span class="header-section-number">3.2</span> Linear Stability Analysis</h2>
<p>Before we study more realistic models, we revisit the concept of linear stability analysis, an essential tool in understanding the dynamics near the fixed points of systems described by autonomous coupled ordinary differential equations (ODEs) of the form</p>
<p><span id="eq-lsa1"><span class="math display">\[
\frac{dX}{dt} = f(X,Y), \quad \frac{dY}{dt} = g(X,Y).
\tag{3.10}\]</span></span></p>
<p>Let us denote the fixed points (stable states) of the system as <span class="math inline">\((x^*, y^*)\)</span>. They satisfy <span class="math inline">\(f(x^*, y^*) = 0\)</span> and <span class="math inline">\(g(x^*, y^*) = 0\)</span>.</p>
<p><strong>Linearisation around the Fixed Points</strong></p>
<p>To analyse the stability of these fixed points, we introduce small perturbations <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> around them, setting <span class="math inline">\(X = x^* + x\)</span> and <span class="math inline">\(Y = y^* + y\)</span>. By applying a Taylor expansion and retaining only the linear terms, we obtain a linearised system:</p>
<p><span id="eq-lsa2"><span class="math display">\[
\frac{d}{dt}\begin{pmatrix} x \\ y \end{pmatrix} = \mathbf{A}(x^*, y^*) \begin{pmatrix} x \\ y \end{pmatrix},
\tag{3.11}\]</span></span> where the Jacobian matrix <span class="math inline">\(\mathbf{A}\)</span> is defined as: <span id="eq-lsa3"><span class="math display">\[
\mathbf{A} = \begin{pmatrix} f_X &amp; f_Y \\ g_X &amp; g_Y \end{pmatrix}_{(x^*, y^*)}.
\tag{3.12}\]</span></span></p>
<p><strong>Eigenvalue Analysis for Stability</strong></p>
<p>The solution to the linearised system takes the form <span class="math inline">\((x, y) = \mathbf{v} e^{\lambda t}\)</span>, where <span class="math inline">\(\mathbf{v}\)</span> is an eigenvector of <span class="math inline">\(\mathbf{A}\)</span>, and <span class="math inline">\(\lambda\)</span> is the corresponding eigenvalue. By setting the determinant of <span class="math inline">\(\mathbf{A} - \lambda \mathbf{I}\)</span> to zero, we obtain the characteristic equation:</p>
<p><span id="eq-lsa4"><span class="math display">\[
\det(\mathbf{A} - \lambda \mathbf{I}) = \begin{vmatrix} f_X - \lambda &amp; f_Y \\ g_X &amp; g_Y - \lambda \end{vmatrix}_{(x^*, y^*)} = 0,
\tag{3.13}\]</span></span> which leads to the eigenvalues: <span id="eq-lsa5"><span class="math display">\[
\lambda = \frac{\text{Tr} \mathbf{A} \pm \sqrt{(\text{Tr} \mathbf{A})^2 - 4\det \mathbf{A}}}{2}.
\tag{3.14}\]</span></span></p>
<p>The stability of the fixed point is determined by the sign of the real parts of the eigenvalues:</p>
<ul>
<li>If both eigenvalues have negative real parts, the fixed point is stable (attracting).</li>
<li>If both eigenvalues have positive real parts, the fixed point is unstable (repelling).</li>
<li>If the eigenvalues have real parts of opposite signs, the fixed point is a saddle point, which is unstable.</li>
<li>For a complex conjugate pair of eigenvalues, if the real part is positive, the system exhibits an unstable spiral; if the real part is negative, the system exhibits a stable spiral.</li>
</ul>
<p>This analysis is pivotal for understanding how small deviations from equilibrium evolve over time, providing insights into the system’s long-term behaviour near the fixed points. For instance, in the context of the predator-prey dynamics, such analysis helps elucidate under what conditions the populations will return to equilibrium after a disturbance or potentially diverge away from it.</p>
<p>We can reformulate the stability conditions of a fixed point in terms of the determinant and trace of the Jacobian matrix. We need to recall how these two characteristics of the Jacobian relate to the eigenvalues. For a 2x2 matrix <span class="math inline">\(A\)</span> with eigenvalues <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span>, the trace <span class="math inline">\(\text{Tr}(A)\)</span> is the sum of the eigenvalues, and the determinant <span class="math inline">\(\text{Det}(A)\)</span> is the product of the eigenvalues:</p>
<ul>
<li><span class="math inline">\(\text{Tr}(A) = \lambda_1 + \lambda_2\)</span></li>
<li><span class="math inline">\(\text{Det}(A) = \lambda_1 \lambda_2\)</span></li>
</ul>
<p>Using these relationships, we can express the conditions for the stability of fixed points as follows:</p>
<ol type="1">
<li><p><strong>Stable (Attracting) Fixed Point:</strong> If both eigenvalues have negative real parts, their sum (the trace) is negative, and their product (the determinant) is positive because the product of two negative numbers is positive. Therefore, for stability, <span class="math inline">\(\text{Tr}(A) &lt; 0\)</span> and <span class="math inline">\(\text{Det}(A) &gt; 0\)</span>. Additionally, to ensure that both eigenvalues are real and negative, we require that <span class="math inline">\(\text{Tr}(A)^2 - 4\text{Det}(A) \geq 0\)</span> to avoid complex eigenvalues.</p></li>
<li><p><strong>Unstable (Repelling) Fixed Point:</strong> If both eigenvalues have positive real parts, the trace is positive, and the determinant is positive (the product of two positive numbers is positive). Thus, for instability, <span class="math inline">\(\text{Tr}(A) &gt; 0\)</span> and <span class="math inline">\(\text{Det}(A) &gt; 0\)</span>.</p></li>
<li><p><strong>Saddle Point (Unstable):</strong> If the eigenvalues have real parts of opposite signs, the determinant (the product of the eigenvalues) is negative. So, for a saddle point, <span class="math inline">\(\text{Det}(A) &lt; 0\)</span>, regardless of the trace.</p></li>
<li><p><strong>Spiral Points:</strong> For a complex conjugate pair of eigenvalues, the determinant will be positive (since the product of complex conjugates is positive), but the stability depends on the sign of the real part of the eigenvalues, which is represented by the trace. Here, we also need to ensure that <span class="math inline">\(\text{Tr}(A)^2 - 4\text{Det}(A) &lt; 0\)</span> to confirm that the eigenvalues are complex.</p>
<ul>
<li><strong>Unstable Spiral:</strong> If the real part is positive, <span class="math inline">\(\text{Tr}(A) &gt; 0\)</span> and <span class="math inline">\(\text{Det}(A) &gt; 0\)</span>.</li>
<li><strong>Stable Spiral:</strong> If the real part is negative, <span class="math inline">\(\text{Tr}(A) &lt; 0\)</span> and <span class="math inline">\(\text{Det}(A) &gt; 0\)</span>.</li>
</ul></li>
</ol>
<p>These conditions provide a concise way to determine the stability of fixed points using only the determinant and trace of the Jacobian matrix, without explicitly computing the eigenvalues.</p>
<div id="exm-lsa" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.1 (Linear Stability Analysis of the Lotka-Volterra Model)</strong></span> To explore the stability of steady states in the Lotka-Volterra model, we analyse the system near its fixed points using the Jacobian matrix <span class="math inline">\(\mathbf{A}\)</span>. For the non-dimensionalized Lotka-Volterra system, the Jacobian matrix is given by <span id="eq-lsa6"><span class="math display">\[
\mathbf{A} =
\begin{pmatrix}
1 - v &amp; -u \\
\alpha v &amp; \alpha (u - 1)
\end{pmatrix}.
\tag{3.15}\]</span></span></p>
<p><strong>Steady State at <span class="math inline">\((u, v) = (0, 0)\)</span></strong></p>
<p>For the fixed point <span class="math inline">\((u, v) = (0, 0)\)</span>, we substitute these values into the Jacobian matrix and find the eigenvalues:</p>
<p><span id="eq-lsa7"><span class="math display">\[
\mathbf{A} =
\begin{pmatrix}
1 &amp; 0 \\
0 &amp; -\alpha
\end{pmatrix}.
\tag{3.16}\]</span></span></p>
<p>The eigenvalues are <span class="math inline">\(\lambda_1 = 1\)</span> and <span class="math inline">\(\lambda_2 = -\alpha\)</span>, indicating that this fixed point is a saddle point due to the eigenvalues having opposite signs. This configuration is inherently unstable as trajectories near the point will diverge away along the direction associated with the positive eigenvalue.</p>
<p><strong>Steady State at <span class="math inline">\((u, v) = (1, 1)\)</span></strong></p>
<p>At the fixed point <span class="math inline">\((u, v) = (1, 1)\)</span>, the Jacobian matrix becomes:</p>
<p><span id="eq-lsa8"><span class="math display">\[
\mathbf{A} =
\begin{pmatrix}
0 &amp; -1 \\
\alpha &amp; 0
\end{pmatrix}.
\tag{3.17}\]</span></span></p>
<p>The characteristic equation for the eigenvalues <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\lambda^2 + \alpha = 0\)</span>, leading to complex eigenvalues <span class="math inline">\(\lambda = \pm i\sqrt{\alpha}\)</span>. The real part of these eigenvalues is zero, indicating that this fixed point is a centre. Trajectories around this point are closed loops, implying that the system exhibits neutrally stable periodic behaviour around the <span class="math inline">\((1, 1)\)</span> steady state.</p>
<p>The period <span class="math inline">\(T\)</span> of the oscillations can be determined from the imaginary part of the eigenvalues, which is <span class="math inline">\(\sqrt{\alpha}\)</span>, so the period <span class="math inline">\(T = \frac{2\pi}{\sqrt{\alpha}}\)</span>.</p>
</div>
</section>
<section id="more-realistic-predator-prey-models" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="more-realistic-predator-prey-models"><span class="header-section-number">3.3</span> More Realistic Predator-Prey Models</h2>
<p>While the basic Lotka-Volterra model provides a fundamental understanding of predator-prey interactions, more nuanced models incorporate additional biological realism. These models may account for factors like limited resources, satiation, prey switching, predator avoidance, and many others.</p>
<section id="generalized-predator-prey-model" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="generalized-predator-prey-model"><span class="header-section-number">3.3.1</span> Generalized Predator-Prey Model</h3>
<p>The generalized model introduces a function <span class="math inline">\(F(N, P)\)</span> representing the prey population’s per-capita growth and a function <span class="math inline">\(G(N, P)\)</span> for the predator’s per-capita growth rate, so that the dynamics are:</p>
<p><span id="eq-gpp1"><span class="math display">\[
\frac{dN}{dt} = NF(N, P), \quad \frac{dP}{dt} = PG(N, P).
\tag{3.18}\]</span></span></p>
<p>The prey might exhibit logistic growth in the absence of predators. To model this we could choose <span id="eq-gpp2"><span class="math display">\[
F(N, P) = r\left(1 - \frac{N}{K}\right) - R(N)P,
\tag{3.19}\]</span></span></p>
<p>where <span class="math inline">\(r\)</span> is the intrinsic growth rate, <span class="math inline">\(K\)</span> is the carrying capacity, and <span class="math inline">\(R(N)\)</span> models how the predation rate of a predator changes with the prey population size. <span class="math inline">\(NR(N)\)</span> is the rate at which each individual predator consumes prey. The dependence of this rate on the prey population size <span class="math inline">\(N\)</span> is often referred to as “functional response” in the ecological literature. Holling introduced three types of functional responses, which are widely used in predator-prey models:</p>
<section id="holling-type-functional-responses" class="level4">
<h4 class="anchored" data-anchor-id="holling-type-functional-responses">Holling Type functional responses</h4>
<ol type="1">
<li><p><strong>Type I</strong> <span class="math inline">\(NR(N) = bN\)</span>, which corresponds to the standard Lotka-Volterra model. This simplification lacks realism as it assumes an unlimited predator appetite regardless of prey population size.</p></li>
<li><p><strong>Type II</strong> <span class="math inline">\(NR(N) = \frac{AN}{N + B}\)</span>, with <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> being positive constants. In this model, the rate approaches a saturation level <span class="math inline">\(A\)</span> for large <span class="math inline">\(N\)</span>, reflecting a limit to the predator’s consumption rate. This model is more realistic as it accounts for the predator’s limited appetite, which might be because there is a minimum handling time, the time the predator needs to consume a prey item.</p></li>
<li><p><strong>Type III</strong> <span class="math inline">\(NR(N) = \frac{AN^2}{N^2 + B^2}\)</span>. This response includes a saturation effect like the previous example but also models that if the prey is rare the predator may not be able to find it. This model is more complex and captures the idea that predators may switch to alternative prey when the primary prey is scarce. It may also encode a learning effect, where the predator’s efficiency in capturing prey increases with experience so that initially the predator’s consumption rate increases with prey density.</p></li>
</ol>
</section>
</section>
<section id="example" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="example"><span class="header-section-number">3.3.2</span> Example</h3>
<p>Consider a model where the prey growth rate follows logistic dynamics in the absence of prey and predation mortality is described by a Holling type II function encoding satiation effects. The predator’s growth rate goes down as the prey population decreases. The model equations are: <span id="eq-gpp3"><span class="math display">\[
\frac{dN}{dt} = N\left[r\left(1 - \frac{N}{K}\right) - \frac{A}{N + B}P\right], \quad \frac{dP}{dt} = Ps\left(1 - \frac{hP}{N}\right),
\tag{3.20}\]</span></span> where <span class="math inline">\(r\)</span>, <span class="math inline">\(K\)</span>, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(s\)</span>, and <span class="math inline">\(h\)</span> are positive constants.</p>
<p><strong>Nondimensionalization</strong></p>
<p>To reduce the complexity, we nondimensionalize the system with <span class="math inline">\(\tau = tr\)</span>, <span class="math inline">\(u = \frac{N}{K}\)</span>, <span class="math inline">\(v = \frac{hP}{K}\)</span>, <span class="math inline">\(a = \frac{A}{hr}\)</span>, <span class="math inline">\(b = \frac{B}{K}\)</span>, and <span class="math inline">\(c = \frac{s}{r}\)</span>, leading to:</p>
<p><span id="eq-gpp4"><span class="math display">\[
\frac{du}{d\tau} = u(1 - u) - a\frac{uv}{u + b}, \quad \frac{dv}{d\tau} = cv\left(1 - \frac{v}{u}\right).
\tag{3.21}\]</span></span></p>
<p><strong>Stability Analysis of Steady States</strong></p>
<p>The steady states <span class="math inline">\((u^*, v^*)\)</span> include <span class="math inline">\((1, 0)\)</span> and a coexistence steady state <span class="math inline">\((u^*_+, u^*_+)\)</span>, where <span id="eq-gpp5"><span class="math display">\[
u^*_+ = \frac{1-a-b+\sqrt{(1-a-b)^2+4b}}{2}.
\tag{3.22}\]</span></span> The community matrix <span class="math inline">\(\mathbf{A}(u, v)\)</span> at these points helps determine their stability. For the fixed point <span class="math inline">\((1, 0)\)</span>, where the prey population is at carrying capacity and there are no predators, we have find <span id="eq-gpp6"><span class="math display">\[
\mathbf{A}(1, 0) = \begin{pmatrix} -1 &amp; -\frac{a}{1 + b} \\ 0 &amp; c \end{pmatrix}.
\tag{3.23}\]</span></span> The eigenvalues <span class="math inline">\(-1\)</span> and <span class="math inline">\(c\)</span> have opposite sign, indicating that the fixed point is a saddle point.</p>
<p>At the coexistence fixed point <span class="math inline">\((u^*_+, u^*_+)\)</span> the Jacobian is more complex and we will skip the analysis here.</p>
</section>
</section>
<section id="competition-models" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="competition-models"><span class="header-section-number">3.4</span> Competition Models</h2>
<p>In ecological systems, species often compete for limited resources, such as food or territory. This competition influences their growth rates and can determine their survival and dominance within an ecosystem. The Lotka-Volterra competition model provides a framework to study these dynamics, extending the principles of logistic growth to account for interspecies interactions.</p>
<section id="lotka-volterra-competition-dynamics" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="lotka-volterra-competition-dynamics"><span class="header-section-number">3.4.1</span> Lotka-Volterra Competition Dynamics</h3>
<p>The model is formulated as follows for two competing species <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span>:</p>
<p><span id="eq-comp1"><span class="math display">\[
\begin{split}
\frac{dN_1}{dt} &amp;= r_1N_1 \left(1 - \frac{N_1 + b_{12}N_2}{K_1}\right),\\
\frac{dN_2}{dt} &amp;= r_2N_2 \left(1 - \frac{N_2 + b_{21}N_1}{K_2}\right),
\end{split}
\tag{3.24}\]</span></span></p>
<p>where <span class="math inline">\(r_i\)</span> is the intrinsic growth rate and <span class="math inline">\(K_i\)</span> is the carrying capacity of species <span class="math inline">\(i\)</span>. The coefficients <span class="math inline">\(b_{ij}\)</span> represent the competitive effect of species <span class="math inline">\(j\)</span> on species <span class="math inline">\(i\)</span>, effectively reducing the carrying capacity for species <span class="math inline">\(i\)</span> due to the presence of species <span class="math inline">\(j\)</span>.</p>
</section>
<section id="nondimensionalization-of-the-model" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="nondimensionalization-of-the-model"><span class="header-section-number">3.4.2</span> Nondimensionalization of the Model</h3>
<p>To simplify the analysis, we nondimensionalize the system using:</p>
<p><span id="eq-comp2"><span class="math display">\[
u_i = \frac{N_i}{K_i}, \quad a_{ij} = \frac{b_{ij}K_j}{K_i}, \quad \tau = r_1 t, \quad \rho = \frac{r_2}{r_1},
\tag{3.25}\]</span></span> leading to: <span id="eq-comp3"><span class="math display">\[
\frac{du_1}{d\tau} = u_1(1 - u_1 - a_{12}u_2), ~~~~~ \frac{du_2}{d\tau} = \rho u_2(1 - u_2 - a_{21}u_1).
\tag{3.26}\]</span></span></p>
</section>
<section id="analysis-of-steady-states" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="analysis-of-steady-states"><span class="header-section-number">3.4.3</span> Analysis of Steady States</h3>
<p>The system has four potential steady states: <span class="math inline">\((0, 0)\)</span>, <span class="math inline">\((0, 1)\)</span>, <span class="math inline">\((1, 0)\)</span>, and a coexistence steady state <span class="math inline">\(\left(\frac{1-a_{12}}{1-a_{12}a_{21}}, \frac{1-a_{21}}{1-a_{12}a_{21}}\right)\)</span>.</p>
<p>To determine the stability of these points, we evaluate the Jacobian matrix <span class="math inline">\(\mathbf{A}(u_1, u_2)\)</span> at each steady state and analyse its eigenvalues:</p>
<ol type="1">
<li><p><strong>At <span class="math inline">\((0, 0)\)</span>:</strong> The eigenvalues are <span class="math inline">\(1\)</span> and <span class="math inline">\(\rho\)</span>, indicating an unstable node as both are positive.</p></li>
<li><p><strong>At <span class="math inline">\((1, 0)\)</span>:</strong> The eigenvalues are <span class="math inline">\(-1\)</span> and <span class="math inline">\(\rho(1 - a_{21})\)</span>. This point is a saddle if <span class="math inline">\(a_{21} &lt; 1\)</span> and a stable node if <span class="math inline">\(a_{21} &gt; 1\)</span>.</p></li>
<li><p><strong>At <span class="math inline">\((0, 1)\)</span>:</strong> By symmetry, this point behaves like <span class="math inline">\((1, 0)\)</span> with roles reversed between species.</p></li>
<li><p><strong>Coexistence point <span class="math inline">\(\left(\frac{1-a_{12}}{1-a_{12}a_{21}}, \frac{1-a_{21}}{1-a_{12}a_{21}}\right)\)</span>:</strong> The stability is determined by the sign of the trace and the determinant of <span class="math inline">\(\mathbf{A}\)</span>. The system’s behaviour at this point depends on the specific values of <span class="math inline">\(a_{12}\)</span> and <span class="math inline">\(a_{21}\)</span>, indicating potential scenarios where both species can coexist or one outcompetes the other.</p></li>
</ol>
</section>
<section id="nullclines-and-phase-portraits" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="nullclines-and-phase-portraits"><span class="header-section-number">3.4.4</span> Nullclines and Phase Portraits</h3>
<p>Nullclines, where the growth rate of one of the species are zero, are a very useful aid when drawing phase plane diagrams, also known as phase portraits. The nullclines for the Lotka-Volterra competition model are:</p>
<ul>
<li><p><span class="math inline">\(u_1\)</span> nullclines: <span class="math inline">\(du_1/d\tau = 0\)</span> when <span class="math inline">\(u_1 = 0\)</span> or <span class="math inline">\(u_2 = \frac{1-u_1}{a_{12}}\)</span>.</p></li>
<li><p><span class="math inline">\(u_2\)</span> nullclines: <span class="math inline">\(du_2/d\tau = 0\)</span> when <span class="math inline">\(u_2 = 0\)</span> or <span class="math inline">\(u_2 = 1 - a_{21}u_1\)</span>.</p></li>
</ul>
<p>Along the <span class="math inline">\(u_1\)</span> nullclines the flow is purely vertical and along the <span class="math inline">\(u_2\)</span> nullclines the flow is purely horizontal. The intersection of the nullclines gives the steady states of the system. We can now draw the phase portrait to visualize the dynamics of the system. Very rough sketches are enough to understand the dynamics.</p>
<div id="fig-competition-phase1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-competition-phase1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Interacting/phase1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-competition-phase1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Phase portrait of competition model when <span class="math inline">\(a_{12}&lt;1\)</span> and <span class="math inline">\(a_{21}&lt;1\)</span>.
</figcaption>
</figure>
</div>
<p><a href="#fig-competition-phase1" class="quarto-xref">Figure&nbsp;<span>3.2</span></a> shows the phase portrait of the competition model when <span class="math inline">\(a_{12}&lt;1\)</span> and <span class="math inline">\(a_{21}&lt;1\)</span>. The nullclines are shown in grey and red, the flow lines in blue, with the arrows indicating the direction of the flow. The system exhibits a stable coexistence steady state, where both species persist in the ecosystem.</p>
<div id="fig-competition-phase2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-competition-phase2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Interacting/phase2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-competition-phase2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Phase portrait of competition model when <span class="math inline">\(a_{12}&gt;1\)</span> and <span class="math inline">\(a_{21}&gt;1\)</span>.
</figcaption>
</figure>
</div>
<p><a href="#fig-competition-phase2" class="quarto-xref">Figure&nbsp;<span>3.3</span></a> illustrates the phase portrait of the competition model when <span class="math inline">\(a_{12}&gt;1\)</span> and <span class="math inline">\(a_{21}&gt;1\)</span>. In this scenario, the coexistence steady state is a saddle, leading to the exclusion of one species. Which species dominates depends on the initial conditions. If the initial condition is below the separatrix, species 1 will dominate, and if it is above, species 2 will dominate.</p>
<div id="fig-competition-phase3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-competition-phase3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Interacting/phase3.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-competition-phase3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Phase portrait of competition model when <span class="math inline">\(a_{12}&lt;1\)</span> and <span class="math inline">\(a_{21}&gt;1\)</span>.
</figcaption>
</figure>
</div>
<p><a href="#fig-competition-phase3" class="quarto-xref">Figure&nbsp;<span>3.4</span></a> depicts the phase portrait of the competition model when <span class="math inline">\(a_{12}&lt;1\)</span> and <span class="math inline">\(a_{21}&gt;1\)</span>. In this case, the coexistence steady state has disappeared (it has moved into a region with negative population numbers that is not ecologically relevant). Irrespective of initial conditions, the system will evolve towards the state where only species 1 exists. Species 2 is driven to extinction.</p>
<p>We are not drawing the case <span class="math inline">\(a_{12}&gt;1\)</span> and <span class="math inline">\(a_{21}&lt;1\)</span> as it is similar to the case <span class="math inline">\(a_{12}&lt;1\)</span> and <span class="math inline">\(a_{21}&gt;1\)</span> just with the role of species 1 and 2 reversed. In this case species 2 will dominate and species 1 will go extinct.</p>
</section>
<section id="competitive-exclusion-principle" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="competitive-exclusion-principle"><span class="header-section-number">3.4.5</span> Competitive Exclusion Principle</h3>
<p>The competitive exclusion principle, proposed by Gause in the 1930s, states that two species competing for the same resources cannot coexist indefinitely, with one species eventually outcompeting the other.</p>
<p>In the model we studied the two species shared resources but each also had its own resources, hence we observed a weaker form of the competitive exclusion principle. The coexistence steady state was stable when the competition was weak enough, allowing both species to persist in the ecosystem. This highlights the delicate balance between competition and coexistence in ecological systems, where the strength of interspecies interactions plays a crucial role in determining the long-term dynamics of species populations.</p>
</section>
</section>
<section id="mutualism-models" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="mutualism-models"><span class="header-section-number">3.5</span> Mutualism Models</h2>
<p>In ecological systems, mutualism refers to interactions where all participating species benefit, leading to increased growth rates. An example is the relationship between plants and their seed dispersers, such as insects, where both parties gain advantages from their association.</p>
<section id="example-1" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="example-1"><span class="header-section-number">3.5.1</span> Example</h3>
<p>This model incorporates logistic growth, akin to the competition model, but with a twist to account for the mutualistic interaction:</p>
<p><span id="eq-mutualistic1"><span class="math display">\[
\frac{dN_1}{dt} = r_1N_1 \left[ 1 - \frac{N_1}{K_1} + b_{12}\frac{N_2}{K_1} \right], ~~~~~ \frac{dN_2}{dt} = r_2N_2 \left[ 1 - \frac{N_2}{K_2} + b_{21}\frac{N_1}{K_2} \right],
\tag{3.27}\]</span></span></p>
<p>where <span class="math inline">\(r_i\)</span>, <span class="math inline">\(K_i\)</span>, and <span class="math inline">\(b_{ij}\)</span> are all positive constants, with <span class="math inline">\(b_{ij}\)</span> representing the mutualistic benefit to species <span class="math inline">\(i\)</span> from species <span class="math inline">\(j\)</span>. Notice that we simply changed the sign of the competition terms in the competition model to turn them into mutualistic terms</p>
</section>
<section id="nondimensionalization-of-the-model-1" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="nondimensionalization-of-the-model-1"><span class="header-section-number">3.5.2</span> Nondimensionalization of the Model</h3>
<p>Using nondimensional variables <span class="math inline">\(u_i = N_i/K_i\)</span>, <span class="math inline">\(a_{ij} = b_{ij}K_j/K_i\)</span>, <span class="math inline">\(\tau = r_1t\)</span>, and <span class="math inline">\(\rho = r_2/r_1\)</span>, the equations transform to:</p>
<p><span id="eq-mutualistic2"><span class="math display">\[
\frac{du_1}{d\tau} = u_1(1 - u_1 + a_{12}u_2), ~~~~~ \frac{du_2}{d\tau} = \rho u_2(1 - u_2 + a_{21}u_1).
\tag{3.28}\]</span></span> This is as in the competition model but with the signs in front of <span class="math inline">\(a_{12}\)</span> and <span class="math inline">\(a_{21}\)</span> reversed.</p>
</section>
<section id="steady-states-and-stability" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="steady-states-and-stability"><span class="header-section-number">3.5.3</span> Steady States and Stability</h3>
<p>The system has the steady states <span class="math inline">\((0, 0)\)</span>, <span class="math inline">\((0, 1)\)</span>, <span class="math inline">\((1, 0)\)</span>, and <span class="math inline">\(\left(\frac{1 + a_{12}}{\delta}, \frac{1 + a_{21}}{\delta}\right)\)</span>, where <span class="math inline">\(\delta = 1 - a_{12}a_{21}\)</span>. The coexistence steady state is ecologically relevant only if <span class="math inline">\(\delta &gt; 0\)</span>.</p>
<ul>
<li><p><strong>At <span class="math inline">\((0, 0)\)</span>:</strong> The eigenvalues are <span class="math inline">\(1\)</span> and <span class="math inline">\(\rho\)</span>, indicating an unstable node.</p></li>
<li><p><strong>At <span class="math inline">\((0, 1)\)</span> and <span class="math inline">\((1, 0)\)</span>:</strong> These points are saddles, with eigenvalues showing a mix of positive and negative signs.</p></li>
<li><p><strong>At the mutualistic steady state:</strong> The trace and determinant of the community matrix <span class="math inline">\(\mathbf{A}\)</span> suggest that this point is stable if <span class="math inline">\(\delta &gt; 0\)</span>.</p></li>
</ul>
</section>
<section id="nullclines-and-phase-portraits-1" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="nullclines-and-phase-portraits-1"><span class="header-section-number">3.5.4</span> Nullclines and Phase Portraits</h3>
<p>The equations for the nullclines for this model are similar to those in the competition model, but now with positive slope rather than negative slope.</p>
<ul>
<li><p><span class="math inline">\(u_1\)</span> nullclines: <span class="math inline">\(du_1/d\tau = 0\)</span> when <span class="math inline">\(u_1 = 0\)</span> or <span class="math inline">\(u_2 = \frac{u_1-1}{a_{12}}\)</span>.</p></li>
<li><p><span class="math inline">\(u_2\)</span> nullclines: <span class="math inline">\(du_2/d\tau = 0\)</span> when <span class="math inline">\(u_2 = 0\)</span> or <span class="math inline">\(u_2 = 1 + a_{21}u_1\)</span>.</p></li>
</ul>
<div id="fig-mutualistic-phase" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mutualistic-phase-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Interacting/phase4.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mutualistic-phase-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Phase portrait of mutualistic model when <span class="math inline">\(a_{12}a_{21}&lt;1\)</span>.
</figcaption>
</figure>
</div>
<p><a href="#fig-mutualistic-phase" class="quarto-xref">Figure&nbsp;<span>3.5</span></a> illustrates the phase portrait of the mutualism model when <span class="math inline">\(a_{12}a_{21}&lt;1\)</span>. The nullclines are shown in grey and red, with the flow lines in blue. The system exhibits a stable coexistence steady state, where both species benefit from the mutualistic interaction.</p>
</section>
<section id="limitations-and-unbounded-growth" class="level3" data-number="3.5.5">
<h3 data-number="3.5.5" class="anchored" data-anchor-id="limitations-and-unbounded-growth"><span class="header-section-number">3.5.5</span> Limitations and Unbounded Growth</h3>
<p>A cautionary note is that if the mutualistic coefficients <span class="math inline">\(a_{12}a_{21}\)</span> are too large, leading to <span class="math inline">\(\delta &lt; 0\)</span>, the model predicts unbounded growth, which is unrealistic. This phenomenon, known as May’s “orgy of mutual benefaction,” highlights the need for constraints in mutualism models to avoid predicting ecological impossibilities.</p>
<p>Through this mutualism model, we gain insights into how species interactions can foster increased growth and stability, contrasting with competitive dynamics. It underscores the diversity of ecological interactions and their varying implications for species survival and community structure.</p>
<!---
## Discussion on Modelling Interacting Populations

- **Complexity of Real Ecosystems:** Natural ecosystems are intricate networks of numerous interacting species, forming a complex food web or ecological network. These interactions span various trophic levels and include diverse relationships such as predation, competition, and mutualism.

- **Generic Models for Population Dynamics:** A general way to represent the dynamics of interacting populations in an ecosystem is through a system of differential equations, where $\frac{dN_i}{dt} = f_i(\underline{N})$ for $i = 1, \dots, n$, and $\underline{N}$ represents the vector of all population sizes. These models aim to capture the essence of biological interactions and their impact on population changes over time.

- **Generalized Lotka-Volterra Model:** This model extends the basic Lotka-Volterra framework to multiple species, where $f_i(\underline{N}) = N_i(\underline{r} + A\underline{N})_i$ or more explicitly, $f_i = N_i(r_i + \sum_{j=1}^n A_{ij}N_j)$. Here, $A$, the community matrix, encapsulates the interaction strengths between species, and $\underline{r}$ represents intrinsic growth rates. The model can predict a coexistence fixed point where populations stabilize, given by $\underline{N} = -A^{-1}\underline{r}$.

- **Mass Action Dynamics:** This concept implies that the rate of interaction between two species is proportional to the product of their abundances, modelled as $A_{ij}N_iN_j$, reflecting a direct dependency on population sizes.

- **Functional Response and Density-Dependent Rates:** The term $N_iF(N_j)$ introduces a functional response, where the impact of one species on another is a function of the population size, incorporating behaviours like prey switching, mutual protection, satiation, and others, which introduce nonlinearities and more realistic dynamics into the models.

- **Challenges in Applying Models to Reality:**
    - **Phenomenological Models:** These models use mathematical functions to fit observed data, prioritizing predictions and descriptions over understanding the underlying mechanisms.
    - **Mechanistic Models:** They are grounded in biological principles, aiming to capture the underlying processes with parameters that have real-world interpretations.

- **Competitive Exclusion Principle:** This principle suggests that in a stable environment, competing species cannot coexist indefinitely; however, various ecological theories like niche theory, the intermediate disturbance hypothesis, and the paradox of the plankton offer explanations for the maintenance of biodiversity.

- **Complexity-Stability Debate:** Robert May's work challenges the intuition that greater biodiversity enhances ecosystem stability. Mathematical models often show that increased complexity can lead to decreased stability, sparking ongoing debate and research in this area.

- **Evolutionary Perspectives:** Ecosystems are not static; they are shaped by evolutionary processes, including adaptation and co-evolution, which influence species interactions and ecosystem dynamics over time.

- **Influence on Environmental Policy:** Models play a crucial role in informing policies, such as determining sustainable fishing quotas, by predicting the outcomes of different management strategies.

- **Role of Modelling in Ecology:** The primary purpose of modelling in ecology is to enhance our understanding of complex systems. While models are powerful tools, they are means to an end, not the end themselves. They help in hypothesis testing, generating predictions, and offering insights that guide empirical research and conservation efforts.

--->
</section>
</section>
<section id="exercises" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">3.6</span> Exercises</h2>
<section id="two-species-model-1" class="level4">
<h4 class="anchored" data-anchor-id="two-species-model-1">* Two-species model 1</h4>
<div id="exr-interacting-populations" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.1</strong></span> &nbsp;</p>
<!--- From sheet 3 --->
<p>Consider a model for the interaction of two species with populations <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span> <span id="eq-interacting-populations1"><span class="math display">\[
\frac{dN_1}{dt} = r_1 N_1 \left( 1 - \frac{N_1}{K_1} - b_{12}\frac{ N_2}{K_1} \right),
\tag{3.29}\]</span></span> <span id="eq-interacting-populations2"><span class="math display">\[
\frac{N_2}{dt} = r_2 N_2 \left( 1  - b_{21}\frac{ N_1}{K_2} \right),
\tag{3.30}\]</span></span> where all the parameters are positive.</p>
<ol type="a">
<li><p>What type of interaction exists between <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span>?</p></li>
<li><p>Non-dimensionalize the system by introducing <span class="math inline">\(u=N_1/K_1\)</span> and <span class="math inline">\(v=N_2/K_2\)</span> as well as a non-dimensional time variable. What are the resulting non-dimensional parameters? Give the equations of motion for <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> in terms of these parameters.</p></li>
<li><p>Determine the steady states in the non-dimensionalised system. Investigate their stability. At what values of the parameters do bifurcations take place?</p></li>
<li><p>Determine the nullclines and use these to make rough phase-plane sketches (You will need two sketches).</p></li>
<li><p>Describe under what ecological circumstances <span class="math inline">\(N_2\)</span> becomes extinct.<br>
Do the same for <span class="math inline">\(N_1\)</span>. Show that the principle of competitive exclusion holds irrespective of the size of the parameters.</p></li>
</ol>
</div>
<hr>
</section>
<section id="two-species-model-2" class="level4">
<h4 class="anchored" data-anchor-id="two-species-model-2">Two-species model 2</h4>
<div id="exr-interacting-populations-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.2</strong></span> &nbsp;</p>
<!--- From Surrey exam 1999 --->
<p>A model for the interaction between two species with populations <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span> is determined to be <span id="eq-interacting-populations3"><span class="math display">\[
\begin{split}
\frac{dN_1}{dt} &amp;= rN_1\left(1 - \frac{N_1}{K}\right) - aN_1N_2\left(1 - \exp(-bN_1)\right),\\
\frac{dN_2}{dt} &amp;= -dN_2 + cN_2\left(1 - \exp(-bN_1)\right),
\end{split}
\tag{3.31}\]</span></span> where <span class="math inline">\(a, b, c, d, r\)</span> and <span class="math inline">\(K\)</span> are positive constants.</p>
<ol type="a">
<li><p>Introducing the dimensionless variables and parameters <span id="eq-interacting-populations4"><span class="math display">\[
u = \frac{N_1}{K}, \quad v = \frac{aN_2}{r}, \quad \tau = rt, \quad \beta = bK,
\tag{3.32}\]</span></span> show that <span id="eq-interacting-populations5"><span class="math display">\[
\begin{split}
\frac{du}{d\tau} &amp;= u(1 - u) - uv\left(1 - e^{-\beta u}\right),\\
\frac{dv}{d\tau} &amp;= -\delta v + \alpha v\left(1 - e^{-\beta u}\right),
\end{split}
\tag{3.33}\]</span></span> giving the positive constants <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\delta\)</span> in terms of <span class="math inline">\(c, d\)</span> and <span class="math inline">\(r\)</span>.</p></li>
<li><p>Describe the relevance of each term and, hence, determine the type of interaction between the two populations.</p></li>
<li><p>Show that the non-negative fixed points are given by <span class="math inline">\((u^*, v^*) = (0, 0), (1,0)\)</span> and <span class="math inline">\((u_1, (1 - u_1)\alpha/\delta)\)</span>, where <span class="math inline">\(u_1 = -\ln(1 - \delta/\alpha)/\beta\)</span>, and that the steady state where <span class="math inline">\(u^*\)</span> and <span class="math inline">\(v^*\)</span> are both non-zero can only exist if <span class="math inline">\(\alpha &gt; \delta\)</span> and <span class="math inline">\(\beta &gt; \beta_c = -\ln(1 - \delta/\alpha)\)</span>.</p></li>
<li><p>Show that the community matrix, <span class="math inline">\(A\)</span>, is given by <span id="eq-interacting-populations6"><span class="math display">\[
A = \begin{pmatrix}
1 - 2u - v(1 - e^{-\beta u}) - \beta uve^{-\beta u} &amp; -u\left(1 - e^{-\beta u}\right) \\
\alpha v\beta e^{-\beta u} &amp; -\delta + \alpha(1 - e^{-\beta u})
\end{pmatrix}.
\tag{3.34}\]</span></span></p></li>
<li><p>Assuming henceforth that <span class="math inline">\(\delta/\alpha &lt; 1\)</span>, determine the linear stability of each of the fixed points.</p></li>
<li><p>Sketch the <span class="math inline">\((u, v)\)</span> phase portrait to indicate the stability of each steady state for the two cases <span class="math inline">\(\beta &gt; \beta_c\)</span> and <span class="math inline">\(0 &lt; \beta &lt; \beta_c\)</span> (remember <span class="math inline">\(\alpha &gt; \delta\)</span>).</p></li>
</ol>
</div>
<hr>
</section>
<section id="predator-prey-model-with-allee-effect" class="level4">
<h4 class="anchored" data-anchor-id="predator-prey-model-with-allee-effect">Predator-prey model with Allee effect</h4>
<div id="exr-interacting-populations-3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.3</strong></span> &nbsp;</p>
<!--- From 2017 exam --->
<p>Consider the predator-prey model with Allee effect in the prey: <span id="eq-interacting-populations7"><span class="math display">\[
\begin{split}
\frac{dN}{dT} &amp;= rN\left(\frac{N}{K_0} - 1\right)\left(1 - \frac{N}{K}\right) - cNP,\\
\frac{dP}{dT} &amp;= bNP - mP,
\end{split}
\tag{3.35}\]</span></span> where <span class="math inline">\(N(T)\)</span> is the number of prey and <span class="math inline">\(P(T)\)</span> is the number of predators at time <span class="math inline">\(T\)</span>, and <span class="math inline">\(r, K, c, b, m\)</span> are positive constants with <span class="math inline">\(0 &lt; K_0 &lt; K\)</span>. The populations <span class="math inline">\(N(T), P(T)\)</span> are non-negative quantities.</p>
<ol type="a">
<li><p>Provide brief biological interpretations for <span class="math inline">\(r, K, K_0, c, b, m\)</span> for the above predator-prey model. What is the biological role of <span class="math inline">\(K_0\)</span> in the modified prey growth rate?</p></li>
<li><p>Introduce the dimensionless variables <span class="math inline">\(\frac{N}{K} = x, \frac{cP}{r} = y, rT = t\)</span> and show that the above system can be reduced to</p></li>
</ol>
<p><span id="eq-interacting-populations8"><span class="math display">\[\begin{split}
\frac{dx}{dt} &amp;= x\left(\left(\frac{x}{\gamma} - 1\right)(1 - x) - y\right) = x[g(x) - y],\\
\frac{dy}{dt} &amp;= \beta(x - \alpha) y.
\end{split} \tag{3.36}\]</span></span> How are the new dimensionless constants <span class="math inline">\(\alpha, \beta\)</span> and <span class="math inline">\(\gamma\)</span> expressed in terms of the original parameters?</p>
<ol start="3" type="a">
<li><p>For the dimensionless system:</p>
<ol type="i">
<li><p>Calculate the nullclines, clearly stating any conditions for their existence.</p></li>
<li><p>Use your answer from (i) to sketch nullclines, depicting their intersections and the vector field direction along each isocline in the phase plane.</p></li>
<li><p>Find the fixed points.</p></li>
</ol></li>
<li><p>For the non-trivial fixed point, where both predators and preys may coexist:</p>
<ol type="i">
<li><p>Calculate the Jacobian at this point in terms of the function <span class="math inline">\(g(x), g'(x)\)</span>, where <span class="math inline">\('\)</span> denotes derivative in respect with <span class="math inline">\(x\)</span>.</p></li>
<li><p>Evaluate the characteristic equation and study the stability of this fixed point as the parameter α varies within the range <span class="math inline">\(\gamma&lt;\alpha&lt;1\)</span>, classifying the non-trivial fixed point accordingly (i.e.&nbsp;node, spiral, centre or saddle point).</p></li>
</ol></li>
</ol>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./discrete_time.html" class="pagination-link" aria-label="Discrete-time population models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Discrete-time population models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sex_structured.html" class="pagination-link" aria-label="Sex-structured population models">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sex-structured population models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gustavdelius/MathematicalEcologyAndEpidemiology2025/edit/main/interacting.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>